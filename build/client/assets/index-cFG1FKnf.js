import{j as e,r as T,g as ae}from"./emotion-element-43c6fea0.browser.esm-CqNy1Myq.js";import{u as Re}from"./useDXTApiFetch-DCIa93_N.js";import{E as Fe,F as ke,G as Me,H as He,I as Be,J as Ue,K as $e,L as We,M as Ve,N as Ge,O as qe,k as Ke,l as H,m as De,T as Xe,Q as Ye,R as Ze,S as Je,U as Qe,V as et,W as tt,X as st,Y as rt,Z as it,_ as nt,$ as at,a0 as ot,a1 as lt,a2 as ct,a3 as dt}from"./TextPrice-LTUXzWuW.js";import{f as w,u as ht,o as Oe,c as W,d as ut,p as mt,m as _t,I as V,ba as gt,bb as ft,bc as pt,bd as xt,be as jt,bf as Et,U as Rt,_ as Dt,aE as y,bg as Ot,bh as Tt,bi as P,bj as bt,bk as vt,ak as At,bl as St,bm as Ct,bn as It,az as zt,bo as Lt,bp as yt,bq as Pt,br as wt,bs as Nt,bt as Ft,bu as kt,g as Q,aj as le,bv as Te,b2 as Mt,Y as Ht,ab as Bt,aQ as K,al as Ut}from"./auth_context-BcmIMa0H.js";import{S as ce,A as be}from"./ApiErrors-BofVVWwq.js";import{a as L,F as k}from"./FormSkeletons-C9NbYi-R.js";import{N as ve,M as $t,a as Wt,b as I,c as X}from"./Navbar-DNtWvKPK.js";import{O as Ae,u as Vt,d as Gt,a as qt,m as Kt,r as Xt}from"./OrdersContainer-CMmR3fR7.js";import{B as S}from"./chunk-PULVB27S-DFGZ_FhU.js";import{G,a as R}from"./chunk-ZPFGWTBB-D1BdsecE.js";import{u as Se,S as Ce}from"./SearchField-C-IBFAFq.js";import{P as Yt,r as Zt,E as C,i as Jt,a as de,g as Qt,b as es}from"./index-BReOA4XD.js";import{u as Ie}from"./app_resources-DBlOodC1.js";import{G as ts,H as ss,O as rs,J as is,K as ns}from"./app-B1a_okyL.js";import{R as he}from"./ResponsiveIconButton-Dzqr81nH.js";import{j as as,i as os}from"./AccountCancelIcon-Dwhtn_ei.js";import{A as ls,T as z,u as cs,C as ue}from"./ConfirmationDialog-Dob361oP.js";import{F as ds}from"./index.esm-BqhPpraI.js";import{a as hs,L as us,b as me}from"./chunk-46CXQZ4E-CX4juB_f.js";import{V as ms}from"./chunk-NTCQBYKE-BNWfc7jI.js";import{F as ee}from"./chunk-KRPLQIP4-22zt2_dG.js";import{H as _e}from"./chunk-3ASUQ6PA-C9U3rhNA.js";import{f as _s}from"./chunk-HB6KBUMZ-25NI-665.js";import{I as gs}from"./chunk-6QYXN73V-CZbxpQYs.js";import{A as N}from"./chunk-3KCBMPN5-COSGWH1j.js";import{A as oe,b as F}from"./chunk-QURMB2UJ-Cc-vvoFz.js";import{T as M}from"./chunk-2OOHT3W5-Ci3F40nI.js";import{B as fs}from"./chunk-Z6RXEUPO-CLnUS3YW.js";import{H as O}from"./chunk-7OLJDQMT-mUIp5tuF.js";import{C as ps}from"./chunk-CWVAJCXJ-CfPCGt4p.js";import{b as ze,c as Le,T as xs,a as js}from"./chunk-T2WCTPDH-D-1yuUFr.js";import{u as Es}from"./chunk-6RSEZNRH-HBxAY87Z.js";var ye=w(function(t,s){const i=ht("Link",t),{className:n,isExternal:o,...l}=Oe(t);return e.jsx(W.a,{target:o?"_blank":void 0,rel:o?"noopener":void 0,ref:s,className:ut("chakra-link",n),...l,__css:i})});ye.displayName="Link";var[Rs,Pe]=mt({name:"TagStylesContext",errorMessage:`useTagStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tag />" `}),te=w((r,t)=>{const s=_t("Tag",r),i=Oe(r),n={display:"inline-flex",verticalAlign:"top",alignItems:"center",maxWidth:"100%",...s.container};return e.jsx(Rs,{value:s,children:e.jsx(W.span,{ref:t,...i,__css:n})})});te.displayName="Tag";var se=w((r,t)=>{const s=Pe();return e.jsx(W.span,{ref:t,noOfLines:1,...r,__css:s.label})});se.displayName="TagLabel";var Ds=w((r,t)=>e.jsx(V,{ref:t,verticalAlign:"top",marginEnd:"0.5rem",...r}));Ds.displayName="TagLeftIcon";var Os=w((r,t)=>e.jsx(V,{ref:t,verticalAlign:"top",marginStart:"0.5rem",...r}));Os.displayName="TagRightIcon";var we=r=>e.jsx(V,{verticalAlign:"inherit",viewBox:"0 0 512 512",...r,children:e.jsx("path",{fill:"currentColor",d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})});we.displayName="TagCloseIcon";var Ts=w((r,t)=>{const{isDisabled:s,children:i,...n}=r,l={display:"flex",alignItems:"center",justifyContent:"center",outline:"0",...Pe().closeButton};return e.jsx(W.button,{ref:t,"aria-label":"close",...n,type:"button",disabled:s,__css:l,children:i||e.jsx(we,{})})});Ts.displayName="TagCloseButton";const bs=()=>e.jsxs(e.Fragment,{children:[e.jsx(ve,{}),e.jsx(Ae,{children:e.jsx(S,{width:"full",sx:{mt:8,mb:4},children:e.jsxs(G,{templateColumns:"1fr",alignItems:"center",gap:4,children:[e.jsx(R,{children:e.jsx(L,{height:"120px"})}),e.jsx(R,{children:e.jsx(L,{height:"120px"})}),e.jsx(R,{children:e.jsx(L,{height:"120px"})}),e.jsx(R,{children:e.jsx(L,{height:"120px"})}),e.jsx(R,{children:e.jsx(L,{height:"120px"})}),e.jsx(R,{children:e.jsx(L,{height:"120px"})})]})})})]});function vs(r){return r&&typeof r=="object"&&"default"in r?r.default:r}var B=vs(T),As=Object.assign||function(r){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])}return r},Ss=function(r,t){var s={};for(var i in r)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i]);return s},ge=function(t){var s=t.color,i=s===void 0?"currentColor":s,n=t.size,o=n===void 0?24:n;t.children;var l=Ss(t,["color","size","children"]),u="mdi-icon "+(l.className||"");return B.createElement("svg",As({},l,{className:u,width:o,height:o,fill:i,viewBox:"0 0 24 24"}),B.createElement("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}))},Cs=B.memo?B.memo(ge):ge,Is=Cs;const zs=ae(Is);let v;typeof window<"u"?v=window:typeof self<"u"?v=self:v=global;let re=null,ie=null;const fe=20,Y=v.clearTimeout,pe=v.setTimeout,Z=v.cancelAnimationFrame||v.mozCancelAnimationFrame||v.webkitCancelAnimationFrame,xe=v.requestAnimationFrame||v.mozRequestAnimationFrame||v.webkitRequestAnimationFrame;Z==null||xe==null?(re=Y,ie=function(t){return pe(t,fe)}):(re=function([t,s]){Z(t),Y(s)},ie=function(t){const s=xe(function(){Y(i),t()}),i=pe(function(){Z(s),t()},fe);return[s,i]});function Ls(r){let t,s,i,n,o,l,u;const g=typeof document<"u"&&document.attachEvent;if(!g){l=function(h){const _=h.__resizeTriggers__,p=_.firstElementChild,D=_.lastElementChild,A=p.firstElementChild;D.scrollLeft=D.scrollWidth,D.scrollTop=D.scrollHeight,A.style.width=p.offsetWidth+1+"px",A.style.height=p.offsetHeight+1+"px",p.scrollLeft=p.scrollWidth,p.scrollTop=p.scrollHeight},o=function(h){return h.offsetWidth!==h.__resizeLast__.width||h.offsetHeight!==h.__resizeLast__.height},u=function(h){if(h.target.className&&typeof h.target.className.indexOf=="function"&&h.target.className.indexOf("contract-trigger")<0&&h.target.className.indexOf("expand-trigger")<0)return;const _=this;l(this),this.__resizeRAF__&&re(this.__resizeRAF__),this.__resizeRAF__=ie(function(){o(_)&&(_.__resizeLast__.width=_.offsetWidth,_.__resizeLast__.height=_.offsetHeight,_.__resizeListeners__.forEach(function(A){A.call(_,h)}))})};let a=!1,d="";i="animationstart";const c="Webkit Moz O ms".split(" ");let m="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),E="";{const h=document.createElement("fakeelement");if(h.style.animationName!==void 0&&(a=!0),a===!1){for(let _=0;_<c.length;_++)if(h.style[c[_]+"AnimationName"]!==void 0){E=c[_],d="-"+E.toLowerCase()+"-",i=m[_],a=!0;break}}}s="resizeanim",t="@"+d+"keyframes "+s+" { from { opacity: 0; } to { opacity: 0; } } ",n=d+"animation: 1ms "+s+"; "}const x=function(a){if(!a.getElementById("detectElementResize")){const d=(t||"")+".resize-triggers { "+(n||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',c=a.head||a.getElementsByTagName("head")[0],m=a.createElement("style");m.id="detectElementResize",m.type="text/css",r!=null&&m.setAttribute("nonce",r),m.styleSheet?m.styleSheet.cssText=d:m.appendChild(a.createTextNode(d)),c.appendChild(m)}};return{addResizeListener:function(a,d){if(g)a.attachEvent("onresize",d);else{if(!a.__resizeTriggers__){const c=a.ownerDocument,m=v.getComputedStyle(a);m&&m.position==="static"&&(a.style.position="relative"),x(c),a.__resizeLast__={},a.__resizeListeners__=[],(a.__resizeTriggers__=c.createElement("div")).className="resize-triggers";const E=c.createElement("div");E.className="expand-trigger",E.appendChild(c.createElement("div"));const h=c.createElement("div");h.className="contract-trigger",a.__resizeTriggers__.appendChild(E),a.__resizeTriggers__.appendChild(h),a.appendChild(a.__resizeTriggers__),l(a),a.addEventListener("scroll",u,!0),i&&(a.__resizeTriggers__.__animationListener__=function(p){p.animationName===s&&l(a)},a.__resizeTriggers__.addEventListener(i,a.__resizeTriggers__.__animationListener__))}a.__resizeListeners__.push(d)}},removeResizeListener:function(a,d){if(g)a.detachEvent("onresize",d);else if(a.__resizeListeners__.splice(a.__resizeListeners__.indexOf(d),1),!a.__resizeListeners__.length){a.removeEventListener("scroll",u,!0),a.__resizeTriggers__.__animationListener__&&(a.__resizeTriggers__.removeEventListener(i,a.__resizeTriggers__.__animationListener__),a.__resizeTriggers__.__animationListener__=null);try{a.__resizeTriggers__=!a.removeChild(a.__resizeTriggers__)}catch{}}}}}class ys extends T.Component{constructor(...t){super(...t),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;const{disableHeight:s,disableWidth:i,onResize:n}=this.props;if(this._parentNode){const o=window.getComputedStyle(this._parentNode)||{},l=parseFloat(o.paddingLeft||"0"),u=parseFloat(o.paddingRight||"0"),g=parseFloat(o.paddingTop||"0"),x=parseFloat(o.paddingBottom||"0"),f=this._parentNode.getBoundingClientRect(),j=f.height-g-x,a=f.width-l-u,d=this._parentNode.offsetHeight-g-x,c=this._parentNode.offsetWidth-l-u;(!s&&(this.state.height!==d||this.state.scaledHeight!==j)||!i&&(this.state.width!==c||this.state.scaledWidth!==a))&&(this.setState({height:d,width:c,scaledHeight:j,scaledWidth:a}),typeof n=="function"&&n({height:d,scaledHeight:j,scaledWidth:a,width:c}))}},this._setRef=s=>{this._autoSizer=s}}componentDidMount(){const{nonce:t}=this.props,s=this._autoSizer?this._autoSizer.parentNode:null;if(s!=null&&s.ownerDocument&&s.ownerDocument.defaultView&&s instanceof s.ownerDocument.defaultView.HTMLElement){this._parentNode=s;const i=s.ownerDocument.defaultView.ResizeObserver;i!=null?(this._resizeObserver=new i(()=>{this._timeoutId=setTimeout(this._onResize,0)}),this._resizeObserver.observe(s)):(this._detectElementResize=Ls(t),this._detectElementResize.addResizeListener(s,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),this._timeoutId!==null&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){const{children:t,defaultHeight:s,defaultWidth:i,disableHeight:n=!1,disableWidth:o=!1,doNotBailOutOnEmptyChildren:l=!1,nonce:u,onResize:g,style:x={},tagName:f="div",...j}=this.props,{height:a,scaledHeight:d,scaledWidth:c,width:m}=this.state,E={overflow:"visible"},h={};let _=!1;return n||(a===0&&(_=!0),E.height=0,h.height=a,h.scaledHeight=d),o||(m===0&&(_=!0),E.width=0,h.width=m,h.scaledWidth=c),l&&(_=!1),T.createElement(f,{ref:this._setRef,style:{...E,...x},...j},!_&&t(h))}}const Ps=r=>{const{isDraft:t,isOpen:s,onClose:i}=r,n=T.useRef(),{state:o,retry:l}=as(),u=()=>{const{filteredData:g,handleSearchInputChange:x}=Se(n.current??[],["screen_name"]),f=30,j=({style:a,index:d,data:c})=>{const m=c?.[d];return m!=null?e.jsx(e.Fragment,{children:e.jsx(us,{style:a,children:m.habilitado?e.jsx(ye,{href:y(t?Ot:Tt,{client:m.id}),children:e.jsxs(S,{children:[e.jsx(me,{as:ls,color:"green.400"}),m.screen_name]})}):e.jsxs(S,{color:"gray.400",sx:{cursor:"not-allowed"},children:[e.jsx(me,{as:os,color:"red.400"}),m.screen_name]})},m.id)}):e.jsx(e.Fragment,{})};return e.jsxs(e.Fragment,{children:[e.jsx(S,{sx:{pb:4},children:e.jsx(Ce,{handleSearchInputChange:x})}),e.jsx(ys,{children:({height:a,width:d})=>e.jsx(ds,{height:a-60,itemCount:g.length??0,itemSize:f,innerElementType:hs,width:d,itemData:g,children:j})})]})};return e.jsxs(gt,{isCentered:!0,isOpen:s,onClose:i,scrollBehavior:"inside",size:{base:"full",sm:"md",md:"lg"},children:[e.jsx(ft,{bg:"blackAlpha.800"}),e.jsxs(pt,{sx:{maxHeight:"auto"},children:[e.jsx(xt,{children:"Seleccione el cliente"}),e.jsx(jt,{}),e.jsx(Et,{minHeight:{base:"auto",sm:"420px !important"},children:o.map({loading:g=>e.jsxs(ms,{spacing:4,children:[e.jsx(ce,{width:"full",height:"36px",borderRadius:"md"}),e.jsx(ce,{width:"full",height:"250px",borderRadius:"md"})]}),error:({error:g})=>e.jsx(be,{error:g,retry:l,cancelAndNavigateTo:Rt}),success:g=>(n.current=Dt.sortBy(g.data,["screen_name"]),e.jsx(u,{}))})})]})]})},ne="setUnsetSelectedPedido",ws=({isDraft:r,pedidos:t,stateRenglones:s,handleSearchInputChange:i})=>{const n=Ie(),[o,l]=T.useState(!1),{isOpen:u,onOpen:g,onClose:x}=Vt(),[f,j]=T.useState([]);T.useRef({pedidos:[],renglones:{}}),T.useEffect(()=>{const E=({id:h,checked:_})=>{j(_?p=>[...p,h]:p=>p.filter(D=>D!==h))};return P.on(ne,E),()=>{P.removeListener(ne,E)}},[]);const a=()=>{if(n.authState.isCustomer()){n.navigate(r?St:Ct);return}l(!0),g()},d=()=>{x(),l(!1)},c=()=>{Array.isArray(f)&&window.open(`${It}?orderId=${f.join("&orderId=")}`,"OrderPrintWindow","width=640,height=480")},m=f.length<=0?void 0:f.length==1?`1 ${ts}`:`${f.length} ${ss}`;return e.jsxs(e.Fragment,{children:[e.jsxs(ee,{flex:1,alignItems:"center",justifyContent:"space-between",sx:{mx:4},children:[e.jsxs(_e,{spacing:{base:2,sm:3},alignItems:"center",children:[(n.authState.isSeller()||n.authState.isCustomer())&&e.jsx(e.Fragment,{children:e.jsx(he,{icon:zs,text:r?bt:vt,sharedProps:{size:"sm",fontWeight:"400",colorScheme:r?"green":"orange",onClick:()=>{a()},isDisabled:!r&&!n.authState.userInfo.puede_crear_pedido},iconProps:{boxSize:{base:5,md:4}}})}),!r&&e.jsx(he,{icon:Yt,text:At,sharedProps:{size:"sm",fontWeight:"400",colorScheme:"blue",onClick:()=>c(),isDisabled:f.length<=0},iconProps:{boxSize:{base:5,md:4}}}),m!=null&&e.jsxs(e.Fragment,{children:[e.jsx(te,{display:{base:"none",sm:"inherited"},height:8,borderRadius:40,size:"md",variant:"solid",colorScheme:"blue",children:e.jsx(se,{marginX:1,children:m})}),e.jsx(te,{display:{base:"inherited",sm:"none"},height:8,borderRadius:40,size:"md",variant:"solid",colorScheme:"blue",children:e.jsx(se,{marginX:1,children:f.length})})]})]}),e.jsx(ee,{alignItems:"center",marginLeft:4,children:e.jsx(_e,{spacing:{base:2,md:4},children:e.jsx(S,{children:e.jsx(Ce,{handleSearchInputChange:i})})})})]}),o&&e.jsx(Ps,{isDraft:r,isOpen:u,onClose:d})]})};function Ns(r){return r&&typeof r=="object"&&"default"in r?r.default:r}var U=Ns(T),Fs=Object.assign||function(r){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])}return r},ks=function(r,t){var s={};for(var i in r)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i]);return s},je=function(t){var s=t.color,i=s===void 0?"currentColor":s,n=t.size,o=n===void 0?24:n;t.children;var l=ks(t,["color","size","children"]),u="mdi-icon "+(l.className||"");return U.createElement("svg",Fs({},l,{className:u,width:o,height:o,fill:i,viewBox:"0 0 24 24"}),U.createElement("path",{d:"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"}))},Ms=U.memo?U.memo(je):je,Hs=Ms;const Bs=ae(Hs);function Us(r,t){return t.isSuccess()?Zt(r,t.data[r.id]):r.estado}function Ne(r,t){let s;switch(r){case C.INGRESADO:s="blue";break;case C.APROBADO:s="purple";break;case C.CUMPLIDO:s="green";break;case C.CERRADO:s="black";break;case C.ANULADO:s="red";break;default:s="gray"}return t==null?s:`${s}${t}`}function $s(r){return r&&typeof r=="object"&&"default"in r?r.default:r}var $=$s(T),Ws=Object.assign||function(r){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])}return r},Vs=function(r,t){var s={};for(var i in r)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i]);return s},Ee=function(t){var s=t.color,i=s===void 0?"currentColor":s,n=t.size,o=n===void 0?24:n;t.children;var l=Vs(t,["color","size","children"]),u="mdi-icon "+(l.className||"");return $.createElement("svg",Ws({},l,{className:u,width:o,height:o,fill:i,viewBox:"0 0 24 24"}),$.createElement("path",{d:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"}))},Gs=$.memo?$.memo(Ee):Ee,qs=Gs;const Ks=ae(qs),Xs=({app:r,isDraft:t,pedido:s,onDelete:i,onMarkAsFavorite:n})=>{const o=r.authState.userInfo,l=r.authState.isAdmin(),u=t&&s.es_favorito,g=!l&&(t||o.puede_crear_pedido),x=!l&&t&&o.puede_crear_pedido,f=!l&&!t,j=!l&&(t||o.puede_editar_pedido&&Jt(o,s.estado)),a=!u&&(t||de(o,s.estado)),d=t||o.borrar_pedido_al_anular;return e.jsxs(_s,{isLazy:!0,id:"menu",children:[e.jsx($t,{as:gs,size:"sm","aria-label":rs,icon:e.jsx(Ks,{}),variant:"outline",colorScheme:"white"}),e.jsx(zt,{children:e.jsxs(Wt,{rootProps:{zIndex:2e3},children:[j&&e.jsx(I,{onClick:()=>{r.navigate(y(t?Lt:yt,{id:s.id}))},children:Fe}),g&&e.jsx(I,{onClick:()=>{r.navigate(y(t?Pt:wt,{id:s.id}))},children:ke}),x&&e.jsx(I,{onClick:()=>{r.navigate(y(Nt,{id:s.id}))},children:u?Me:He}),f&&e.jsx(I,{onClick:()=>{r.navigate(y(Ft,{id:s.id}))},children:Be}),t&&!u&&e.jsxs(e.Fragment,{children:[x&&e.jsx(I,{onClick:()=>{r.navigate(y(kt,{id:s.id}))},children:Ue}),e.jsx(X,{}),e.jsx(I,{onClick:()=>n(s.id,!0),children:$e})]}),u&&e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsx(I,{onClick:()=>n(s.id,!1),children:We})]}),(t||de(o,s.estado))&&e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsx(I,{onClick:()=>i(s.id),isDisabled:u||!a,children:u?Ve:d?Ge:qe})]})]})})]})},Ys=()=>e.jsxs(N,{status:"warning",children:[e.jsx(oe,{}),e.jsx(F,{children:"El pedido no cuenta con productos."})]}),Zs=()=>e.jsxs(N,{status:"error",children:[e.jsx(oe,{}),e.jsx(F,{children:"Ocurrió un error al cargar los detalles del pedido."})]}),Js=()=>e.jsx(S,{width:"full",sx:{mt:8,mb:4},children:e.jsxs(G,{templateColumns:"1fr",alignItems:"center",gap:2,children:[e.jsx(R,{children:e.jsx(k,{height:"20px"})}),e.jsx(R,{children:e.jsx(k,{height:"20px"})}),e.jsx(R,{children:e.jsx(k,{height:"20px"})}),e.jsx(R,{children:e.jsx(k,{height:"20px"})})]})}),Qs=({nro_pedido:r,renglones:t})=>{const s=Q("var(--chakra-colors-gray-200)","var(--chakra-colors-black)"),i=Q("var(--chakra-colors-gray-400)","var(--chakra-colors-black)");return e.jsxs("table",{width:"100%",cellPadding:8,cellSpacing:4,style:{fontSize:"0.8rem",border:`1px solid ${i}`},children:[e.jsx("thead",{style:{backgroundColor:`${s}`,textTransform:"uppercase"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left",style:{width:"55%"},children:"Artículo"}),e.jsx("th",{className:"text-right hidden-on-base",style:{width:"10%"},children:"Precio"}),e.jsx("th",{className:"text-center",style:{width:"12%"},children:"Cant."}),e.jsx("th",{className:"text-right",style:{width:"13%"},children:"Subtotal"})]})}),e.jsx("tbody",{children:t.map(({id_articulo:n,nombre_articulo:o,codigo_articulo:l,descripcion_adicional:u,precio:g,cantidad:x,subtotal:f},j)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(z,{children:Ke(o,l,u)})}),e.jsx("td",{className:"text-right hidden-on-base",children:e.jsx(H,{precio:g,moneda:"$"})}),e.jsx("td",{children:e.jsx(M,{textAlign:"center",children:x})}),e.jsx("td",{className:"text-right",children:e.jsx(H,{precio:f,moneda:"$"})})]},`details-${r}-${j}`))})]})},er=({wasOpen:r,pedido:t,stateRenglones:s})=>e.jsx(S,{sx:{mt:6},children:r&&s.map({loading:i=>e.jsx(Js,{}),error:i=>e.jsx(Zs,{}),success:i=>{const{id:n,numero_pedido:o}=t,l=i.data?.[n];return Array.isArray(l)?e.jsx(Qs,{nro_pedido:o,renglones:l}):e.jsx(Ys,{})}})}),tr=({estado:r})=>{const t=Qt(r),s=Ne(r);return e.jsx(fs,{fontSize:"1em",variant:"solid",colorScheme:s,lineHeight:"1.5em",children:t})},sr=r=>{const{app:t,pedido:s,total:i,estado:n,handleToggleDetails:o}=r,{numero_pedido:l,fecha_alta:u,fecha_entrega:g,codigo_cliente:x,codigo_vendedor:f,codigo_transporte:j,nombre_cliente:a,nombre_vendedor:d,nombre_transporte:c,descuento:m,comentarios:E,sin_iva:h,sin_ii:_}=s,p=t.authState.isSeller(),D=t.authState.isCustomer(),A=E!=null&&E.length>0;return e.jsxs(G,{templateColumns:{base:"repeat(2, 1fr)",lg:"repeat(4, 1fr)"},gap:6,sx:{cursor:"pointer"},onClick:()=>{o()},children:[e.jsxs(R,{children:[e.jsx(O,{size:"sm",children:"Pedido"}),e.jsx(M,{children:l})]}),e.jsxs(R,{children:[e.jsx(O,{size:"sm",children:"Estado"}),e.jsx(tr,{estado:n})]}),e.jsxs(R,{children:[e.jsx(O,{size:"sm",children:"Emisión"}),e.jsx(M,{children:le(u)})]}),e.jsxs(R,{children:[e.jsx(O,{size:"sm",children:"Entrega"}),e.jsx(M,{children:le(g)})]}),!D&&e.jsxs(R,{...p?{colSpan:{base:1,lg:2}}:void 0,children:[e.jsxs(O,{size:"sm",children:["Cliente ",x]}),e.jsx(z,{children:a})]}),!p&&!D&&e.jsxs(R,{children:[e.jsxs(O,{size:"sm",children:["Vendedor ",f]}),e.jsx(z,{children:d})]}),e.jsxs(R,{...D?{colSpan:{base:1,lg:3}}:void 0,...p?{colSpan:{base:1,lg:1}}:void 0,children:[e.jsxs(O,{size:"sm",children:["Transporte ",j]}),e.jsx(z,{children:c})]}),e.jsxs(R,{...p?{colSpan:{base:2,lg:1}}:void 0,children:[e.jsxs(O,{size:"sm",sx:{textTransform:"uppercase",color:n===C.APROBADO&&"green.400",whiteSpace:"normal"},children:["Total ",m>0&&e.jsx(e.Fragment,{children:` -${m}%`}),e.jsxs("span",{style:{fontSize:"small"},children:[" ",`(${De(h,_)})`]})]}),e.jsx(O,{size:"sm",sx:{fontWeight:"bolder",color:n===C.APROBADO&&"green.400"},children:i!=null&&e.jsx(H,{precio:i,moneda:"$"})})]}),A&&e.jsx(R,{colSpan:{base:2,lg:4},children:e.jsx(N,{status:"info",children:e.jsx(F,{dangerouslySetInnerHTML:{__html:Te(E)},sx:{whiteSpace:"normal"}})})})]})},rr=r=>{const{app:t,pedido:s,estado:i,total:n,handleToggleDetails:o}=r,{codigo_cliente:l,codigo_vendedor:u,codigo_transporte:g,nombre_cliente:x,nombre_vendedor:f,nombre_transporte:j,descuento:a,comentarios:d,descripcion:c,es_favorito:m,sin_iva:E,sin_ii:h}=s,_=t.authState.isSeller(),p=t.authState.isCustomer(),D=d!=null&&d.length>0,A={base:_||p?1:2,md:_?2:p?1:2,lg:_?3:p?2:4},b={base:_||p?"repeat(1, 1fr)":"repeat(2, 1fr)",md:_?"repeat(2, 1fr)":p?"repeat(1, 1fr)":"repeat(2, 1fr)",lg:_?"repeat(3, 1fr)":p?"repeat(2, 1fr)":"repeat(4, 1fr)"};return e.jsxs(G,{templateColumns:b,gap:6,sx:{cursor:"pointer"},onClick:()=>{o()},children:[e.jsx(R,{colSpan:A,children:e.jsx(O,{size:"md",textTransform:"uppercase",children:c})}),!p&&e.jsxs(R,{children:[e.jsxs(O,{size:"sm",children:["Cliente ",l]}),e.jsx(z,{children:x})]}),!_&&!p&&e.jsxs(R,{children:[e.jsxs(O,{size:"sm",children:["Vendedor ",u]}),e.jsx(z,{children:f})]}),e.jsxs(R,{children:[e.jsxs(O,{size:"sm",children:["Transporte ",g]}),e.jsx(z,{children:j})]}),e.jsxs(R,{children:[e.jsxs(O,{size:"sm",sx:{textTransform:"uppercase",color:i===C.APROBADO&&"green.400",whiteSpace:"normal"},children:["Total ",a>0&&e.jsx(e.Fragment,{children:` -${a}%`}),e.jsxs("span",{style:{fontSize:"small"},children:[" ",`(${De(E,h)})`]})]}),e.jsx(O,{size:"sm",sx:{fontWeight:"bolder",color:i===C.APROBADO&&"green.400"},children:n!=null&&e.jsx(H,{precio:n,moneda:"$"})})]}),D&&e.jsx(R,{colSpan:A,children:e.jsx(N,{status:"info",children:e.jsx(F,{dangerouslySetInnerHTML:{__html:Te(d)},sx:{whiteSpace:"normal"}})})})]})};function ir(r,t){return t.isSuccess()?es(r,t.data[r.id]):null}const J="togglePedidoDetails",nr=({index:r,app:t,draft:s,pedido:i,stateRenglones:n,handleDelete:o,handleMarkAsFavorite:l,isHidden:u})=>{const[g,x]=T.useState(!1),[f,j]=T.useState(!1),a=Q("gray.800","white"),d=T.useRef(!1),c=Us(i,n),m=i.total!=null?i.total:ir(i,n),E=T.useMemo(()=>e.jsx(er,{wasOpen:d.current,pedido:i,stateRenglones:n}),[d.current,n.constructor.name]),h=()=>{const b=!g;b&&(d.current=!0),x(b),P.emit(J,{id:i.id})},_=(b,q)=>{j(!!b),P.emit(ne,{id:q,checked:b})};T.useEffect(()=>{const b=({id:q})=>{i.id!==q&&x(!1)};return P.on(J,b),()=>{P.removeListener(J,b)}},[]);const{id:p,es_favorito:D}=i,A=s&&D;return e.jsx(ze,{sx:{...u&&!f&&{display:"none"}},children:e.jsxs(Le,{sx:{py:6,position:"relative",borderTopWidth:s?void 0:{base:"3px",md:"4px"},borderTopStyle:s?void 0:"solid",borderTopColor:s?void 0:Ne(c,".500 !important"),borderWidth:s?{base:"2px",md:"3px"}:void 0,borderStyle:s?"dashed":void 0,borderColor:s?D?"orange.500 !important":"blue.500 !important":void 0},children:[e.jsxs(S,{display:"flex",sx:{position:"absolute",right:2,top:5},flexDirection:"column",children:[e.jsx(Xs,{app:t,isDraft:s,pedido:i,onDelete:o,onMarkAsFavorite:l}),A&&e.jsx(ee,{backgroundColor:"orange",justifyContent:"center",alignItems:"center",sx:{mt:2,borderRadius:4,aspectRatio:1},children:e.jsx(V,{as:Bs,boxSize:4,color:"white"})}),!s&&e.jsx(ps,{size:"xl",colorScheme:"blue",sx:{mt:2,borderWidth:0,borderColor:a},onChange:b=>{_(b.target.checked,p)}})]}),s?e.jsx(rr,{app:t,pedido:i,estado:c,total:m,handleToggleDetails:h}):e.jsx(sr,{app:t,pedido:i,estado:c,total:m,handleToggleDetails:h}),e.jsx(S,{children:e.jsx(S,{sx:{display:g?"block":"none"},children:E})},`pedido-details-${r}`)]})})};function ar(r){const t=Ie(),i=t.authState.userInfo.borrar_pedido_al_anular.valueOf(),{draft:n,unfilteredPedidos:o,filteredPedidos:l,isFiltering:u,stateRenglones:g,reloadData:x}=r,f=Es(),j=cs(),a=async c=>{if(await j({title:n?Ye:i?Ze:Je,message:n?Qe:i?et:tt})==ue.accept){const E=n?await Gt(c,t):await qt(c,t);E.map({success:h=>{f({title:n?st:i?rt:it,status:"success"})},error:h=>{f({title:Ht,status:"error"})}}),E.isSuccess()&&await x()}},d=async(c,m)=>{if(m){(await Kt(c,t)).isSuccess()&&await x();return}await j({title:nt,message:at})==ue.accept&&(await Xt(c,t)).isSuccess()&&await x()};return e.jsx(Xe,{sx:{p:0,m:0},children:e.jsx(xs,{variant:"stripedOverCard",colorScheme:"gray",size:"md",sx:{borderCollapse:"separate",borderSpacing:"0 1rem"},children:e.jsxs(js,{children:[o.map((c,m)=>e.jsx(nr,{index:m,draft:n,app:t,pedido:c,stateRenglones:g,handleDelete:a,handleMarkAsFavorite:d,isHidden:u&&!l.includes(c)},`pedido-${c.id}`)),!l.length&&e.jsx(ze,{children:e.jsx(Le,{children:e.jsxs(N,{status:"info",children:[e.jsx(oe,{}),e.jsx(F,{children:u?Mt:n?is:ns})]})})})]})})})}const or=r=>{const{showDrafts:t,pedidos:s,reloadData:i}=r,n=Bt().state.userOrThrow(),o=n.role==K.admin;n.role==K.seller;const l=n.role==K.customer,{filteredData:u,handleSearchInputChange:g,isFiltering:x}=Se(s,["descripcion","comentarios",...t?[]:["numero_pedido"],...l?[]:["codigo_cliente","nombre_cliente"],...o?["codigo_vendedor","nombre_vendedor"]:[]]),{state:f}=Re({...t?ot:lt,silent:!0,transformResponse:j=>(Object.values(j).forEach(a=>{Array.isArray(a)&&a.sort((d,c)=>d.renglon-c.renglon)}),j)});return e.jsxs(e.Fragment,{children:[e.jsx(ve,{children:e.jsx(ws,{isDraft:t,pedidos:s,stateRenglones:f,handleSearchInputChange:g})}),e.jsx(Ae,{children:e.jsx(ar,{draft:t,stateRenglones:f,unfilteredPedidos:s,filteredPedidos:u,isFiltering:x,reloadData:i})})]})},Ur=r=>{const t=r.showDrafts===!0,{state:s,retry:i,reload:n}=Re({...t?ct:dt,silent:!0});return s.map({loading:o=>e.jsx(bs,{}),error:({error:o})=>e.jsx(be,{error:o,retry:i,cancelAndNavigateTo:Ut}),success:o=>{const l=t?o.data.sort(lr):o.data.sort(cr);return e.jsx(or,{showDrafts:t,pedidos:l,reloadData:n})}})};function lr(r,t){const s=r.es_favorito?1:0,i=t.es_favorito?1:0,n=s-i;if(n!=0)return n;const o=new Date(r.fecha_ingreso).getTime();return new Date(t.fecha_ingreso).getTime()-o}function cr(r,t){const s=r.estado-t.estado;if(s!=0)return s;const i=r.numero_pedido,n=t.numero_pedido;return i.localeCompare(n)}export{Ur as O};
