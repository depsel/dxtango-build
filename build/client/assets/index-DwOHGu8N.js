import{j as t,u as X}from"./emotion-element-5486c51c.browser.esm-CMT9BBIk.js";import{aC as $,aQ as B,aR as k,U as f,a1 as R,Q as u,R as D}from"./auth_context-1lRrAoj9.js";import{A as H}from"./ApiErrors-BAr_xJ4-.js";import{a as M,F as E}from"./FormSkeletons-CCz5n5Mq.js";import{B as A}from"./chunk-PULVB27S-DtbcLAA3.js";import{G as m,a as n}from"./chunk-ZPFGWTBB-lx3V9y0x.js";import{T as I}from"./chunk-2OOHT3W5-rFMCTWJa.js";import{c as O,a as Q,e as Z,f as J,d as v,o as G}from"./index.esm-CzxlHhdA.js";import{u as N}from"./app_resources-7xCa0BDG.js";import{L as w,P as K,s as W}from"./app-DHK1Xtws.js";import{C as x}from"./CommonCard-ZsFI_XX0.js";import{C as F}from"./ControlledTextarea-qOPAe3cp.js";import{F as U}from"./FormErrors-CLM3bwt7.js";import{S as q}from"./SettingsFormButtons-v13JEq_c.js";import{A as i}from"./index-CIB9SwPf.js";import{a as Y}from"./utils-DQu-C9ov.js";import{A as tt}from"./index-Cd2PmgfM.js";import{u as y}from"./chunk-6RSEZNRH-02MJPxwp.js";import{u as z}from"./useDXTApiFetch-DkCgIYCg.js";import{S as rt}from"./SettingsFormHeading-pg9uw8W1.js";import{C as et}from"./ControlledSelect-P32LK7nc.js";import{C as st}from"./ControlledSwitch-Dj6AtEy6.js";const ot=r=>{const{options:e}=r;return t.jsx(A,{width:"full",sx:{mt:8,mb:4},children:t.jsxs(m,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[t.jsx(n,{children:t.jsx(M,{height:"380px"})}),t.jsx(n,{children:t.jsx(I,{fontSize:"sm",children:e.description})}),t.jsx(n,{children:t.jsx(E,{})}),t.jsx(n,{children:t.jsx(E,{})})]})})};function at(r){if($(r))switch(r){case 0:return i.none;case 1:return i.space;case 2:return i.dash;case 3:return i.underscore;case 4:return i.lettersAndNumbers}throw new B(`Invalid article group separator number: ${k(r,!0)}`)}const V=O({list:Q().default("").test("avoid-ARTICLE_GROUP_NO_NAME",`Evite utilizar ${tt}`,function(r){return!/(^|[^a-zA-Z0-9])_([^a-zA-Z0-9]|$)/.test(r)})}).required(),it=V.concat(O({list_enabled:Z().required(),group_separator:J().typeError("Ingrese un separador de grupo").test("is-group-separator","Ingrese un separador de grupo válido",r=>Y(()=>at(r))).required()}).required()),nt=V,lt=r=>{const{stateData:e,options:o}=r,a=N(),s=y(),{handleSubmit:_,control:d,reset:C,setError:j,formState:{errors:b,isSubmitting:g,isSubmitSuccessful:h}}=v({defaultValues:{list:e.join(`\r
`)||""},resolver:G(nt)}),l=h||g,S=async T=>{const c={lista:T.list.split(`
`)};(await o.apiPost(c,a)).map({success:p=>{s({title:w,status:"success"}),a.navigate(f)},error:p=>{s({title:p.errorInfoOrNull()?.error_description??R,status:"error"}),j("root",{message:p.info.error_description})}})};return t.jsx("form",{noValidate:!0,onSubmit:_(S),children:t.jsxs(A,{children:[t.jsx(U,{errors:b}),t.jsx(x,{children:t.jsxs(m,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[t.jsx(n,{children:t.jsx(F,{fieldProps:{name:"list",id:"list",rows:20,fontSize:"sm"},formControlProps:{isDisabled:l},control:d})}),t.jsx(n,{children:t.jsx(I,{fontSize:"sm",children:o.description})})]})}),t.jsx(x,{children:t.jsx(q,{isLoading:l,hideCancelButton:!0})})]})})},dt=u("/dxt/articulo/print_list","GET"),ct=u("/dxt/articulo/print_list","POST"),ut=u("/dxt/articulo/edit_list","GET"),pt=u("/dxt/articulo/edit_list","POST");u("/dxt/articulo/print_list/ids","GET");const mt=async(r,e)=>await D({...ct,data:r,silent:!0},e),xt=async(r,e)=>await D({...pt,data:r,silent:!0},e);function ft(){return z({...ut,silent:!0})}function _t(){return z({...dt,silent:!0})}const jt=r=>{const{stateData:e,options:o}=r,a=N(),s=y(),{handleSubmit:_,control:d,setError:C,formState:{errors:j,isSubmitting:b,isSubmitSuccessful:g},watch:h}=v({defaultValues:{list_enabled:e.lista_activa,group_separator:e.separador_grupo,list:e.lista.join(`\r
`)||""},resolver:G(it)}),l=g||b,S=h("list_enabled"),T=async c=>{const L={lista:c.list.split(`
`),lista_activa:c.list_enabled,separador_grupo:c.group_separator};(await o.apiPost(L,a)).map({success:P=>{s({title:w,status:"success"}),a.navigate(f)},error:P=>{s({title:P.errorInfoOrNull()?.error_description??R,status:"error"}),C("root",{message:P.info.error_description})}})};return t.jsx("form",{noValidate:!0,onSubmit:_(T),children:t.jsxs(A,{children:[t.jsx(U,{errors:j}),t.jsx(x,{children:t.jsxs(m,{gap:4,children:[t.jsx(et,{fieldProps:{name:"group_separator",options:[{label:"Ninguno",value:i.none},{label:"Espacio",value:i.space},{label:"Guión",value:i.dash},{label:"Guión bajo",value:i.underscore},{label:"Letras y números",value:i.lettersAndNumbers}],selectedOptionStyle:"check"},formControlProps:{isDisabled:l,width:400},formControlInnerProps:{label:"Separador de grupo de artículo"},control:d}),t.jsx(st,{fieldProps:{name:"list_enabled",id:"list_enabled"},formControlProps:{width:"auto",isDisabled:l,mb:"-10px"},formControlInnerProps:{label:"Lista personalizada"},control:d}),t.jsxs(m,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[t.jsx(n,{children:t.jsx(F,{fieldProps:{name:"list",id:"list",rows:20,fontSize:"sm"},formControlProps:{isDisabled:l||!S},control:d})}),t.jsx(n,{children:t.jsx(I,{fontSize:"sm",children:o.description})})]})]})}),t.jsx(x,{children:t.jsx(q,{isLoading:l,hideCancelButton:!0})})]})})};var bt=(r=>(r[r.edit=0]="edit",r[r.print=1]="print",r))(bt||{});const gt={apiGetAll:ft,apiPost:xt,title:K,description:t.jsxs(t.Fragment,{children:["Ingrese en la lista los códigos de artículo en el órden en que desea que aparezcan durante la edición de un pedido o borrador.",t.jsx("br",{}),t.jsx("br",{}),"Cualquier línea que ingrese, que no contenga ningún código de artículo, será considerada como título de grupo."]})},ht={apiGetAll:_t,apiPost:mt,title:W,description:t.jsxs(t.Fragment,{children:["Los pedidos y borradores se guardarán ordenando los artículos según esta lista.",t.jsx("br",{}),t.jsx("br",{}),"Además a cada ítem puede asignarle parámetros adicionales, como la cantidad de unidades por bulto.",t.jsx("br",{}),t.jsx("br",{}),'Por ejemplo, la siguente línea indica el artículo "01 35", y además define que cada bulto posee 12 unidades:',t.jsx("br",{}),t.jsx("br",{}),t.jsx("b",{children:"01 35; b=12"})]})},Bt=r=>{const e=X(),{type:o}=r,a=o==0?gt:ht;return t.jsxs(t.Fragment,{children:[t.jsx(rt,{title:a.title,returnButton:{buttonProps:{onClick:()=>{e(f)}}}}),t.jsx(St,{type:o,options:a})]})},St=({options:r,type:e})=>{const{state:o,retry:a}=r.apiGetAll();return o.map({loading:s=>t.jsx(ot,{options:r}),error:({error:s})=>t.jsx(H,{error:s,retry:a,cancelAndNavigateTo:f}),success:s=>e==0?t.jsx(jt,{stateData:s.data,options:r}):t.jsx(lt,{stateData:s.data,options:r})})};export{Bt as P,bt as a};
