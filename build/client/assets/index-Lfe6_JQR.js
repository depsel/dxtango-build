import{j as t,u as B}from"./emotion-element-5486c51c.browser.esm-CMT9BBIk.js";import{aD as k,aT as H,aU as M,U as _,a6 as D,X as u,Y as v}from"./auth_context-CCfWU2Jo.js";import{A as Z}from"./ApiErrors-Blpol96Y.js";import{a as W,F as C}from"./FormSkeletons-Ch1cmlVo.js";import{B as P}from"./chunk-PULVB27S-C1tz_n3L.js";import{G as x,a as l}from"./chunk-ZPFGWTBB-Bu2gzu07.js";import{T as I}from"./chunk-2OOHT3W5-CC38uFWT.js";import{c as G,a as Y,e as J,f as K,d as O,o as N}from"./index.esm-CzxlHhdA.js";import{u as U}from"./app_resources-Di8KxAHS.js";import{L as F,P as Q,s as tt}from"./app-DHK1Xtws.js";import{C as j}from"./CommonCard-CfkzH5Am.js";import{C as q}from"./ControlledTextarea-CtVdSOvZ.js";import{F as w}from"./FormErrors-COO1VgQ3.js";import{S as y}from"./SettingsFormButtons-BcygzEqX.js";import{A as i}from"./index-CIB9SwPf.js";import{a as rt}from"./utils-DQu-C9ov.js";import{A as et}from"./index-CoXMS8wA.js";import{u as z}from"./chunk-6RSEZNRH-p2hFl890.js";import{u as V}from"./useDXTApiFetch-D7fvlkDE.js";import{S as st}from"./SettingsFormHeading-389CUOcW.js";import{C as at}from"./ControlledSelect-DDMsMwex.js";import{R as ot,a as R}from"./chunk-RDF2AYID-Ckn2v1iE.js";const it=r=>{const{options:e}=r;return t.jsx(P,{width:"full",sx:{mt:8,mb:4},children:t.jsxs(x,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[t.jsx(l,{children:t.jsx(W,{height:"380px"})}),t.jsx(l,{children:t.jsx(I,{fontSize:"sm",children:e.description})}),t.jsx(l,{children:t.jsx(C,{})}),t.jsx(l,{children:t.jsx(C,{})})]})})};function nt(r){if(k(r))switch(r){case 0:return i.none;case 1:return i.space;case 2:return i.dash;case 3:return i.underscore;case 4:return i.lettersAndNumbers}throw new H(`Invalid article group separator number: ${M(r,!0)}`)}const X=G({list:Y().default("").test("avoid-ARTICLE_GROUP_NO_NAME",`Evite utilizar ${et}`,function(r){return!/(^|[^a-zA-Z0-9])_([^a-zA-Z0-9]|$)/.test(r)})}).required(),lt=X.concat(G({list_enabled:J().required(),group_separator:K().typeError("Ingrese un separador de grupo").test("is-group-separator","Ingrese un separador de grupo válido",r=>rt(()=>nt(r))).required()}).required()),dt=X,ct=r=>{const{stateData:e,options:a}=r,o=U(),s=z(),{handleSubmit:f,control:p,reset:L,setError:g,formState:{errors:b,isSubmitting:h,isSubmitSuccessful:S}}=O({defaultValues:{list:e.join(`\r
`)||""},resolver:N(dt)}),m=S||h,T=async d=>{const c={lista:d.list.split(`
`)};(await a.apiPost(c,o)).map({success:n=>{s({title:F,status:"success"}),o.navigate(_)},error:n=>{s({title:n.errorInfoOrNull()?.error_description??D,status:"error"}),g("root",{message:n.info.error_description})}})};return t.jsx("form",{noValidate:!0,onSubmit:f(T),children:t.jsxs(P,{children:[t.jsx(w,{errors:b}),t.jsx(j,{children:t.jsxs(x,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[t.jsx(l,{children:t.jsx(q,{fieldProps:{name:"list",id:"list",rows:20,fontSize:"sm"},formControlProps:{isDisabled:m},control:p})}),t.jsx(l,{children:t.jsx(I,{fontSize:"sm",children:a.description})})]})}),t.jsx(j,{children:t.jsx(y,{isLoading:m,hideCancelButton:!0})})]})})},ut=u("/dxt/articulo/print_list","GET"),pt=u("/dxt/articulo/print_list","POST"),mt=u("/dxt/articulo/edit_list","GET"),xt=u("/dxt/articulo/edit_list","POST");u("/dxt/articulo/print_list/ids","GET");const jt=async(r,e)=>await v({...pt,data:r,silent:!0},e),_t=async(r,e)=>await v({...xt,data:r,silent:!0},e);function ft(){return V({...mt,silent:!0})}function gt(){return V({...ut,silent:!0})}const bt=r=>{const{stateData:e,options:a}=r,o=U(),s=z(),{handleSubmit:f,control:p,setError:L,formState:{errors:g,isSubmitting:b,isSubmitSuccessful:h},setValue:S,watch:m}=O({defaultValues:{list_enabled:e.lista_activa,group_separator:e.separador_grupo,list:e.lista.join(`\r
`)||""},resolver:N(lt)}),T=n=>{S("list_enabled",n=="1")},d=h||b,c=m("list_enabled"),E=async n=>{const $={lista:n.list.split(`
`),lista_activa:n.list_enabled,separador_grupo:n.group_separator};(await a.apiPost($,o)).map({success:A=>{s({title:F,status:"success"}),o.navigate(_)},error:A=>{s({title:A.errorInfoOrNull()?.error_description??D,status:"error"}),L("root",{message:A.info.error_description})}})};return t.jsx("form",{noValidate:!0,onSubmit:f(E),children:t.jsxs(P,{children:[t.jsx(w,{errors:g}),t.jsx(j,{children:t.jsx(x,{gap:4,children:t.jsxs(ot,{onChange:T,value:c?"1":"0",children:[t.jsx(R,{value:"0",mb:2,children:"Lista agrupada por código"}),t.jsx(at,{fieldProps:{name:"group_separator",options:[{label:"Ninguno",value:i.none},{label:"Espacio",value:i.space},{label:"Guión",value:i.dash},{label:"Guión bajo",value:i.underscore},{label:"Letras y números",value:i.lettersAndNumbers}],selectedOptionStyle:"check"},formControlProps:{isDisabled:d||c,width:"auto",maxWidth:200,mb:4},formControlInnerProps:{label:"Separador de grupo"},control:p}),t.jsx(R,{value:"1",mb:2,children:"Lista personalizada"}),t.jsxs(x,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[t.jsx(l,{children:t.jsx(q,{fieldProps:{name:"list",id:"list",rows:20,fontSize:"sm"},formControlProps:{isDisabled:d||!c},control:p})}),t.jsx(l,{children:t.jsx(I,{fontSize:"sm",children:a.description})})]})]})})}),t.jsx(j,{children:t.jsx(y,{isLoading:d,hideCancelButton:!0})})]})})};var ht=(r=>(r[r.edit=0]="edit",r[r.print=1]="print",r))(ht||{});const St={apiGetAll:ft,apiPost:_t,title:Q,description:t.jsxs(t.Fragment,{children:["Ingrese en la lista los códigos de artículo en el órden en que desea que aparezcan durante la edición de un pedido o borrador.",t.jsx("br",{}),t.jsx("br",{}),"Cualquier línea que ingrese, que no contenga ningún código de artículo, será considerada como título de grupo."]})},Tt={apiGetAll:gt,apiPost:jt,title:tt,description:t.jsxs(t.Fragment,{children:["Los pedidos y borradores se guardarán ordenando los artículos según esta lista.",t.jsx("br",{}),t.jsx("br",{}),"Además a cada ítem puede asignarle parámetros adicionales, como la cantidad de unidades por bulto.",t.jsx("br",{}),t.jsx("br",{}),'Por ejemplo, la siguente línea indica el artículo "01 35", y además define que cada bulto posee 12 unidades:',t.jsx("br",{}),t.jsx("br",{}),t.jsx("b",{children:"01 35; b=12"})]})},Mt=r=>{const e=B(),{type:a}=r,o=a==0?St:Tt;return t.jsxs(t.Fragment,{children:[t.jsx(st,{title:o.title,returnButton:{buttonProps:{onClick:()=>{e(_)}}}}),t.jsx(At,{type:a,options:o})]})},At=({options:r,type:e})=>{const{state:a,retry:o}=r.apiGetAll();return a.map({loading:s=>t.jsx(it,{options:r}),error:({error:s})=>t.jsx(Z,{error:s,retry:o,cancelAndNavigateTo:_}),success:s=>e==0?t.jsx(bt,{stateData:s.data,options:r}):t.jsx(ct,{stateData:s.data,options:r})})};export{Mt as P,ht as a};
