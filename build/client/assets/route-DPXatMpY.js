import{r as j,j as s,u as P}from"./emotion-element-43c6fea0.browser.esm-Bukkp3pI.js";import{_ as g,R,S as A,T as c,Q as b}from"./auth_context-D8ug2Qcd.js";import{a as V,C as E}from"./app-B420985G.js";import{S as I}from"./SettingsFormHeading-5SiLHHxE.js";import{a as y,o as F}from"./yup-BdZyDz3M.js";import{u as O,a as q}from"./app_resources-CEgZe0CK.js";import{A as v}from"./refresh_all-zNiOAdg0.js";import{C as l}from"./CommonCard-C2byJLAu.js";import{F as D}from"./FormErrors-BaCwbtS0.js";import{d as N,V as G,P as m}from"./PasswordWithStatus-DKSTs8vM.js";import{S as T}from"./SettingsFormButtons-CthONgBp.js";import{y as B}from"./utils-DihYaFf6.js";import{c as H,a as p,b as W}from"./index.esm-DLycO5Xl.js";import{G as L,a as u}from"./chunk-ZPFGWTBB-qFhw8OhE.js";import{C as $}from"./chunk-5MKCW436-B32KkSB4.js";import"./chunk-KRPLQIP4-Cm2LXMK6.js";import"./chunk-BL2ZZSHG-BUdH9WQK.js";import"./chunk-7OLJDQMT-W4l9hI3h.js";import"./chunk-6QYXN73V-BQTiQyuX.js";import"./chunk-56K2BSAJ-8vSmiqh4.js";import"./chunk-3Y4YXCR2-K1dpGGRN.js";import"./chunk-QURMB2UJ-CfPn0lni.js";import"./chunk-3KCBMPN5-C6G4MaXF.js";import"./chunk-ZHMYA64R-D24w8AgT.js";import"./chunk-YQO7BFFX-CrbUtirh.js";import"./chunk-MFVQSVQB-BSFcmmoO.js";import"./chunk-46CXQZ4E-CsbUyZmS.js";import"./ControlledInput-BWCaGqUR.js";import"./chunk-6CVSDS6C-ClQyf_Ch.js";import"./chunk-2ZHRCML3-DqPZ_H3Z.js";import"./chunk-Z6RXEUPO-I6sIG1fJ.js";const U=()=>{const[r,o]=j.useState(null);return{yupValidationSchema:H({old_password:p().required("Ingrese su contaseña actual"),new_password:p().required("Ingrese su nueva contraseña").test("password","Formato de contraseña no válido",t=>{if(t!=""&&t!=null){let a=N(t);return g.isEqual(r,a)||o(a),B(G,t)}return!0}),new_password_repeat:p().required("Repita su nueva contraseña").oneOf([W("new_password")],"Las contraseñas deben coincidir")}).required(),passwordStatus:r}},k=()=>{const r=O(),o=q(),{yupValidationSchema:d,passwordStatus:t}=U(),{handleSubmit:a,control:n,reset:M,setError:w,formState:{errors:f,isSubmitting:_,isSubmitSuccessful:S}}=y({defaultValues:{old_password:"",new_password:"",new_password_repeat:""},resolver:F(d)}),e=S||_,x=async h=>{const{new_password_repeat:Q,...C}=h;(await R(C,r)).map({success:i=>{o({title:A,status:"success"}),r.authDispatch(new v(i.data.user)),r.navigate(c)},error:i=>{o({title:b,status:"error"}),w("root",{message:i.info.error_description})}})};return s.jsx("form",{noValidate:!0,onSubmit:a(x),children:s.jsxs(V,{children:[s.jsx(D,{errors:f}),s.jsx(l,{children:s.jsxs(L,{templateColumns:"1fr",alignItems:"start",gap:4,children:[s.jsx(u,{children:s.jsx(m,{fieldProps:{name:"old_password",id:"old_password"},formControlInnerProps:{label:"Contraseña Actual"},disableForm:e,control:n})}),s.jsx(u,{children:s.jsx(m,{fieldProps:{name:"new_password",id:"new_password"},formControlInnerProps:{label:"Nueva contraseña"},passwordStatus:t,disableForm:e,control:n})}),s.jsx(u,{children:s.jsx(m,{fieldProps:{name:"new_password_repeat",id:"new_password_repeat"},formControlInnerProps:{label:"Confirmar nueva contraseña"},disableForm:e,control:n})})]})}),s.jsx(l,{children:s.jsx(T,{isLoading:e,hideCancelButton:!0})})]})})};function Vs(){const r=P();return s.jsxs($,{maxW:"2xl",sx:{my:4},children:[s.jsx(I,{title:E,returnButton:{buttonProps:{onClick:()=>{r(c)}}}}),s.jsx(k,{})]})}export{Vs as default};
