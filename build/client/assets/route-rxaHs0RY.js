import{j as t,u as E,a as C}from"./emotion-element-43c6fea0.browser.esm-CqNy1Myq.js";import{a0 as a,O as p,U as l,Y as R}from"./auth_context-BPNKm5C_.js";import{P as D,s as O,L as U,I as y,B as N}from"./app-CX69rDqm.js";import{u as x}from"./useDXTApiFetch-DJJQmcPU.js";import{C as F}from"./CommonErrors-ANn-F17-.js";import{S as G}from"./SettingsFormHeading-DFLKZnIX.js";import{A as q}from"./ApiErrors-DQxu8cuC.js";import{a as v,F as m}from"./FormSkeletons-FVNY-1Wx.js";import{B as T}from"./chunk-PULVB27S-CjXp21rs.js";import{G as _,a as i}from"./chunk-ZPFGWTBB-BGOvs2SN.js";import{T as f}from"./chunk-2OOHT3W5-U8fop6km.js";import{c as z,a as B,d as X,o as w}from"./index.esm-DRWPArKk.js";import{u as k}from"./app_resources-BncH8wDZ.js";import{C as u}from"./CommonCard-C8mdcxSI.js";import{C as V}from"./ControlledTextarea-43CRl7fs.js";import{F as $}from"./FormErrors-CgyDTrkn.js";import{S as H}from"./SettingsFormButtons-Dr71bDKY.js";import{A as M}from"./index-C_tv48Gv.js";import{u as Y}from"./chunk-6RSEZNRH-wKYG4vTw.js";import"./CloseIcon-DhOj6wIL.js";import"./chunk-KRPLQIP4-BuYv1GpP.js";import"./ResponsiveIconButton-DTsMLJ6O.js";import"./chunk-VMD3UMGK-7pfkPLnR.js";import"./chunk-6QYXN73V-QyLCLJ50.js";import"./chunk-BL2ZZSHG-BVnSQMvm.js";import"./chunk-7OLJDQMT-Dt4RFKr6.js";import"./components-F5Cv7EYO.js";import"./chunk-3ASUQ6PA-hNB_nry7.js";import"./chunk-YQO7BFFX-CkL1T7LL.js";import"./chunk-MFVQSVQB-DR_sqUop.js";import"./chunk-56K2BSAJ-GUqegmVg.js";import"./chunk-H46NUPBZ-CEXsk7m2.js";import"./chunk-3KCBMPN5-BlEVF58j.js";import"./chunk-46CXQZ4E-B49QqCoR.js";import"./chunk-3Y4YXCR2-VQX1029H.js";import"./index-CAKzuJDV.js";import"./chunk-QURMB2UJ-CVr_6ThV.js";const Z=a("/dxt/articulo/print_list","GET"),K=a("/dxt/articulo/print_list","POST"),J=a("/dxt/articulo/edit_list","GET"),Q=a("/dxt/articulo/edit_list","POST");a("/dxt/articulo/print_list/ids","GET");const W=async(r,s)=>await p({...K,data:r,silent:!0},s),tt=async(r,s)=>await p({...Q,data:r,silent:!0},s);function st(){return x({...J,silent:!0})}function rt(){return x({...Z,silent:!0})}const et={edit:{api:{getAll:st,post:tt},title:D,description:t.jsxs(t.Fragment,{children:["Ingrese en la lista los códigos de artículo en el órden en que desea que aparezcan durante la edición de un pedido o borrador.",t.jsx("br",{}),t.jsx("br",{}),"Cualquier línea que ingrese, que no contenga ningún código de artículo, será considerada como título de grupo."]})},print:{api:{getAll:rt,post:W},title:O,description:t.jsxs(t.Fragment,{children:["Los pedidos y borradores se guardarán ordenando los artículos según esta lista.",t.jsx("br",{}),t.jsx("br",{}),"Además a cada ítem puede asignarle parámetros adicionales, como la cantidad de unidades por bulto.",t.jsx("br",{}),t.jsx("br",{}),'Por ejemplo, la siguente línea indica el artículo "01 35", y además define que cada bulto posee 12 unidades:',t.jsx("br",{}),t.jsx("br",{}),t.jsx("b",{children:"01 35; b=12"})]})}},ot=r=>{const{typeSettings:s}=r;return t.jsx(T,{width:"full",sx:{mt:8,mb:4},children:t.jsxs(_,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[t.jsx(i,{children:t.jsx(v,{height:"380px"})}),t.jsx(i,{children:t.jsx(f,{fontSize:"sm",children:s.description})}),t.jsx(i,{children:t.jsx(m,{})}),t.jsx(i,{children:t.jsx(m,{})})]})})},it=z({list:B().default("").test("avoid-ARTICLE_GROUP_NO_NAME",`Evite utilizar ${M}`,function(r){return!/(^|[^a-zA-Z0-9])_([^a-zA-Z0-9]|$)/.test(r)})}).required(),at=r=>{const{stateData:s,typeSettings:e}=r,n=k(),o=Y(),{handleSubmit:j,control:g,reset:lt,setError:A,formState:{errors:S,isSubmitting:I,isSubmitSuccessful:P}}=X({defaultValues:{list:s?.join(`\r
`)||""},resolver:w(it)}),c=P||I,L=async b=>{const h={data:b.list.split(`
`)};(await e.api.post(h,n)).map({success:d=>{o({title:U,status:"success"}),n.navigate(l)},error:d=>{o({title:d.errorInfoOrNull()?.error_description??R,status:"error"}),A("root",{message:d.info.error_description})}})};return t.jsx("form",{noValidate:!0,onSubmit:j(L),children:t.jsxs(T,{children:[t.jsx($,{errors:S}),t.jsx(u,{children:t.jsxs(_,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[t.jsx(i,{children:t.jsx(V,{fieldProps:{name:"list",id:"list",rows:20,fontSize:"sm"},formControlProps:{isDisabled:c},control:g})}),t.jsx(i,{children:t.jsx(f,{fontSize:"sm",children:e.description})})]})}),t.jsx(u,{children:t.jsx(H,{isLoading:c,hideCancelButton:!0})})]})})},nt=r=>{const{typeSettings:s}=r,{state:e,retry:n}=s.api.getAll();return e.map({loading:o=>t.jsx(ot,{typeSettings:s}),error:({error:o})=>t.jsx(q,{error:o,retry:n,cancelAndNavigateTo:l}),success:o=>t.jsx(at,{stateData:o.data,typeSettings:s})})};function Mt(){const r=E(),{type:s}=C(),e=et[s];return s!=null&&e!=null?t.jsxs(t.Fragment,{children:[t.jsx(G,{title:e.title,returnButton:{buttonProps:{onClick:()=>{r(l)}}}}),t.jsx(nt,{typeSettings:e})]}):t.jsx(F,{error:y,buttonProps:{label:N,colorScheme:"gray",onClick:()=>{r(l)}}})}export{Mt as default};
