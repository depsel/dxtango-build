import{r as R,j as e,a as B}from"./emotion-element-43c6fea0.browser.esm-V7CwUVk-.js";import{A as H,s as q}from"./index-C9yDa_R-.js";import{_ as X,S as $,a3 as F,X as W}from"./auth_context-BBDV2-qW.js";import{S as J}from"./SettingsFormHeading-BZPNDeWv.js";import{a as K,b as Q}from"./app_resources-CxShxcx8.js";import{u as Y}from"./useTangoList-Bq-SEz1p.js";import{c as Z,a as ee,d as re,o as oe}from"./index.esm-SP9Jm6Nz.js";import{F as w,a as I,b as D}from"./useDXTApiFetch-cUHsby58.js";import{c as se,D as ae,C as te,a as i}from"./validation-B8S6Yb_c.js";import{B as ie,U as ne}from"./app-BMvraJRd.js";import{C as b}from"./CommonCard-CrzQbbIu.js";import{C as P}from"./ControlledInput-Bw-P79we.js";import{C as E}from"./ControlledSelect-Bgaw0xLO.js";import{F as le}from"./FormErrors-5HYi3DVI.js";import{d as de,V as pe,P as me}from"./vo_dxt_password-W93vgryN.js";import{I as T}from"./InlineError-DRfvy1Jn.js";import{S as ce}from"./SettingsFormButtons-BuGsXUqX.js";import{y as ue}from"./utils-DihYaFf6.js";import{G as v,a as r}from"./chunk-ZPFGWTBB-BQOfC-td.js";import{H as _}from"./chunk-7OLJDQMT-3EhHOSPR.js";import{D as x}from"./chunk-W7WUSNWJ-BEqd18B9.js";import{H as n}from"./chunk-3ASUQ6PA-CvzJqsz3.js";import"./AccountCancelIcon-BsdBUfF1.js";import"./chunk-KRPLQIP4-NJec_PE4.js";import"./chunk-6QYXN73V-BKD6YrO0.js";import"./chunk-3Y4YXCR2-DS9dcu0f.js";import"./chunk-QURMB2UJ-8Wtwm6sR.js";import"./chunk-3KCBMPN5-70uOg14b.js";import"./chunk-56K2BSAJ-ByH33m4W.js";import"./chunk-7D6N5TE5-CYpHZTLA.js";import"./chunk-YQO7BFFX-B4KLri48.js";import"./chunk-MFVQSVQB-BInMUJ5Q.js";import"./chunk-6CVSDS6C-EjyqZFPp.js";import"./index.esm-DYgtBHkz.js";import"./select-BgjIqqU7.js";import"./chunk-HB6KBUMZ-jk1Ar7Nh.js";import"./chunk-46CXQZ4E-Cu23NgCw.js";import"./chunk-2ZHRCML3-DK3i-inn.js";import"./chunk-Z6RXEUPO-DSTG9QiY.js";const fe=()=>{const[t,a]=R.useState(null),p=Z({password:ee().required("Ingrese una contraseña").test("password","Formato de contraseña no válido",l=>{if(l!=""&&l!=null){let m=de(l);return X.isEqual(t,m)||a(m),ue(pe,l)}return!0})}).required();return{yupValidationSchema:se.concat(p),passwordStatus:t}},_e=t=>{var S,C;const{typeSettings:a}=t,p=K(),h=Q(),{yupValidationSchema:l,passwordStatus:m}=fe(),{state:c,result:y}=Y({endpoint:H,fieldsMap:{label:"name",value:"id"}}),{state:u,result:A}=a.api.getRelation(),{handleSubmit:V,control:s,setError:O,resetField:L,watch:N,formState:{errors:G,isSubmitting:U,isSubmitSuccessful:M}}=re({defaultValues:{username:"",password:"",email:"",tango_id:0,perfil_facturacion_id:0,habilitado_en_dxt:!0,puede_crear_pedido:!0,puede_editar_pedido:!0,ver_pedidos_cumplidos:!0,ver_sin_precio:!1,mostrar_mensaje_de_advertencia:!1,puede_anular_pedido:!1,borrar_pedido_al_anular:!1,aprobar_pedido_al_crear:!1,dia_de_entrega:ae},resolver:oe(l)}),f=N("puede_anular_pedido");R.useEffect(()=>{f===!1&&L("borrar_pedido_al_anular",{defaultValue:!1})},[f]);const o=M||U,k=async j=>{const{...d}=j;d.email===""&&delete d.email;const z=d;(await a.api.post(z,p)).map({success:g=>{h({title:ne,status:"success"}),p.navigate(F)},error:g=>{h({title:W,status:"error"}),O("root",{message:g.info.error_description})}})};return e.jsx("form",{noValidate:!0,onSubmit:V(k),children:e.jsxs(ie,{children:[e.jsx(le,{errors:G}),e.jsx(b,{children:e.jsxs(v,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(r,{colSpan:{md:2},children:e.jsx(_,{size:"sm",textTransform:"uppercase",children:"Información del Cliente"})}),e.jsxs(r,{colSpan:{md:2},children:[e.jsx(E,{fieldProps:{name:"tango_id",placeholder:(S=a.tangoRelatedFields)==null?void 0:S.placeholder,options:A,noOptionsMessage(j){var d;return(d=a.tangoRelatedFields)==null?void 0:d.empty},isSearchable:!0,selectedOptionStyle:"check",isLoading:u instanceof w,virtualized:!0},formControlProps:{isDisabled:o||!(u instanceof I)},formControlInnerProps:{label:(C=a.tangoRelatedFields)==null?void 0:C.label},control:s}),u instanceof D&&e.jsx(T,{error:u.errorOrNull().error})]}),e.jsx(r,{children:e.jsx(P,{fieldProps:{name:"username",id:"username",type:"text"},formControlProps:{isDisabled:o},formControlInnerProps:{label:"Nombre de Usuario"},control:s})}),e.jsx(r,{children:e.jsx(me,{fieldProps:{name:"password",id:"password"},formControlInnerProps:{label:"Contraseña"},passwordStatus:m,disableForm:o,control:s})}),e.jsx(r,{children:e.jsx(P,{fieldProps:{name:"email",id:"email",type:"text",inputMode:"email"},formControlProps:{isDisabled:o},formControlInnerProps:{label:"Correo electrónico"},control:s})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(x,{})}),e.jsxs(r,{colSpan:{md:2},children:[e.jsx(E,{fieldProps:{name:"perfil_facturacion_id",placeholder:"Seleccione un perfil",options:y,noOptionsMessage(j){return"No hay perfiles disponibles"},isLoading:c instanceof w,selectedOptionStyle:"check"},formControlProps:{isDisabled:o||!(c instanceof I)},formControlInnerProps:{label:"Perfil de facturación"},control:s}),c instanceof D&&e.jsx(T,{error:c.errorOrNull().error})]}),e.jsx(r,{colSpan:{md:2},children:e.jsx(x,{})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(_,{size:"sm",textTransform:"uppercase",children:"Estado"})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(te,{fieldProps:{name:"habilitado_en_dxt",options:[{value:!0,label:"Establecido en Tango"},{value:!1,label:"Deshabilitado"}]},formControlProps:{isDisabled:o},radioProps:{size:{base:"sm",sm:"md"}},control:s})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(x,{})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(_,{size:"sm",textTransform:"uppercase",children:"Comunicación"})}),e.jsx(r,{children:e.jsx(i,{fieldProps:{name:"mostrar_mensaje_de_advertencia",id:"mostrar_mensaje_de_advertencia"},formControlProps:{width:"auto",isDisabled:o},formControlInnerProps:{label:"Mostrar mensaje de advertencia"},control:s})})]})}),e.jsx(b,{children:e.jsxs(v,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(r,{colSpan:{md:2},children:e.jsx(_,{size:"sm",textTransform:"uppercase",children:"Pedidos"})}),e.jsx(r,{colSpan:{md:2},children:e.jsxs($,{spacing:4,direction:{base:"column"},children:[e.jsx(n,{spacing:4,children:e.jsx(i,{fieldProps:{name:"puede_crear_pedido",id:"puede_crear_pedido"},formControlProps:{width:"auto",isDisabled:o},formControlInnerProps:{label:"Puede crear pedidos"},control:s})}),e.jsx(n,{spacing:4,children:e.jsx(i,{fieldProps:{name:"puede_editar_pedido",id:"puede_editar_pedido"},formControlProps:{width:"auto",isDisabled:o},formControlInnerProps:{label:"Puede editar pedidos"},control:s})}),e.jsx(n,{spacing:4,children:e.jsx(i,{fieldProps:{name:"puede_anular_pedido",id:"puede_anular_pedido"},formControlProps:{width:"auto",isDisabled:o},formControlInnerProps:{label:"Puede anular pedidos"},control:s})}),e.jsx(n,{spacing:4,children:e.jsx(i,{fieldProps:{name:"borrar_pedido_al_anular",id:"borrar_pedido_al_anular"},formControlProps:{width:"auto",isDisabled:o},formControlInnerProps:{label:"Borrar pedido al anular"},control:s,watch:{isDisabled:f===!1,...f===!1&&{isChecked:!1}}})}),e.jsx(n,{spacing:4,children:e.jsx(i,{fieldProps:{name:"aprobar_pedido_al_crear",id:"aprobar_pedido_al_crear"},formControlProps:{width:"auto",isDisabled:o},formControlInnerProps:{label:"Los pedidos se aprueban al crearlos"},control:s})}),e.jsx(n,{spacing:4,children:e.jsx(i,{fieldProps:{name:"ver_pedidos_cumplidos",id:"ver_pedidos_cumplidos"},formControlProps:{width:"auto",isDisabled:o},formControlInnerProps:{label:"Puede ver los pedidos cumplidos"},control:s})}),e.jsx(n,{spacing:4,children:e.jsx(i,{fieldProps:{name:"ver_sin_precio",id:"ver_sin_precio"},formControlProps:{width:"auto",isDisabled:o},formControlInnerProps:{label:"Puede ver artículos sin precios"},control:s})})]})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(x,{})}),e.jsx(r,{children:e.jsx(P,{fieldProps:{name:"dia_de_entrega",id:"dia_de_entrega",type:"number",inputMode:"tel"},formControlProps:{isDisabled:o},formControlInnerProps:{label:"Tiempo de entrega de pedidos",helperText:"Expresado en días"},control:s})}),e.jsx(r,{})]})}),e.jsx(b,{children:e.jsx(ce,{buttonActionText:"Guardar",isLoading:o,buttonCancelUrl:a.cancelButtonNavigateTo})})]})})},xe=t=>{const{typeSettings:a}=t;return e.jsx(_e,{typeSettings:a})};function sr(){const t=q.customers,a=B();return e.jsxs(e.Fragment,{children:[e.jsx(J,{title:t.titles.create,returnButton:{buttonProps:{onClick:()=>{a(F)}}}}),e.jsx(xe,{typeSettings:t})]})}export{sr as default};
