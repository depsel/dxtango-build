import{j as e,u as D}from"./emotion-element-43c6fea0.browser.esm-Bukkp3pI.js";import{Q as E,U as l,R as y}from"./auth_context-By8qlCOz.js";import{a as j,T as O,r as A}from"./app-ChKZjo6p.js";import{S as q}from"./SettingsFormHeading-DRaop4b3.js";import{D as c,a as f,V as R,s as B,A as F}from"./index-C6Hb1dK-.js";import{u as M}from"./useDXTApiFetch-DMZ_pwG5.js";import{A as U}from"./ApiErrors-CbWmNTke.js";import{F as n}from"./FormSkeletons-C5bAoHqQ.js";import{G as _,a as s}from"./chunk-ZPFGWTBB-C6BSXP9K.js";import{a as G,o as w}from"./yup-DmufeRdH.js";import{a as L,b as V}from"./app_resources-0MHmsA5u.js";import{C as x}from"./CommonCard-B6Zs7VdS.js";import{C as d}from"./ControlledInput-Bfe1Y7Kq.js";import{F as $}from"./FormErrors-DK3bqFxa.js";import{S as v}from"./SettingsFormButtons-Dtw3fGC3.js";import{y as b}from"./utils-DihYaFf6.js";import{c as z,a as m,d as g}from"./index.esm-DLycO5Xl.js";import"./chunk-KRPLQIP4-BIcN844u.js";import"./chunk-BL2ZZSHG-CllUrry9.js";import"./chunk-7OLJDQMT-DeTsz2JD.js";import"./chunk-6QYXN73V-e7cXtMTs.js";import"./chunk-3ASUQ6PA-CMDtM4Gu.js";import"./chunk-ZHMYA64R-DxFJ4KrV.js";import"./chunk-2OOHT3W5-BaTWmMuR.js";import"./chunk-56K2BSAJ-HKDUOZgn.js";import"./chunk-3Y4YXCR2-BRX7qSte.js";import"./chunk-QURMB2UJ-DZ-0JI-4.js";import"./chunk-3KCBMPN5-BSyM0bpq.js";import"./chunk-YQO7BFFX--iiPSc49.js";import"./chunk-MFVQSVQB-DALUCuvz.js";import"./chunk-6CVSDS6C-DbHhw9T-.js";import"./chunk-46CXQZ4E-3v06V3Zr.js";const H=()=>e.jsx(j,{width:"full",sx:{mt:8,mb:4},children:e.jsxs(_,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"center",gap:4,children:[e.jsx(s,{children:e.jsx(n,{})}),e.jsx(s,{children:e.jsx(n,{})}),e.jsx(s,{children:e.jsx(n,{})}),e.jsx(s,{children:e.jsx(n,{})}),e.jsx(s,{children:e.jsx(n,{})}),e.jsx(s,{children:e.jsx(n,{})}),e.jsx(s,{children:e.jsx(n,{})}),e.jsx(s,{children:e.jsx(n,{})})]})});function Q(r){if(typeof r!="string"||r.length<1)return!1;const t=r[0];return t>="0"&&t<="9"?!1:/^[A-Za-z0-9_]*$/.test(r)}function k(r){return Q(r)?typeof r=="string"&&r[0]!=="_":!1}class X extends E{validate(t){if(typeof t=="string"){const o=t.trim();if(k(t))return o}this.throwError(t)}}const Z=z({db_host:m().required("Ingrese el host de la base de datos"),db_port:g().required("Ingrese un puerto").typeError("Ingrese un número de puerto válido").test("is-port","Ingrese un puerto válido",r=>b(R,r)),db_user:m().required("Ingrese el usuario de la base de datos"),db_password:m().required("Ingrese la contraseña de la base de datos"),tango_dictionary:m().required("Ingrese el diccionario base de Tango").test("mssql-db-name","Ingrese un nombre de Diccionario base válido",r=>b(X,r)),db_connection_timeout_seconds:g().min(c,`El tiempo de espera debe ser mayor a ${c} segundos`).max(f,`El tiempo de espera debe ser menor a ${f} segundos`).required("Ingrese el tiempo de espera de la conexión a la base de datos").typeError("Ingrese el tiempo de espera de la conexión a la base de datos")}).required(),J=r=>{const{stateData:t}=r,o=L(),p=V(),{handleSubmit:h,control:a,reset:W,setError:C,formState:{errors:S,isSubmitting:I,isSubmitSuccessful:T}}=G({defaultValues:t,resolver:w(Z)}),i=T||I,N=async P=>{(await B(P,o)).map({success:u=>{p({title:O,status:"success"}),o.navigate(l)},error:u=>{p({title:y,status:"error"}),C("root",{message:u.info.error_description})}})};return e.jsx("form",{noValidate:!0,onSubmit:h(N),children:e.jsxs(j,{children:[e.jsx($,{errors:S}),e.jsx(x,{children:e.jsxs(_,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(s,{children:e.jsx(d,{fieldProps:{name:"db_host",id:"db_host",type:"text"},formControlProps:{isDisabled:i},formControlInnerProps:{label:"Host"},control:a})}),e.jsx(s,{children:e.jsx(d,{fieldProps:{name:"db_port",id:"db_port",type:"number",inputMode:"tel",htmlSize:5,width:"auto"},formControlProps:{isDisabled:i},formControlInnerProps:{label:"Puerto"},control:a})}),e.jsx(s,{children:e.jsx(d,{fieldProps:{name:"db_user",id:"db_user",type:"text"},formControlProps:{isDisabled:i},formControlInnerProps:{label:"Usuario SQL"},control:a})}),e.jsx(s,{children:e.jsx(d,{fieldProps:{name:"db_password",id:"db_password",type:"password"},formControlProps:{isDisabled:i},formControlInnerProps:{label:"Contraseña SQL"},control:a})}),e.jsx(s,{children:e.jsx(d,{fieldProps:{name:"tango_dictionary",id:"tango_dictionary",type:"text"},formControlProps:{isDisabled:i},formControlInnerProps:{label:"Diccionario base"},control:a})}),e.jsx(s,{children:e.jsx(d,{fieldProps:{name:"db_connection_timeout_seconds",id:"db_connection_timeout_seconds",type:"number",inputMode:"tel",htmlSize:5,maxLength:5,width:"auto"},formControlProps:{isDisabled:i},formControlInnerProps:{label:"Tiempo de espera (segundos)"},control:a})})]})}),e.jsx(x,{children:e.jsx(v,{isLoading:i,hideCancelButton:!0})})]})})},K=()=>{const{state:r,retry:t}=M({...F,silent:!0});return r.map({loading:o=>e.jsx(H,{}),error:({error:o})=>e.jsx(U,{error:o,retry:t,cancelAndNavigateTo:l}),success:o=>e.jsx(J,{stateData:o.data})})};function Re(){const r=D();return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:A,returnButton:{buttonProps:{onClick:()=>{r(l)}}}}),e.jsx(K,{})]})}export{Re as default};
