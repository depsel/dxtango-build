const __vite__fileDeps=["assets/PrintModal.client-C3BI6nNz.js","assets/emotion-element-43c6fea0.browser.esm-V7CwUVk-.js","assets/auth_context-BBDV2-qW.js","assets/index.esm-DYgtBHkz.js","assets/select-BgjIqqU7.js","assets/chunk-56K2BSAJ-ByH33m4W.js","assets/app-BMvraJRd.js","assets/app_resources-CxShxcx8.js","assets/chunk-3Y4YXCR2-DS9dcu0f.js","assets/chunk-QURMB2UJ-8Wtwm6sR.js","assets/chunk-3KCBMPN5-70uOg14b.js","assets/chunk-6QYXN73V-BKD6YrO0.js","assets/chunk-W7WUSNWJ-BEqd18B9.js","assets/chunk-HB6KBUMZ-jk1Ar7Nh.js","assets/useDXTApiFetch-cUHsby58.js","assets/paths-BSNIG4KB.js","assets/ApiErrors-P5QuqGMt.js","assets/chunk-3ASUQ6PA-CvzJqsz3.js","assets/chunk-2OOHT3W5-DslbJMnr.js","assets/chunk-7OLJDQMT-3EhHOSPR.js","assets/chunk-KRPLQIP4-NJec_PE4.js","assets/pedidos-BF2fCqUh.js","assets/FormSkeletons-xJlZdIll.js","assets/chunk-GOJLRND4-C6AoJZLh.js","assets/chunk-ZPFGWTBB-BQOfC-td.js","assets/SearchField-BB5KABJn.js","assets/chunk-2ZHRCML3-DK3i-inn.js","assets/chunk-6CVSDS6C-EjyqZFPp.js","assets/AccountCancelIcon-BsdBUfF1.js","assets/TextWordBreak-BjAGweP2.js","assets/chunk-46CXQZ4E-Cu23NgCw.js","assets/chunk-NTCQBYKE-BO7YPHqM.js","assets/vo_user_name-B4S4VRzE.js","assets/chunk-Z6RXEUPO-DSTG9QiY.js","assets/chunk-H43S3DLB-BJpOnnoX.js","assets/chunk-CWVAJCXJ-BPBC_Cg6.js","assets/chunk-7D6N5TE5-CYpHZTLA.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{j as e,r as D,g as fe}from"./emotion-element-43c6fea0.browser.esm-V7CwUVk-.js";import{u as ke}from"./useDXTApiFetch-cUHsby58.js";import{e as k,P as ht,a as ut,b as mt,c as ft,d as _t,f as pt,g as gt,h as xt,i as Ot,j as vt,k as Et,l as jt,m as Dt,n as bt,o as At,T as Ee,p as Rt,q as je,r as Tt,s as Ct,t as It,u as Pt,v as wt,w as St,x as yt,y as zt,z as Lt,A as Nt,B as Ft,C as kt,D as Ut,E as Mt,F as Bt,G as Ht}from"./pedidos-BF2fCqUh.js";import{P as _e,b2 as Ue,b3 as $,ag as Vt,f as L,u as $t,o as Me,a as H,b as Be,g as Wt,h as Gt,I as pe,aN as He,aP as Ve,aO as $e,aQ as We,b4 as Ge,aR as Xe,e as Xt,_ as qe,aY as Ye,b5 as qt,b6 as Yt,d as Ze,b7 as Zt,b8 as Kt,b9 as Qt,ba as Jt,bb as es,aA as b,bc as Q,bd as ge,be as ts,bf as ss,bg as rs,V as ae,bh as De,bi as w,bj as W,D as ns,aw as is,l as as,bk as os,bl as ls,ar as cs,bm as ds,bn as hs,bo as be,aX as us,X as ms,ay as fs,aB as _s}from"./auth_context-BBDV2-qW.js";import{A as Ke}from"./ApiErrors-P5QuqGMt.js";import{F as z,a as F}from"./FormSkeletons-xJlZdIll.js";import{B as I,E as ps,F as gs,O as xs,G as Os,H as vs}from"./app-BMvraJRd.js";import{G as B,a as p}from"./chunk-ZPFGWTBB-BQOfC-td.js";import{a as Qe,S as Je,u as ce}from"./SearchField-BB5KABJn.js";import{a as et,R as Ae,b as Es}from"./app_resources-CxShxcx8.js";import{i as js,h as Ds}from"./AccountCancelIcon-BsdBUfF1.js";import{A as bs,T as tt,a as As,b as q,c as Rs,d as st,e as xe,f as G,D as Ts}from"./TextWordBreak-BjAGweP2.js";import{F as Cs}from"./index.esm-DYgtBHkz.js";import{a as Is,L as Ps,b as Re}from"./chunk-46CXQZ4E-Cu23NgCw.js";import{V as rt}from"./chunk-NTCQBYKE-BO7YPHqM.js";import{S as Te}from"./chunk-GOJLRND4-C6AoJZLh.js";import{F as Ce}from"./chunk-KRPLQIP4-NJec_PE4.js";import{H as Ie}from"./chunk-3ASUQ6PA-CvzJqsz3.js";import{V as ws}from"./vo_user_name-B4S4VRzE.js";import{B as Ss}from"./chunk-Z6RXEUPO-DSTG9QiY.js";import{f as ys}from"./chunk-HB6KBUMZ-jk1Ar7Nh.js";import{M as zs,a as Ls,b as M,c as Ns}from"./chunk-H43S3DLB-BJpOnnoX.js";import{I as Fs}from"./chunk-6QYXN73V-BKD6YrO0.js";import{A as J}from"./chunk-3KCBMPN5-70uOg14b.js";import{A as ee,a as te}from"./chunk-QURMB2UJ-8Wtwm6sR.js";import{H as A}from"./chunk-7OLJDQMT-3EhHOSPR.js";import{T as X}from"./chunk-2OOHT3W5-DslbJMnr.js";import{C as ks}from"./chunk-CWVAJCXJ-BPBC_Cg6.js";class Us extends _e{throwInvalidAddressError(t){this.throwError(t,"Invalid email address")}validate(t){if(typeof t=="string"){const r=t.trim().toLowerCase();if(Ue.isEmail(r,{domain_specific_validation:!0}))return r}this.throwError(t)}}class Oe extends _e{constructor(t){$.isBuffer(t)&&(t=t.toString("hex")),super(t)}validate(t){let r;if($.isBuffer(t)&&(r=t.toString("hex")),typeof t=="string"&&(r=t.trim().toLowerCase()),typeof r=="string"&&Ue.isMD5(r))return r;this.throwError(t)}toBuffer(){return $.from(this.value,"hex")}static random(){const t=Array(16);for(let r=0;r<t.length;r++)t[r]=Vt(0,255);return new Oe($.from(t))}}var nt=L(function(t,r){const n=$t("Link",t),{className:i,isExternal:o,...l}=Me(t);return e.jsx(H.a,{target:o?"_blank":void 0,rel:o?"noopener":void 0,ref:r,className:Be("chakra-link",i),...l,__css:n})});nt.displayName="Link";var it=L((s,t)=>{var r;const{overflow:n,overflowX:i,className:o,...l}=s;return e.jsx(H.div,{ref:t,className:Be("chakra-table__container",o),...l,__css:{display:"block",whiteSpace:"nowrap",WebkitOverflowScrolling:"touch",overflowX:(r=n??i)!=null?r:"auto",overflowY:"hidden",maxWidth:"100%"}})}),[Ms,at]=Wt({name:"TagStylesContext",errorMessage:`useTagStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tag />" `}),de=L((s,t)=>{const r=Gt("Tag",s),n=Me(s),i={display:"inline-flex",verticalAlign:"top",alignItems:"center",maxWidth:"100%",...r.container};return e.jsx(Ms,{value:r,children:e.jsx(H.span,{ref:t,...n,__css:i})})});de.displayName="Tag";var he=L((s,t)=>{const r=at();return e.jsx(H.span,{ref:t,noOfLines:1,...s,__css:r.label})});he.displayName="TagLabel";var Bs=L((s,t)=>e.jsx(pe,{ref:t,verticalAlign:"top",marginEnd:"0.5rem",...s}));Bs.displayName="TagLeftIcon";var Hs=L((s,t)=>e.jsx(pe,{ref:t,verticalAlign:"top",marginStart:"0.5rem",...s}));Hs.displayName="TagRightIcon";var ot=s=>e.jsx(pe,{verticalAlign:"inherit",viewBox:"0 0 512 512",...s,children:e.jsx("path",{fill:"currentColor",d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})});ot.displayName="TagCloseIcon";var Vs=L((s,t)=>{const{isDisabled:r,children:n,...i}=s,l={display:"flex",alignItems:"center",justifyContent:"center",outline:"0",...at().closeButton};return e.jsx(H.button,{ref:t,"aria-label":"close",...i,type:"button",disabled:r,__css:l,children:n||e.jsx(ot,{})})});Vs.displayName="TagCloseButton";const $s=()=>e.jsx(I,{width:"full",sx:{mt:8,mb:4},children:e.jsxs(B,{templateColumns:"1fr",alignItems:"center",gap:4,children:[e.jsx(p,{children:e.jsx(z,{})}),e.jsx(p,{children:e.jsx(F,{height:"120px"})}),e.jsx(p,{children:e.jsx(F,{height:"120px"})}),e.jsx(p,{children:e.jsx(F,{height:"120px"})}),e.jsx(p,{children:e.jsx(F,{height:"120px"})}),e.jsx(p,{children:e.jsx(F,{height:"120px"})}),e.jsx(p,{children:e.jsx(F,{height:"120px"})})]})});function Ws(s){return s&&typeof s=="object"&&"default"in s?s.default:s}var Y=Ws(D),Gs=Object.assign||function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},Xs=function(s,t){var r={};for(var n in s)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n]);return r},Pe=function(t){var r=t.color,n=r===void 0?"currentColor":r,i=t.size,o=i===void 0?24:i;t.children;var l=Xs(t,["color","size","children"]),c="mdi-icon "+(l.className||"");return Y.createElement("svg",Gs({},l,{className:c,width:o,height:o,fill:n,viewBox:"0 0 24 24"}),Y.createElement("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}))},qs=Y.memo?Y.memo(Pe):Pe,Ys=qs;const Zs=fe(Ys);function Ks(s){return s&&typeof s=="object"&&"default"in s?s.default:s}var Z=Ks(D),Qs=Object.assign||function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},Js=function(s,t){var r={};for(var n in s)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n]);return r},we=function(t){var r=t.color,n=r===void 0?"currentColor":r,i=t.size,o=i===void 0?24:i;t.children;var l=Js(t,["color","size","children"]),c="mdi-icon "+(l.className||"");return Z.createElement("svg",Qs({},l,{className:c,width:o,height:o,fill:n,viewBox:"0 0 24 24"}),Z.createElement("path",{d:"M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z"}))},er=Z.memo?Z.memo(we):we,tr=er;const sr=fe(tr);let T;typeof window<"u"?T=window:typeof self<"u"?T=self:T=global;let ue=null,me=null;const Se=20,oe=T.clearTimeout,ye=T.setTimeout,le=T.cancelAnimationFrame||T.mozCancelAnimationFrame||T.webkitCancelAnimationFrame,ze=T.requestAnimationFrame||T.mozRequestAnimationFrame||T.webkitRequestAnimationFrame;le==null||ze==null?(ue=oe,me=function(t){return ye(t,Se)}):(ue=function([t,r]){le(t),oe(r)},me=function(t){const r=ze(function(){oe(n),t()}),n=ye(function(){le(r),t()},Se);return[r,n]});function rr(s){let t,r,n,i,o,l,c;const d=typeof document<"u"&&document.attachEvent;if(!d){l=function(m){const h=m.__resizeTriggers__,O=h.firstElementChild,R=h.lastElementChild,C=O.firstElementChild;R.scrollLeft=R.scrollWidth,R.scrollTop=R.scrollHeight,C.style.width=O.offsetWidth+1+"px",C.style.height=O.offsetHeight+1+"px",O.scrollLeft=O.scrollWidth,O.scrollTop=O.scrollHeight},o=function(m){return m.offsetWidth!==m.__resizeLast__.width||m.offsetHeight!==m.__resizeLast__.height},c=function(m){if(m.target.className&&typeof m.target.className.indexOf=="function"&&m.target.className.indexOf("contract-trigger")<0&&m.target.className.indexOf("expand-trigger")<0)return;const h=this;l(this),this.__resizeRAF__&&ue(this.__resizeRAF__),this.__resizeRAF__=me(function(){o(h)&&(h.__resizeLast__.width=h.offsetWidth,h.__resizeLast__.height=h.offsetHeight,h.__resizeListeners__.forEach(function(C){C.call(h,m)}))})};let a=!1,_="";n="animationstart";const f="Webkit Moz O ms".split(" ");let u="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),j="";{const m=document.createElement("fakeelement");if(m.style.animationName!==void 0&&(a=!0),a===!1){for(let h=0;h<f.length;h++)if(m.style[f[h]+"AnimationName"]!==void 0){j=f[h],_="-"+j.toLowerCase()+"-",n=u[h],a=!0;break}}}r="resizeanim",t="@"+_+"keyframes "+r+" { from { opacity: 0; } to { opacity: 0; } } ",i=_+"animation: 1ms "+r+"; "}const x=function(a){if(!a.getElementById("detectElementResize")){const _=(t||"")+".resize-triggers { "+(i||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',f=a.head||a.getElementsByTagName("head")[0],u=a.createElement("style");u.id="detectElementResize",u.type="text/css",s!=null&&u.setAttribute("nonce",s),u.styleSheet?u.styleSheet.cssText=_:u.appendChild(a.createTextNode(_)),f.appendChild(u)}};return{addResizeListener:function(a,_){if(d)a.attachEvent("onresize",_);else{if(!a.__resizeTriggers__){const f=a.ownerDocument,u=T.getComputedStyle(a);u&&u.position==="static"&&(a.style.position="relative"),x(f),a.__resizeLast__={},a.__resizeListeners__=[],(a.__resizeTriggers__=f.createElement("div")).className="resize-triggers";const j=f.createElement("div");j.className="expand-trigger",j.appendChild(f.createElement("div"));const m=f.createElement("div");m.className="contract-trigger",a.__resizeTriggers__.appendChild(j),a.__resizeTriggers__.appendChild(m),a.appendChild(a.__resizeTriggers__),l(a),a.addEventListener("scroll",c,!0),n&&(a.__resizeTriggers__.__animationListener__=function(O){O.animationName===r&&l(a)},a.__resizeTriggers__.addEventListener(n,a.__resizeTriggers__.__animationListener__))}a.__resizeListeners__.push(_)}},removeResizeListener:function(a,_){if(d)a.detachEvent("onresize",_);else if(a.__resizeListeners__.splice(a.__resizeListeners__.indexOf(_),1),!a.__resizeListeners__.length){a.removeEventListener("scroll",c,!0),a.__resizeTriggers__.__animationListener__&&(a.__resizeTriggers__.removeEventListener(n,a.__resizeTriggers__.__animationListener__),a.__resizeTriggers__.__animationListener__=null);try{a.__resizeTriggers__=!a.removeChild(a.__resizeTriggers__)}catch{}}}}}class nr extends D.Component{constructor(...t){super(...t),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;const{disableHeight:r,disableWidth:n,onResize:i}=this.props;if(this._parentNode){const o=window.getComputedStyle(this._parentNode)||{},l=parseFloat(o.paddingLeft||"0"),c=parseFloat(o.paddingRight||"0"),d=parseFloat(o.paddingTop||"0"),x=parseFloat(o.paddingBottom||"0"),g=this._parentNode.getBoundingClientRect(),E=g.height-d-x,a=g.width-l-c,_=this._parentNode.offsetHeight-d-x,f=this._parentNode.offsetWidth-l-c;(!r&&(this.state.height!==_||this.state.scaledHeight!==E)||!n&&(this.state.width!==f||this.state.scaledWidth!==a))&&(this.setState({height:_,width:f,scaledHeight:E,scaledWidth:a}),typeof i=="function"&&i({height:_,scaledHeight:E,scaledWidth:a,width:f}))}},this._setRef=r=>{this._autoSizer=r}}componentDidMount(){const{nonce:t}=this.props,r=this._autoSizer?this._autoSizer.parentNode:null;if(r!=null&&r.ownerDocument&&r.ownerDocument.defaultView&&r instanceof r.ownerDocument.defaultView.HTMLElement){this._parentNode=r;const n=r.ownerDocument.defaultView.ResizeObserver;n!=null?(this._resizeObserver=new n(()=>{this._timeoutId=setTimeout(this._onResize,0)}),this._resizeObserver.observe(r)):(this._detectElementResize=rr(t),this._detectElementResize.addResizeListener(r,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),this._timeoutId!==null&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){const{children:t,defaultHeight:r,defaultWidth:n,disableHeight:i=!1,disableWidth:o=!1,doNotBailOutOnEmptyChildren:l=!1,nonce:c,onResize:d,style:x={},tagName:g="div",...E}=this.props,{height:a,scaledHeight:_,scaledWidth:f,width:u}=this.state,j={overflow:"visible"},m={};let h=!1;return i||(a===0&&(h=!0),j.height=0,m.height=a,m.scaledHeight=_),o||(u===0&&(h=!0),j.width=0,m.width=u,m.scaledWidth=f),l&&(h=!1),D.createElement(g,{ref:this._setRef,style:{...j,...x},...E},!h&&t(m))}}const ir=s=>{const{isDraft:t,isOpen:r,onClose:n}=s,i=D.useRef(),{state:o,retry:l}=js(),c=()=>{const{filteredData:d,handleSearchInputChange:x}=Qe(i.current??[],["screen_name"]),g=30,E=({style:a,index:_,data:f})=>{const u=f==null?void 0:f[_];return u!=null?e.jsx(e.Fragment,{children:e.jsx(Ps,{style:a,children:u.habilitado?e.jsx(nt,{href:Ye(t?qt:Yt,{client:u.id}),children:e.jsxs(I,{children:[e.jsx(Re,{as:bs,color:"green.400"}),u.screen_name]})}):e.jsxs(I,{color:"gray.400",sx:{cursor:"not-allowed"},children:[e.jsx(Re,{as:Ds,color:"red.400"}),u.screen_name]})},u.id)}):e.jsx(e.Fragment,{})};return e.jsxs(e.Fragment,{children:[e.jsx(I,{sx:{pb:4},children:e.jsx(Je,{handleSearchInputChange:x})}),e.jsx(nr,{children:({height:a,width:_})=>e.jsx(Cs,{height:a-60,itemCount:d.length??0,itemSize:g,innerElementType:Is,width:_,itemData:d,children:E})})]})};return e.jsxs(He,{isCentered:!0,isOpen:r,onClose:n,scrollBehavior:"inside",size:{base:"full",sm:"md",md:"lg"},children:[e.jsx(Ve,{}),e.jsxs($e,{sx:{maxHeight:"auto"},children:[e.jsx(We,{children:"Seleccione el cliente"}),e.jsx(Ge,{}),e.jsx(Xe,{minHeight:{base:"auto",sm:"420px !important"},children:o.map({loading:d=>e.jsxs(rt,{spacing:4,children:[e.jsx(Te,{width:"full",height:"36px",borderRadius:"md"}),e.jsx(Te,{width:"full",height:"250px",borderRadius:"md"})]}),error:({error:d})=>e.jsx(Ke,{error:d,retry:l,cancelAndNavigateTo:Xt}),success:d=>(i.current=qe.sortBy(d.data,["screen_name"]),e.jsx(c,{}))})})]})]})},ar="modulepreload",or=function(s){return"/"+s},Le={},lr=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.all(r.map(c=>{if(c=or(c),c in Le)return;Le[c]=!0;const d=c.endsWith(".css"),x=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${x}`))return;const g=document.createElement("link");if(g.rel=d?"stylesheet":ar,d||(g.as="script",g.crossOrigin=""),g.href=c,l&&g.setAttribute("nonce",l),document.head.appendChild(g),d)return new Promise((E,a)=>{g.addEventListener("load",E),g.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${c}`)))})}))}return i.then(()=>t()).catch(o=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o})},cr=()=>e.jsxs(rt,{spacing:4,children:[e.jsx(z,{}),e.jsx(z,{})]});let dr=D.lazy(()=>lr(()=>import("./PrintModal.client-C3BI6nNz.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36])));const hr=s=>{const{pedidos:t,renglones:r,isOpen:n,onClose:i}=s;return e.jsxs(He,{isCentered:!0,isOpen:n,onClose:i,children:[e.jsx(Ve,{}),e.jsxs($e,{children:[e.jsx(We,{children:"Impresión de pedidos"}),e.jsx(Ge,{}),e.jsx(Xe,{children:e.jsx(D.Suspense,{fallback:e.jsx(cr,{}),children:e.jsx(dr,{pedidos:t,renglones:r})})})]})]})},ur=({isDraft:s,pedidos:t,stateRenglones:r,handleSearchInputChange:n})=>{const i=et(),[o,l]=D.useState(!1),[c,d]=D.useState(!1),{isOpen:x,onOpen:g,onClose:E}=ce(),{isOpen:a,onOpen:_,onClose:f}=ce(),[u,j]=D.useState([]),m=D.useRef({pedidos:[],renglones:{}});D.useEffect(()=>{const S=({id:N,checked:se})=>{j(se?U=>[...U,N]:U=>U.filter(re=>re!==N))};return k.on("setUnsetSelectedPedido",S),()=>{k.removeListener("setUnsetSelectedPedido",S)}},[]);const h=()=>{if(i.authState.isCustomer()){i.navigate(s?Jt:es);return}l(!0),g()},O=()=>{E(),l(!1)},R=()=>{m.current.pedidos=t.filter(S=>u.includes(S.id)),Array.isArray(m.current.pedidos)&&m.current.pedidos.length>0&&r.isSuccess()&&(m.current.renglones=qe.pick(r.data,u)),d(!0),_()},C=()=>{f(),d(!1)},y=u.length<=0?void 0:u.length==1?`1 ${ps}`:`${u.length} ${gs}`;return e.jsxs(e.Fragment,{children:[e.jsx(I,{bg:Ze("white","blue.900"),sx:{px:4,position:"sticky",zIndex:1e3,top:0},children:e.jsxs(Ce,{h:16,alignItems:"center",justifyContent:"space-between",children:[e.jsxs(Ie,{spacing:{base:2,sm:3},alignItems:"center",children:[(i.authState.isVendor()||i.authState.isCustomer())&&e.jsx(e.Fragment,{children:e.jsx(Ae,{icon:Zs,text:s?Zt:Kt,sharedProps:{size:"sm",fontWeight:"400",colorScheme:s?"green":"orange",onClick:()=>{h()}},iconProps:{boxSize:{base:5,md:4}}})}),!s&&e.jsx(Ae,{icon:sr,text:Qt,sharedProps:{size:"sm",fontWeight:"400",colorScheme:"blue",onClick:()=>R(),isDisabled:u.length<=0},iconProps:{boxSize:{base:5,md:4}}}),y!=null&&e.jsxs(e.Fragment,{children:[e.jsx(de,{display:{base:"none",sm:"inherited"},height:8,borderRadius:40,size:"md",variant:"solid",colorScheme:"blue",children:e.jsx(he,{marginX:1,children:y})}),e.jsx(de,{display:{base:"inherited",sm:"none"},height:8,borderRadius:40,size:"md",variant:"solid",colorScheme:"blue",children:e.jsx(he,{marginX:1,children:u.length})})]})]}),e.jsx(Ce,{alignItems:"center",marginLeft:4,children:e.jsx(Ie,{spacing:{base:2,md:4},children:e.jsx(I,{children:e.jsx(Je,{handleSearchInputChange:n})})})})]})}),o&&e.jsx(ir,{isDraft:s,isOpen:x,onClose:O}),c&&e.jsx(hr,{isOpen:a,onClose:C,pedidos:m.current.pedidos,renglones:m.current.renglones})]})};var v=(s=>(s[s.INVALIDO=0]="INVALIDO",s[s.INGRESADO=1]="INGRESADO",s[s.APROBADO=2]="APROBADO",s[s.CUMPLIDO=3]="CUMPLIDO",s[s.CERRADO=4]="CERRADO",s[s.ANULADO=5]="ANULADO",s[s.EN_PROGRESO=100]="EN_PROGRESO",s))(v||{});class mr{constructor(t){this.id=t}parentToUnsafe(){return{id:this.id.valueOf()}}}class fr extends mr{}function _r(s){try{return ts(b,s)}catch{throw new Q(`Invalid user role value: ${s}`)}}function pr(s){try{return ss(b,s)}catch{throw new Q(`Invalid user role string: ${ge(s,!0)}`)}}function gr(s){switch(s){case b.customer:return 0;case b.vendor:return 1;case b.admin:return 2}throw new Q(`Invalid user role: ${ge(s,!0)}`)}function xr(s){switch(s){case 0:return b.customer;case 1:return b.vendor;case 2:return b.admin}throw new Q(`Invalid user role number: ${ge(s,!0)}`)}class Or extends _e{validate(t){try{if(typeof t=="string")return pr(t);if(rs(b,t))return t}catch{}this.throwError(t)}toString(){return _r(this.value)}isAdmin(){return this.value.valueOf()==b.admin}isVendor(){return this.value.valueOf()==b.vendor}isCustomer(){return this.value.valueOf()==b.customer}}class Ne extends fr{constructor(t){super(new ae(t.id));const{username:r,tango_id:n,habilitado_en_tango:i,screen_name:o,email:l,password_hash:c,role:d,habilitado_en_dxt:x,puede_crear_pedido:g,puede_editar_pedido:E,puede_anular_pedido:a,borrar_pedido_al_anular:_,perfil_facturacion_id:f,aprobar_pedido_al_crear:u,ver_pedidos_cumplidos:j,dia_de_entrega:m,ver_sin_precio:h,mostrar_mensaje_de_advertencia:O,timestamp_modificacion:R,vendedor_id:C,id_lista_alternativa:y,bonificacion_lista_alternativa:S,universal_id:N}=t;if(this.username=new ws(r),this.screenName=new De(o),typeof l=="string"&&(this.email=new De(l.trim()!==""?new Us(l).valueOf():"")),this.passwordHash=new Oe(c),this.role=new Or(xr(d)),this.habilitadoEnDXT=new w(x),this.puedeCrearPedido=new w(g),this.puedeEditarPedido=new w(E),this.puedeAnularPedido=new w(a),this.borrarPedidoAlAnular=new w(_),this.perfilFacturacionId=new W(f),this.aprobarPedidoAlCrear=new w(u),this.verPedidosCumplidos=new w(j),this.diaDeEntrega=new ae(m),this.verSinPrecio=new w(h),this.mostrarMensajeDeAdvertencia=new w(O),this.timestampModificacion=new ae(R),!this.role.isAdmin()&&n==null)throw new ns(new is(as.UNPROCESSABLE_ENTITY,{extra:"tango_id missing in UserEntity"}));this.tangoId=n!=null?new W(n):void 0,this.habilitadoEnTango=i!=null?new w(i):void 0,this.vendedorId=C!=null?new W(C):void 0,this.idListaAlternativa=y!=null?new W(y):void 0,this.bonificacionListaAlternativa=S!=null?new os(S):void 0,this.universalId=new ls(N.replaceAll("-",""))}toUnsafe(){var r,n,i,o,l;return{...this.parentToUnsafe(),username:this.username.valueOf(),tango_id:(r=this.tangoId)==null?void 0:r.valueOf(),habilitado_en_tango:(n=this.habilitadoEnTango)==null?void 0:n.valueOf(),screen_name:this.screenName.valueOf(),email:((i=this.email)==null?void 0:i.valueOf())??null,password_hash:this.passwordHash.valueOf(),role:gr(this.role.valueOf()),habilitado_en_dxt:this.habilitadoEnDXT.valueOf(),puede_crear_pedido:this.puedeCrearPedido.valueOf(),puede_editar_pedido:this.puedeEditarPedido.valueOf(),puede_anular_pedido:this.puedeAnularPedido.valueOf(),borrar_pedido_al_anular:this.borrarPedidoAlAnular.valueOf(),perfil_facturacion_id:this.perfilFacturacionId.valueOf(),aprobar_pedido_al_crear:this.aprobarPedidoAlCrear.valueOf(),ver_pedidos_cumplidos:this.verPedidosCumplidos.valueOf(),dia_de_entrega:this.diaDeEntrega.valueOf(),ver_sin_precio:this.verSinPrecio.valueOf(),mostrar_mensaje_de_advertencia:this.mostrarMensajeDeAdvertencia.valueOf(),timestamp_modificacion:this.timestampModificacion.valueOf(),id_lista_alternativa:(o=this.idListaAlternativa)==null?void 0:o.valueOf(),bonificacion_lista_alternativa:(l=this.bonificacionListaAlternativa)==null?void 0:l.valueOf(),universal_id:this.universalId.valueOf()}}tangoUserExists(){return this.habilitadoEnTango!=null}habilitado(){return this.habilitadoEnDXT.valueOf()&&this.habilitadoEnTango!=null&&this.habilitadoEnTango.valueOf()}isAdmin(){return this.role.isAdmin()}isCustomer(){return this.role.isCustomer()}isVendor(){return this.role.isVendor()}hasAdminAccess(){return this.role.isAdmin()}}function vr(s){switch(s){case v.INGRESADO:return gt;case v.APROBADO:return pt;case v.CUMPLIDO:return _t;case v.CERRADO:return ft;case v.ANULADO:return mt;case v.EN_PROGRESO:return ut;default:return ht}}function Er(s,t){const{estado:r}=s;if(!(t!=null&&(r==v.APROBADO||r==v.INGRESADO)))return r;for(const i of t){const{a_descontar:o,a_facturar:l,pendiente_descontar:c,pendiente_facturar:d}=i;if(o!=c||l!=d)return v.EN_PROGRESO}return r}function jr(s,t){return t==v.INGRESADO}function Dr(s,t){if(t==v.INGRESADO)return!0;const r=s instanceof Ne?s.isAdmin():s.role==b.admin,n=s instanceof Ne?s.aprobarPedidoAlCrear.valueOf():s.aprobar_pedido_al_crear;return!!(t==v.APROBADO&&n||(t==v.EN_PROGRESO||t==v.ANULADO)&&r)}function br(s,t){return t.isSuccess()?Er(s,t.data[s.id]):s.estado}function lt(s,t){let r;switch(s){case v.INGRESADO:r="blue";break;case v.APROBADO:r="purple";break;case v.CUMPLIDO:r="green";break;case v.CERRADO:r="black";break;case v.ANULADO:r="red";break;default:r="gray"}return t==null?r:`${r}${t}`}const Ar=({estado:s})=>{const t=vr(s),r=lt(s);return e.jsx(Ss,{fontSize:"1em",variant:"solid",colorScheme:r,lineHeight:"1.5em",children:t})};function Rr(s){return s&&typeof s=="object"&&"default"in s?s.default:s}var K=Rr(D),Tr=Object.assign||function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},Cr=function(s,t){var r={};for(var n in s)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n]);return r},Fe=function(t){var r=t.color,n=r===void 0?"currentColor":r,i=t.size,o=i===void 0?24:i;t.children;var l=Cr(t,["color","size","children"]),c="mdi-icon "+(l.className||"");return K.createElement("svg",Tr({},l,{className:c,width:o,height:o,fill:n,viewBox:"0 0 24 24"}),K.createElement("path",{d:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"}))},Ir=K.memo?K.memo(Fe):Fe,Pr=Ir;const wr=fe(Pr),Sr=({app:s,draft:t,pedido:r,onDelete:n})=>{const i=s.authState.userInfo,o=i.role==b.admin,l=jr(i,r.estado),c=i.puede_anular_pedido&&Dr(i,r.estado),d=t||i.borrar_pedido_al_anular;return e.jsxs(ys,{isLazy:!0,id:"menu",children:[e.jsx(zs,{as:Fs,size:"sm","aria-label":xs,icon:e.jsx(wr,{}),variant:"outline",colorScheme:"white"}),e.jsx(cs,{children:e.jsxs(Ls,{rootProps:{zIndex:2e3},children:[!o&&e.jsxs(e.Fragment,{children:[e.jsx(M,{onClick:()=>{s.navigate(Ye(t?ds:hs,{id:r.id}))},isDisabled:!l,children:xt}),e.jsx(M,{onClick:()=>{},children:Ot}),e.jsx(M,{onClick:()=>{},children:t?vt:Et}),t&&e.jsx(M,{onClick:()=>{},children:jt}),e.jsx(Ns,{})]}),e.jsx(M,{onClick:()=>n(r.id),isDisabled:!c,children:d?Dt:bt})]})})]})},yr=()=>e.jsxs(J,{status:"warning",children:[e.jsx(ee,{}),e.jsx(te,{children:"El pedido no cuenta con productos."})]}),zr=()=>e.jsxs(J,{status:"error",children:[e.jsx(ee,{}),e.jsx(te,{children:"Ocurrió un error al cargar los detalles del pedido."})]}),Lr=()=>e.jsx(I,{width:"full",sx:{mt:8,mb:4},children:e.jsxs(B,{templateColumns:"1fr",alignItems:"center",gap:2,children:[e.jsx(p,{children:e.jsx(z,{height:"20px"})}),e.jsx(p,{children:e.jsx(z,{height:"20px"})}),e.jsx(p,{children:e.jsx(z,{height:"20px"})}),e.jsx(p,{children:e.jsx(z,{height:"20px"})})]})}),Nr=({nro_pedido:s,renglones:t})=>e.jsx(it,{sx:{p:0,m:0},children:e.jsxs(tt,{variant:"stripedHoverOverCard",colorScheme:"gray",size:"sm",borderWidth:"1px",children:[e.jsx(As,{children:e.jsx(q,{children:e.jsx(Rs,{sx:{py:2},children:e.jsxs(B,{templateColumns:{base:"1fr 1fr 1fr",md:"4fr 1fr 1fr 1fr"},gap:6,children:[e.jsx(p,{children:e.jsx(A,{fontSize:{base:"xs",md:"sm"},children:"Artículo"})}),e.jsx(p,{sx:{display:{base:"none",md:"block"}},children:e.jsx(A,{fontSize:{base:"xs",md:"sm"},textAlign:"center",children:"Precio"})}),e.jsx(p,{children:e.jsx(A,{fontSize:{base:"xs",md:"sm"},textAlign:"center",children:"Cantidad"})}),e.jsx(p,{children:e.jsx(A,{fontSize:{base:"xs",md:"sm"},textAlign:"center",children:"Subtotal"})})]})})})}),e.jsx(st,{children:t.map(({id_articulo:r,nombre_articulo:n,codigo_articulo:i,descripcion_adicional:o,precio:l,cantidad:c,subtotal:d},x)=>e.jsx(q,{children:e.jsx(xe,{children:e.jsxs(B,{templateColumns:{base:"1fr 1fr 1fr",md:"4fr 1fr 1fr 1fr"},gap:6,children:[e.jsx(p,{children:e.jsx(G,{children:At(n,r,o)})}),e.jsx(p,{sx:{display:{base:"none",md:"block"}},children:e.jsx(Ee,{precio:l,moneda:"$"})}),e.jsx(p,{children:e.jsx(X,{textAlign:"center",children:c})}),e.jsx(p,{children:e.jsx(Ee,{precio:d,moneda:"$"})})]})})},`details-${s}-${x}`))})]})}),Fr=({wasOpen:s,pedido:t,stateRenglones:r})=>e.jsx(I,{sx:{mt:6},children:s&&r.map({loading:n=>e.jsx(Lr,{}),error:n=>e.jsx(zr,{}),success:n=>{var c;const{id:i,numero_pedido:o}=t,l=(c=n.data)==null?void 0:c[i];return Array.isArray(l)?e.jsx(Nr,{nro_pedido:o,renglones:l}):e.jsx(yr,{})}})}),kr=({index:s,app:t,draft:r,pedido:n,stateRenglones:i,onDelete:o,isHidden:l})=>{const[c,d]=D.useState(!1),[x,g]=D.useState(!1),E=Ze("gray.800","white"),a=D.useRef(!1),_=br(n,i),f=D.useMemo(()=>e.jsx(Fr,{wasOpen:a.current,pedido:n,stateRenglones:i}),[a.current,i.constructor.name]),u=()=>{const P=!c;P&&(a.current=!0),d(P),k.emit("togglePedidoDetails",{id:n.id})},j=(P,ie)=>{g(!!P),k.emit("setUnsetSelectedPedido",{id:ie,checked:P})};D.useEffect(()=>{const P=({id:ie})=>{n.id!==ie&&d(!1)};return k.on("togglePedidoDetails",P),()=>{k.removeListener("togglePedidoDetails",P)}},[]);const{id:m,numero_pedido:h,fecha_alta:O,fecha_entrega:R,codigo_cliente:C,codigo_vendedor:y,codigo_transporte:S,nombre_cliente:N,nombre_vendedor:se,nombre_transporte:U,total:re,descuento:ve,comentarios:ne,descripcion:ct}=n,V=_,dt=ne!=null&&ne.length>0;return e.jsx(q,{sx:{...l&&!x&&{display:"none"}},children:e.jsxs(xe,{sx:{py:6,position:"relative",borderTopWidth:{base:"3px",md:"4px"},borderTopStyle:"solid",borderTopColor:`${r?"blue.500 !important":lt(V,".500 !important")}`},children:[e.jsxs(I,{display:"flex",sx:{position:"absolute",right:5,top:5},flexDirection:"column",children:[e.jsx(Sr,{app:t,draft:r,pedido:n,onDelete:o}),!r&&e.jsx(ks,{size:"xl",colorScheme:"blue",sx:{mt:2,borderWidth:0,borderColor:E},onChange:P=>{j(P.target.checked,m)}})]}),e.jsxs(B,{templateColumns:{base:"repeat(2, 1fr)",md:"repeat(4, 1fr)"},gap:6,sx:{cursor:"pointer"},onClick:()=>{u()},children:[r?e.jsx(e.Fragment,{children:e.jsx(p,{colSpan:{base:2,md:4},children:e.jsx(A,{size:"md",textTransform:"uppercase",children:ct})})}):e.jsxs(e.Fragment,{children:[e.jsxs(p,{children:[e.jsx(A,{size:"sm",children:"Pedido"}),e.jsx(X,{children:h})]}),e.jsxs(p,{children:[e.jsx(A,{size:"sm",children:"Estado"}),e.jsx(Ar,{estado:V})]}),e.jsxs(p,{children:[e.jsx(A,{size:"sm",children:"Emisión"}),e.jsx(X,{children:be(O)})]}),e.jsxs(p,{children:[e.jsx(A,{size:"sm",children:"Entrega"}),e.jsx(X,{children:be(R)})]})]}),e.jsxs(p,{children:[e.jsx(A,{size:"sm",children:"Cliente"}),e.jsx(G,{children:Rt(C,N)})]}),e.jsxs(p,{children:[e.jsx(A,{size:"sm",children:"Vendedor"}),e.jsx(G,{children:je(y,se)})]}),e.jsxs(p,{children:[e.jsx(A,{size:"sm",children:"Transporte"}),e.jsx(G,{children:je(S,U)})]}),e.jsxs(p,{children:[e.jsxs(A,{size:"md",sx:{textTransform:"uppercase",color:V===v.APROBADO&&"green.400"},children:["Total",ve!=null&&e.jsxs(e.Fragment,{children:[" ",`-${ve}%`]})]}),e.jsx(A,{size:"md",sx:{fontWeight:"bolder",color:V===v.APROBADO&&"green.400"},children:e.jsx(Tt,{precio:re,moneda:"$"})})]}),dt&&e.jsx(p,{colSpan:{base:2,md:4},children:e.jsxs(J,{status:"info",children:[e.jsx(ee,{}),e.jsx(te,{children:ne})]})})]}),e.jsx(I,{children:e.jsx(I,{sx:{display:c?"block":"none"},children:f})},`pedido-details-${s}`)]})})};function Ur(s){const t=et(),n=t.authState.userInfo.borrar_pedido_al_anular.valueOf(),{draft:i,unfilteredPedidos:o,filteredPedidos:l,isFiltering:c,stateRenglones:d,reloadData:x}=s,g=Es(),E=ce(),{isOpen:a,onOpen:_,onClose:f}=E,u=D.useRef(null),j=h=>{u.current=h,_()},m=async()=>{const h=u.current;if(h!=null){const O=i?await zt(h,t):await Lt(h,t);console.log(O),O.map({success:R=>{g({title:i?Nt:n?Ft:kt,status:"success"})},error:R=>{g({title:ms,status:"error"})}}),O.isSuccess()&&await x(),f()}};return e.jsxs(it,{sx:{p:0,m:0},children:[e.jsx(tt,{variant:"stripedOverCard",colorScheme:"gray",size:"md",sx:{borderCollapse:"separate",borderSpacing:"0 1rem"},children:e.jsxs(st,{children:[o.map((h,O)=>e.jsx(kr,{index:O,draft:i,app:t,pedido:h,stateRenglones:d,onDelete:j,isHidden:c&&!l.includes(h)},`pedido-${h.id}`)),!l.length&&e.jsx(q,{children:e.jsx(xe,{children:e.jsxs(J,{status:"info",children:[e.jsx(ee,{}),e.jsx(te,{children:c?us:i?Os:vs})]})})})]})}),e.jsx(Ts,{isOpen:a,onClose:f,handleDeletion:m,message:{title:i?Ct:n?It:Pt,body:i?wt:n?St:yt}})]})}const Mr=s=>{const{showDrafts:t,pedidos:r,reloadData:n}=s,i=fs().state.userOrThrow(),o=i.role==b.admin;i.role==b.vendor;const l=i.role==b.customer,{filteredData:c,handleSearchInputChange:d,isFiltering:x}=Qe(r,["comentario",...t?[]:["numero_pedido"],...l?[]:["codigo_cliente","nombre_cliente"],...o?["codigo_vendedor","nombre_vendedor"]:[]]),{state:g}=ke({...t?Ut:Mt,silent:!0,transformResponse:E=>(Object.values(E).forEach(a=>{Array.isArray(a)&&a.sort((_,f)=>_.renglon-f.renglon)}),E)});return e.jsxs(e.Fragment,{children:[e.jsx(ur,{isDraft:t,pedidos:r,stateRenglones:g,handleSearchInputChange:d}),e.jsx(Ur,{draft:t,stateRenglones:g,unfilteredPedidos:r,filteredPedidos:c,isFiltering:x,reloadData:n})]})},pn=s=>{const t=s.showDrafts===!0,{state:r,retry:n,reload:i}=ke({...t?Bt:Ht,silent:!0});return r.map({loading:o=>e.jsx($s,{}),error:({error:o})=>e.jsx(Ke,{error:o,retry:n,cancelAndNavigateTo:_s}),success:o=>e.jsx(Mr,{showDrafts:t,pedidos:o.data,reloadData:i})})};export{pn as O,cr as P,vr as g};
