import{r as v,j as e}from"./emotion-element-43c6fea0.browser.esm-Bukkp3pI.js";import{c as q,D as X}from"./validation-BHlFUWUY.js";import{_ as $,I as Q,Q as W}from"./auth_context-D8ug2Qcd.js";import{d as J,V as K,P as Y}from"./PasswordWithStatus-DKSTs8vM.js";import{y as Z}from"./utils-DihYaFf6.js";import{c as ee,a as re}from"./index.esm-DLycO5Xl.js";import{a as se,o as oe}from"./yup-BdZyDz3M.js";import{F as I,a as D,b as E}from"./useDXTApiFetch-BjHmfZbr.js";import{A as ae}from"./AccountCancelIcon-BwrrLNSn.js";import{A as ie,a as te,C as ne,b as i,c as le}from"./ControlledSwitch-BYzMyLCt.js";import{u as de,a as pe}from"./app_resources-CEgZe0CK.js";import{u as w,C as T}from"./ControlledSelect-fjUlVCrq.js";import{a as ce,b as me}from"./app-B420985G.js";import{C as j}from"./CommonCard-C2byJLAu.js";import{C as P}from"./ControlledInput-BWCaGqUR.js";import{F as ue}from"./FormErrors-BaCwbtS0.js";import{I as A}from"./InlineError-rXH3I37w.js";import{S as fe}from"./SettingsFormButtons-CthONgBp.js";import{G as R,a as r}from"./chunk-ZPFGWTBB-qFhw8OhE.js";import{H as x}from"./chunk-7OLJDQMT-W4l9hI3h.js";import{D as h}from"./chunk-W7WUSNWJ-DDHZDhn1.js";import{S as _e}from"./chunk-ZHMYA64R-D24w8AgT.js";import{H as n}from"./chunk-3ASUQ6PA-BAcdPhwD.js";const xe=()=>{const[l,a]=v.useState(null),p=ee({password:re().required("Ingrese una contraseña").test("password","Formato de contraseña no válido",t=>{if(t!=""&&t!=null){let c=J(t);return $.isEqual(l,c)||a(c),Z(K,t)}return!0})}).required();return{yupValidationSchema:q.concat(p),passwordStatus:l}},he=l=>{var C,S;const{typeSettings:a,returnUrl:p,title:m}=l,t=de(),c=pe(),{yupValidationSchema:y,passwordStatus:F}=xe(),{state:u,result:L}=w({endpoint:le,fieldsMap:{label:"name",value:"id"}}),{state:f,result:O}=w({endpoint:a.userType==="cliente"?ie:te,fieldsMap:{label:"screen_name",value:"id",isEnabled:"habilitado"},disabledIcon:e.jsx(Q,{as:ae,color:"red.400",ml:2,boxSize:5})}),{handleSubmit:V,control:o,setError:G,resetField:N,watch:U,formState:{errors:z,isSubmitting:M,isSubmitSuccessful:k}}=se({defaultValues:{username:"",password:"",email:"",tango_id:0,perfil_facturacion_id:0,habilitado_en_dxt:!0,puede_crear_pedido:!0,puede_editar_pedido:!0,ver_pedidos_cumplidos:!0,ver_sin_precio:!1,mostrar_mensaje_de_advertencia:!1,puede_anular_pedido:!1,borrar_pedido_al_anular:!1,aprobar_pedido_al_crear:!1,dia_de_entrega:X},resolver:oe(y)}),_=U("puede_anular_pedido");v.useEffect(()=>{_===!1&&N("borrar_pedido_al_anular",{defaultValue:!1})},[_]);const s=k||M,B=async b=>{const{...d}=b;d.email===""&&delete d.email;const H=d;(await a.api.post(H,t)).map({success:g=>{c({title:me,status:"success"}),t.navigate(p)},error:g=>{c({title:W,status:"error"}),G("root",{message:g.info.error_description})}})};return e.jsx("form",{noValidate:!0,onSubmit:V(B),children:e.jsxs(ce,{children:[e.jsx(ue,{errors:z}),e.jsx(j,{children:e.jsxs(R,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(r,{colSpan:{md:2},children:e.jsx(x,{size:"sm",textTransform:"uppercase",children:m})}),e.jsxs(r,{colSpan:{md:2},children:[e.jsx(T,{fieldProps:{name:"tango_id",placeholder:(C=a.tangoRelatedFields)==null?void 0:C.placeholder,options:O,noOptionsMessage(b){var d;return(d=a.tangoRelatedFields)==null?void 0:d.empty},isSearchable:!0,selectedOptionStyle:"check",isLoading:f instanceof I,virtualized:!0},formControlProps:{isDisabled:s||!(f instanceof D)},formControlInnerProps:{label:(S=a.tangoRelatedFields)==null?void 0:S.label},control:o}),f instanceof E&&e.jsx(A,{error:f.errorOrNull().error})]}),e.jsx(r,{children:e.jsx(P,{fieldProps:{name:"username",id:"username",type:"text"},formControlProps:{isDisabled:s},formControlInnerProps:{label:"Nombre de Usuario"},control:o})}),e.jsx(r,{children:e.jsx(Y,{fieldProps:{name:"password",id:"password"},formControlInnerProps:{label:"Contraseña"},passwordStatus:F,disableForm:s,control:o})}),e.jsx(r,{children:e.jsx(P,{fieldProps:{name:"email",id:"email",type:"text",inputMode:"email"},formControlProps:{isDisabled:s},formControlInnerProps:{label:"Correo electrónico"},control:o})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(h,{})}),e.jsxs(r,{colSpan:{md:2},children:[e.jsx(T,{fieldProps:{name:"perfil_facturacion_id",placeholder:"Seleccione un perfil",options:L,noOptionsMessage(b){return"No hay perfiles disponibles"},isLoading:u instanceof I,selectedOptionStyle:"check"},formControlProps:{isDisabled:s||!(u instanceof D)},formControlInnerProps:{label:"Perfil de facturación"},control:o}),u instanceof E&&e.jsx(A,{error:u.errorOrNull().error})]}),e.jsx(r,{colSpan:{md:2},children:e.jsx(h,{})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(x,{size:"sm",textTransform:"uppercase",children:"Estado"})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(ne,{fieldProps:{name:"habilitado_en_dxt",options:[{value:!0,label:"Establecido en Tango"},{value:!1,label:"Deshabilitado"}]},formControlProps:{isDisabled:s},radioProps:{size:{base:"sm",sm:"md"}},control:o})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(h,{})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(x,{size:"sm",textTransform:"uppercase",children:"Comunicación"})}),e.jsx(r,{children:e.jsx(i,{fieldProps:{name:"mostrar_mensaje_de_advertencia",id:"mostrar_mensaje_de_advertencia"},formControlProps:{width:"auto",isDisabled:s},formControlInnerProps:{label:"Mostrar mensaje de advertencia"},control:o})})]})}),e.jsx(j,{children:e.jsxs(R,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(r,{colSpan:{md:2},children:e.jsx(x,{size:"sm",textTransform:"uppercase",children:"Pedidos"})}),e.jsx(r,{colSpan:{md:2},children:e.jsxs(_e,{spacing:4,direction:{base:"column"},children:[e.jsx(n,{spacing:4,children:e.jsx(i,{fieldProps:{name:"puede_crear_pedido",id:"puede_crear_pedido"},formControlProps:{width:"auto",isDisabled:s},formControlInnerProps:{label:"Puede crear pedidos"},control:o})}),e.jsx(n,{spacing:4,children:e.jsx(i,{fieldProps:{name:"puede_editar_pedido",id:"puede_editar_pedido"},formControlProps:{width:"auto",isDisabled:s},formControlInnerProps:{label:"Puede editar pedidos"},control:o})}),e.jsx(n,{spacing:4,children:e.jsx(i,{fieldProps:{name:"puede_anular_pedido",id:"puede_anular_pedido"},formControlProps:{width:"auto",isDisabled:s},formControlInnerProps:{label:"Puede anular pedidos"},control:o})}),e.jsx(n,{spacing:4,children:e.jsx(i,{fieldProps:{name:"borrar_pedido_al_anular",id:"borrar_pedido_al_anular"},formControlProps:{width:"auto",isDisabled:s},formControlInnerProps:{label:"Borrar pedido al anular"},control:o,watch:{isDisabled:_===!1,..._===!1&&{isChecked:!1}}})}),e.jsx(n,{spacing:4,children:e.jsx(i,{fieldProps:{name:"aprobar_pedido_al_crear",id:"aprobar_pedido_al_crear"},formControlProps:{width:"auto",isDisabled:s},formControlInnerProps:{label:"Los pedidos se aprueban al crearlos"},control:o})}),e.jsx(n,{spacing:4,children:e.jsx(i,{fieldProps:{name:"ver_pedidos_cumplidos",id:"ver_pedidos_cumplidos"},formControlProps:{width:"auto",isDisabled:s},formControlInnerProps:{label:"Puede ver los pedidos cumplidos"},control:o})}),e.jsx(n,{spacing:4,children:e.jsx(i,{fieldProps:{name:"ver_sin_precio",id:"ver_sin_precio"},formControlProps:{width:"auto",isDisabled:s},formControlInnerProps:{label:"Puede ver artículos sin precio"},control:o})})]})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(h,{})}),e.jsx(r,{children:e.jsx(P,{fieldProps:{name:"dia_de_entrega",id:"dia_de_entrega",type:"number",inputMode:"tel"},formControlProps:{isDisabled:s},formControlInnerProps:{label:"Tiempo de entrega de pedidos",helperText:"Expresado en días"},control:o})}),e.jsx(r,{})]})}),e.jsx(j,{children:e.jsx(fe,{buttonActionText:"Guardar",isLoading:s,hideCancelButton:!0})})]})})},ke=l=>{const{typeSettings:a,returnUrl:p,title:m}=l;return e.jsx(he,{typeSettings:a,returnUrl:p,title:m})};export{ke as D};
