import{j as e,r as T,g as ae}from"./emotion-element-43c6fea0.browser.esm-CqNy1Myq.js";import{u as Ee}from"./useDXTApiFetch-DJJQmcPU.js";import{F as Ne,G as Fe,H as ke,I as Me,J as Be,K as He,L as Ue,M as $e,N as We,O as Ve,Q as Ge,o as qe,k as Ke,l as N,m as Re,T as Xe,R as Ye,S as Ze,U as Je,V as Qe,W as et,X as tt,Y as st,Z as rt,_ as it,$ as nt,a0 as at,a1 as ot,a2 as lt,a3 as ct,a4 as dt}from"./TextPrice-BpaUIUlQ.js";import{f as w,u as ht,o as De,c as W,d as ut,p as mt,m as _t,I as V,bd as gt,be as ft,bf as xt,bg as pt,bh as jt,bi as Et,U as Rt,_ as Dt,aH as z,bj as Ot,bk as Tt,bl as P,bm as bt,bn as vt,am as At,bo as St,bp as Ct,bq as It,aA as Lt,br as yt,bs as zt,bt as Pt,bu as wt,bv as Nt,bw as Ft,bx as kt,g as Q,by as Mt,ak as Bt,bz as Oe,b5 as Ht,Y as Ut,ac as $t,aT as K,an as Wt}from"./auth_context-BPNKm5C_.js";import{S as le,A as Te}from"./ApiErrors-DQxu8cuC.js";import{a as y,F as M}from"./FormSkeletons-FVNY-1Wx.js";import{N as be,M as Vt,a as Gt,b as I,c as X}from"./Navbar-yLlv-fhh.js";import{O as ve,u as qt,d as Kt,a as Xt,m as Yt,r as Zt}from"./OrdersContainer-v_hilEa5.js";import{B as S}from"./chunk-PULVB27S-CjXp21rs.js";import{G,a as R}from"./chunk-ZPFGWTBB-BGOvs2SN.js";import{u as Ae,S as Se}from"./SearchField-CJhunbce.js";import{P as Jt,r as Qt,E as C,i as es,a as ce,g as ts,b as ss}from"./index-BUXJlPvv.js";import{u as Ce}from"./app_resources-BncH8wDZ.js";import{G as rs,H as is,O as ns,J as as,K as os}from"./app-CX69rDqm.js";import{R as de}from"./ResponsiveIconButton-DTsMLJ6O.js";import{j as ls,i as cs}from"./AccountCancelIcon-pzBu00eN.js";import{A as ds,T as L,u as hs,C as he}from"./ConfirmationDialog-JeoAAetu.js";import{F as us}from"./index.esm-Bnwmk-nH.js";import{a as ms,L as _s,b as ue}from"./chunk-46CXQZ4E-B49QqCoR.js";import{V as gs}from"./chunk-NTCQBYKE-fAVIJNuR.js";import{F as ee}from"./chunk-KRPLQIP4-BuYv1GpP.js";import{H as me}from"./chunk-3ASUQ6PA-hNB_nry7.js";import{f as fs}from"./chunk-HB6KBUMZ-BUJUEYCo.js";import{I as xs}from"./chunk-6QYXN73V-QyLCLJ50.js";import{A as F}from"./chunk-3KCBMPN5-BlEVF58j.js";import{A as oe,b as k}from"./chunk-QURMB2UJ-CVr_6ThV.js";import{T as B}from"./chunk-2OOHT3W5-U8fop6km.js";import{B as ps}from"./chunk-Z6RXEUPO-JBJHcxCd.js";import{H as O}from"./chunk-7OLJDQMT-Dt4RFKr6.js";import{C as js}from"./chunk-CWVAJCXJ-DgVmidFC.js";import{b as Ie,c as Le,T as Es,a as Rs}from"./chunk-T2WCTPDH-Dq_zjQt4.js";import{u as Ds}from"./chunk-6RSEZNRH-wKYG4vTw.js";var ye=w(function(t,s){const i=ht("Link",t),{className:n,isExternal:o,...l}=De(t);return e.jsx(W.a,{target:o?"_blank":void 0,rel:o?"noopener":void 0,ref:s,className:ut("chakra-link",n),...l,__css:i})});ye.displayName="Link";var[Os,ze]=mt({name:"TagStylesContext",errorMessage:`useTagStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tag />" `}),te=w((r,t)=>{const s=_t("Tag",r),i=De(r),n={display:"inline-flex",verticalAlign:"top",alignItems:"center",maxWidth:"100%",...s.container};return e.jsx(Os,{value:s,children:e.jsx(W.span,{ref:t,...i,__css:n})})});te.displayName="Tag";var se=w((r,t)=>{const s=ze();return e.jsx(W.span,{ref:t,noOfLines:1,...r,__css:s.label})});se.displayName="TagLabel";var Ts=w((r,t)=>e.jsx(V,{ref:t,verticalAlign:"top",marginEnd:"0.5rem",...r}));Ts.displayName="TagLeftIcon";var bs=w((r,t)=>e.jsx(V,{ref:t,verticalAlign:"top",marginStart:"0.5rem",...r}));bs.displayName="TagRightIcon";var Pe=r=>e.jsx(V,{verticalAlign:"inherit",viewBox:"0 0 512 512",...r,children:e.jsx("path",{fill:"currentColor",d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})});Pe.displayName="TagCloseIcon";var vs=w((r,t)=>{const{isDisabled:s,children:i,...n}=r,l={display:"flex",alignItems:"center",justifyContent:"center",outline:"0",...ze().closeButton};return e.jsx(W.button,{ref:t,"aria-label":"close",...n,type:"button",disabled:s,__css:l,children:i||e.jsx(Pe,{})})});vs.displayName="TagCloseButton";const As=()=>e.jsxs(e.Fragment,{children:[e.jsx(be,{}),e.jsx(ve,{children:e.jsx(S,{width:"full",sx:{mt:8,mb:4},children:e.jsxs(G,{templateColumns:"1fr",alignItems:"center",gap:4,children:[e.jsx(R,{children:e.jsx(y,{height:"120px"})}),e.jsx(R,{children:e.jsx(y,{height:"120px"})}),e.jsx(R,{children:e.jsx(y,{height:"120px"})}),e.jsx(R,{children:e.jsx(y,{height:"120px"})}),e.jsx(R,{children:e.jsx(y,{height:"120px"})}),e.jsx(R,{children:e.jsx(y,{height:"120px"})})]})})})]});function Ss(r){return r&&typeof r=="object"&&"default"in r?r.default:r}var H=Ss(T),Cs=Object.assign||function(r){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])}return r},Is=function(r,t){var s={};for(var i in r)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i]);return s},_e=function(t){var s=t.color,i=s===void 0?"currentColor":s,n=t.size,o=n===void 0?24:n;t.children;var l=Is(t,["color","size","children"]),u="mdi-icon "+(l.className||"");return H.createElement("svg",Cs({},l,{className:u,width:o,height:o,fill:i,viewBox:"0 0 24 24"}),H.createElement("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}))},Ls=H.memo?H.memo(_e):_e,ys=Ls;const zs=ae(ys);let v;typeof window<"u"?v=window:typeof self<"u"?v=self:v=global;let re=null,ie=null;const ge=20,Y=v.clearTimeout,fe=v.setTimeout,Z=v.cancelAnimationFrame||v.mozCancelAnimationFrame||v.webkitCancelAnimationFrame,xe=v.requestAnimationFrame||v.mozRequestAnimationFrame||v.webkitRequestAnimationFrame;Z==null||xe==null?(re=Y,ie=function(t){return fe(t,ge)}):(re=function([t,s]){Z(t),Y(s)},ie=function(t){const s=xe(function(){Y(i),t()}),i=fe(function(){Z(s),t()},ge);return[s,i]});function Ps(r){let t,s,i,n,o,l,u;const g=typeof document<"u"&&document.attachEvent;if(!g){l=function(h){const _=h.__resizeTriggers__,x=_.firstElementChild,D=_.lastElementChild,A=x.firstElementChild;D.scrollLeft=D.scrollWidth,D.scrollTop=D.scrollHeight,A.style.width=x.offsetWidth+1+"px",A.style.height=x.offsetHeight+1+"px",x.scrollLeft=x.scrollWidth,x.scrollTop=x.scrollHeight},o=function(h){return h.offsetWidth!==h.__resizeLast__.width||h.offsetHeight!==h.__resizeLast__.height},u=function(h){if(h.target.className&&typeof h.target.className.indexOf=="function"&&h.target.className.indexOf("contract-trigger")<0&&h.target.className.indexOf("expand-trigger")<0)return;const _=this;l(this),this.__resizeRAF__&&re(this.__resizeRAF__),this.__resizeRAF__=ie(function(){o(_)&&(_.__resizeLast__.width=_.offsetWidth,_.__resizeLast__.height=_.offsetHeight,_.__resizeListeners__.forEach(function(A){A.call(_,h)}))})};let a=!1,c="";i="animationstart";const d="Webkit Moz O ms".split(" ");let m="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),E="";{const h=document.createElement("fakeelement");if(h.style.animationName!==void 0&&(a=!0),a===!1){for(let _=0;_<d.length;_++)if(h.style[d[_]+"AnimationName"]!==void 0){E=d[_],c="-"+E.toLowerCase()+"-",i=m[_],a=!0;break}}}s="resizeanim",t="@"+c+"keyframes "+s+" { from { opacity: 0; } to { opacity: 0; } } ",n=c+"animation: 1ms "+s+"; "}const p=function(a){if(!a.getElementById("detectElementResize")){const c=(t||"")+".resize-triggers { "+(n||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',d=a.head||a.getElementsByTagName("head")[0],m=a.createElement("style");m.id="detectElementResize",m.type="text/css",r!=null&&m.setAttribute("nonce",r),m.styleSheet?m.styleSheet.cssText=c:m.appendChild(a.createTextNode(c)),d.appendChild(m)}};return{addResizeListener:function(a,c){if(g)a.attachEvent("onresize",c);else{if(!a.__resizeTriggers__){const d=a.ownerDocument,m=v.getComputedStyle(a);m&&m.position==="static"&&(a.style.position="relative"),p(d),a.__resizeLast__={},a.__resizeListeners__=[],(a.__resizeTriggers__=d.createElement("div")).className="resize-triggers";const E=d.createElement("div");E.className="expand-trigger",E.appendChild(d.createElement("div"));const h=d.createElement("div");h.className="contract-trigger",a.__resizeTriggers__.appendChild(E),a.__resizeTriggers__.appendChild(h),a.appendChild(a.__resizeTriggers__),l(a),a.addEventListener("scroll",u,!0),i&&(a.__resizeTriggers__.__animationListener__=function(x){x.animationName===s&&l(a)},a.__resizeTriggers__.addEventListener(i,a.__resizeTriggers__.__animationListener__))}a.__resizeListeners__.push(c)}},removeResizeListener:function(a,c){if(g)a.detachEvent("onresize",c);else if(a.__resizeListeners__.splice(a.__resizeListeners__.indexOf(c),1),!a.__resizeListeners__.length){a.removeEventListener("scroll",u,!0),a.__resizeTriggers__.__animationListener__&&(a.__resizeTriggers__.removeEventListener(i,a.__resizeTriggers__.__animationListener__),a.__resizeTriggers__.__animationListener__=null);try{a.__resizeTriggers__=!a.removeChild(a.__resizeTriggers__)}catch{}}}}}class ws extends T.Component{constructor(...t){super(...t),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;const{disableHeight:s,disableWidth:i,onResize:n}=this.props;if(this._parentNode){const o=window.getComputedStyle(this._parentNode)||{},l=parseFloat(o.paddingLeft||"0"),u=parseFloat(o.paddingRight||"0"),g=parseFloat(o.paddingTop||"0"),p=parseFloat(o.paddingBottom||"0"),f=this._parentNode.getBoundingClientRect(),j=f.height-g-p,a=f.width-l-u,c=this._parentNode.offsetHeight-g-p,d=this._parentNode.offsetWidth-l-u;(!s&&(this.state.height!==c||this.state.scaledHeight!==j)||!i&&(this.state.width!==d||this.state.scaledWidth!==a))&&(this.setState({height:c,width:d,scaledHeight:j,scaledWidth:a}),typeof n=="function"&&n({height:c,scaledHeight:j,scaledWidth:a,width:d}))}},this._setRef=s=>{this._autoSizer=s}}componentDidMount(){const{nonce:t}=this.props,s=this._autoSizer?this._autoSizer.parentNode:null;if(s!=null&&s.ownerDocument&&s.ownerDocument.defaultView&&s instanceof s.ownerDocument.defaultView.HTMLElement){this._parentNode=s;const i=s.ownerDocument.defaultView.ResizeObserver;i!=null?(this._resizeObserver=new i(()=>{this._timeoutId=setTimeout(this._onResize,0)}),this._resizeObserver.observe(s)):(this._detectElementResize=Ps(t),this._detectElementResize.addResizeListener(s,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),this._timeoutId!==null&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){const{children:t,defaultHeight:s,defaultWidth:i,disableHeight:n=!1,disableWidth:o=!1,doNotBailOutOnEmptyChildren:l=!1,nonce:u,onResize:g,style:p={},tagName:f="div",...j}=this.props,{height:a,scaledHeight:c,scaledWidth:d,width:m}=this.state,E={overflow:"visible"},h={};let _=!1;return n||(a===0&&(_=!0),E.height=0,h.height=a,h.scaledHeight=c),o||(m===0&&(_=!0),E.width=0,h.width=m,h.scaledWidth=d),l&&(_=!1),T.createElement(f,{ref:this._setRef,style:{...E,...p},...j},!_&&t(h))}}const Ns=r=>{const{isDraft:t,isOpen:s,onClose:i}=r,n=T.useRef(),{state:o,retry:l}=ls(),u=()=>{const{filteredData:g,handleSearchInputChange:p}=Ae(n.current??[],["screen_name"]),f=30,j=({style:a,index:c,data:d})=>{const m=d?.[c];return m!=null?e.jsx(e.Fragment,{children:e.jsx(_s,{style:a,children:m.habilitado?e.jsx(ye,{href:z(t?Ot:Tt,{client:m.id}),children:e.jsxs(S,{children:[e.jsx(ue,{as:ds,color:"green.400"}),m.screen_name]})}):e.jsxs(S,{color:"gray.400",sx:{cursor:"not-allowed"},children:[e.jsx(ue,{as:cs,color:"red.400"}),m.screen_name]})},m.id)}):e.jsx(e.Fragment,{})};return e.jsxs(e.Fragment,{children:[e.jsx(S,{sx:{pb:4},children:e.jsx(Se,{handleSearchInputChange:p})}),e.jsx(ws,{children:({height:a,width:c})=>e.jsx(us,{height:a-60,itemCount:g.length??0,itemSize:f,innerElementType:ms,width:c,itemData:g,children:j})})]})};return e.jsxs(gt,{isCentered:!0,isOpen:s,onClose:i,scrollBehavior:"inside",size:{base:"full",sm:"md",md:"lg"},children:[e.jsx(ft,{bg:"blackAlpha.800"}),e.jsxs(xt,{sx:{maxHeight:"auto"},children:[e.jsx(pt,{children:"Seleccione el cliente"}),e.jsx(jt,{}),e.jsx(Et,{minHeight:{base:"auto",sm:"420px !important"},children:o.map({loading:g=>e.jsxs(gs,{spacing:4,children:[e.jsx(le,{width:"full",height:"36px",borderRadius:"md"}),e.jsx(le,{width:"full",height:"250px",borderRadius:"md"})]}),error:({error:g})=>e.jsx(Te,{error:g,retry:l,cancelAndNavigateTo:Rt}),success:g=>(n.current=Dt.sortBy(g.data,["screen_name"]),e.jsx(u,{}))})})]})]})},ne="setUnsetSelectedPedido",Fs=({isDraft:r,pedidos:t,stateRenglones:s,handleSearchInputChange:i})=>{const n=Ce(),[o,l]=T.useState(!1),{isOpen:u,onOpen:g,onClose:p}=qt(),[f,j]=T.useState([]);T.useRef({pedidos:[],renglones:{}}),T.useEffect(()=>{const E=({id:h,checked:_})=>{j(_?x=>[...x,h]:x=>x.filter(D=>D!==h))};return P.on(ne,E),()=>{P.removeListener(ne,E)}},[]);const a=()=>{if(n.authState.isCustomer()){n.navigate(r?St:Ct);return}l(!0),g()},c=()=>{p(),l(!1)},d=()=>{Array.isArray(f)&&window.open(`${It}?orderId=${f.join("&orderId=")}`,"OrderPrintWindow","width=800,height=600")},m=f.length<=0?void 0:f.length==1?`1 ${rs}`:`${f.length} ${is}`;return e.jsxs(e.Fragment,{children:[e.jsxs(ee,{flex:1,alignItems:"center",justifyContent:"space-between",sx:{mx:4},children:[e.jsxs(me,{spacing:{base:2,sm:3},alignItems:"center",children:[(n.authState.isSeller()||n.authState.isCustomer())&&e.jsx(e.Fragment,{children:e.jsx(de,{icon:zs,text:r?bt:vt,sharedProps:{size:"sm",fontWeight:"400",colorScheme:r?"green":"orange",onClick:()=>{a()},isDisabled:!r&&!n.authState.userInfo.puede_crear_pedido},iconProps:{boxSize:{base:5,md:4}}})}),!r&&e.jsx(de,{icon:Jt,text:At,sharedProps:{size:"sm",fontWeight:"400",colorScheme:"blue",onClick:()=>d(),isDisabled:f.length<=0},iconProps:{boxSize:{base:5,md:4}}}),m!=null&&e.jsxs(e.Fragment,{children:[e.jsx(te,{display:{base:"none",sm:"inherited"},height:8,borderRadius:40,size:"md",variant:"solid",colorScheme:"blue",children:e.jsx(se,{marginX:1,children:m})}),e.jsx(te,{display:{base:"inherited",sm:"none"},height:8,borderRadius:40,size:"md",variant:"solid",colorScheme:"blue",children:e.jsx(se,{marginX:1,children:f.length})})]})]}),e.jsx(ee,{alignItems:"center",marginLeft:4,children:e.jsx(me,{spacing:{base:2,md:4},children:e.jsx(S,{children:e.jsx(Se,{handleSearchInputChange:i})})})})]}),o&&e.jsx(Ns,{isDraft:r,isOpen:u,onClose:c})]})};function ks(r){return r&&typeof r=="object"&&"default"in r?r.default:r}var U=ks(T),Ms=Object.assign||function(r){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])}return r},Bs=function(r,t){var s={};for(var i in r)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i]);return s},pe=function(t){var s=t.color,i=s===void 0?"currentColor":s,n=t.size,o=n===void 0?24:n;t.children;var l=Bs(t,["color","size","children"]),u="mdi-icon "+(l.className||"");return U.createElement("svg",Ms({},l,{className:u,width:o,height:o,fill:i,viewBox:"0 0 24 24"}),U.createElement("path",{d:"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"}))},Hs=U.memo?U.memo(pe):pe,Us=Hs;const $s=ae(Us);function Ws(r,t){return t.isSuccess()?Qt(r,t.data[r.id]):r.estado}function we(r,t){let s;switch(r){case C.INGRESADO:s="blue";break;case C.APROBADO:s="purple";break;case C.CUMPLIDO:s="green";break;case C.CERRADO:s="black";break;case C.ANULADO:s="red";break;default:s="gray"}return t==null?s:`${s}${t}`}function Vs(r){return r&&typeof r=="object"&&"default"in r?r.default:r}var $=Vs(T),Gs=Object.assign||function(r){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])}return r},qs=function(r,t){var s={};for(var i in r)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i]);return s},je=function(t){var s=t.color,i=s===void 0?"currentColor":s,n=t.size,o=n===void 0?24:n;t.children;var l=qs(t,["color","size","children"]),u="mdi-icon "+(l.className||"");return $.createElement("svg",Gs({},l,{className:u,width:o,height:o,fill:i,viewBox:"0 0 24 24"}),$.createElement("path",{d:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"}))},Ks=$.memo?$.memo(je):je,Xs=Ks;const Ys=ae(Xs),Zs=({app:r,isDraft:t,pedido:s,onDelete:i,onMarkAsFavorite:n})=>{const o=r.authState.userInfo,l=r.authState.isAdmin(),u=t&&s.es_favorito,g=!l&&(t||o.puede_crear_pedido),p=!l&&t&&o.puede_crear_pedido,f=!l&&!t,j=!l&&(t||o.puede_editar_pedido&&es(o,s.estado)),a=!u&&(t||ce(o,s.estado)),c=t||o.borrar_pedido_al_anular;return e.jsxs(fs,{isLazy:!0,id:"menu",children:[e.jsx(Vt,{as:xs,size:"sm","aria-label":ns,icon:e.jsx(Ys,{}),variant:"outline",colorScheme:"white"}),e.jsx(Lt,{children:e.jsxs(Gt,{rootProps:{zIndex:2e3},children:[j&&e.jsx(I,{onClick:()=>{r.navigate(z(t?yt:zt,{id:s.id}))},children:Ne}),g&&e.jsx(I,{onClick:()=>{r.navigate(z(t?Pt:wt,{id:s.id}))},children:Fe}),p&&e.jsx(I,{onClick:()=>{r.navigate(z(Nt,{id:s.id}))},children:u?ke:Me}),f&&e.jsx(I,{onClick:()=>{r.navigate(z(Ft,{id:s.id}))},children:Be}),t&&!u&&e.jsxs(e.Fragment,{children:[p&&e.jsx(I,{onClick:()=>{r.navigate(z(kt,{id:s.id}))},children:He}),e.jsx(X,{}),e.jsx(I,{onClick:()=>n(s.id,!0),children:Ue})]}),u&&e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsx(I,{onClick:()=>n(s.id,!1),children:$e})]}),(t||ce(o,s.estado))&&e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsx(I,{onClick:()=>i(s.id),isDisabled:u||!a,children:u?We:c?Ve:Ge})]})]})})]})},Js=()=>e.jsxs(F,{status:"warning",children:[e.jsx(oe,{}),e.jsx(k,{children:"El pedido no cuenta con productos."})]}),Qs=()=>e.jsxs(F,{status:"error",children:[e.jsx(oe,{}),e.jsx(k,{children:"Ocurrió un error al cargar los detalles del pedido."})]}),er=()=>e.jsx(S,{width:"full",sx:{mt:8,mb:4},children:e.jsxs(G,{templateColumns:"1fr",alignItems:"center",gap:2,children:[e.jsx(R,{children:e.jsx(M,{height:"20px"})}),e.jsx(R,{children:e.jsx(M,{height:"20px"})}),e.jsx(R,{children:e.jsx(M,{height:"20px"})}),e.jsx(R,{children:e.jsx(M,{height:"20px"})})]})}),tr=({pedido:r,renglones:t,esCliente:s})=>{const i=Q("var(--chakra-colors-gray-200)","var(--chakra-colors-black)"),n=Q("var(--chakra-colors-gray-400)","var(--chakra-colors-black)"),{numero_pedido:o,descuento:l}=r,u=l>0||!s;return e.jsxs("table",{width:"100%",cellPadding:8,cellSpacing:4,style:{fontSize:"0.8rem",border:`1px solid ${n}`},children:[e.jsx("thead",{style:{backgroundColor:`${i}`,textTransform:"uppercase"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left",style:{width:u?"60%":"70%"},children:"Artículo"}),e.jsx("th",{className:"text-right hidden-on-base",style:{width:"10%"},children:"Precio"}),u&&e.jsx("th",{className:"text-right",style:{width:"10%"},children:"Bonificado"}),e.jsx("th",{className:"text-center",style:{width:"10%"},children:"Cantidad"}),e.jsx("th",{className:"text-right",style:{width:"10%"},children:"Subtotal"})]})}),e.jsx("tbody",{children:t.map(({id_articulo:g,nombre_articulo:p,codigo_articulo:f,descripcion_adicional:j,precio:a,cantidad:c,subtotal:d,es_precio_especial:m},E)=>{const h=qe(a,l),_=h*c;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(L,{children:Ke(p,f,j)})}),e.jsx("td",{className:"text-right hidden-on-base",children:m&&a!=null?"Especial":e.jsx(N,{precio:a,moneda:"$"})}),u&&e.jsx("td",{className:"text-right",children:e.jsx(N,{precio:h,moneda:"$"})}),e.jsx("td",{children:e.jsx(B,{textAlign:"center",children:c})}),e.jsx("td",{className:"text-right",children:e.jsx(N,{precio:_,moneda:"$"})})]},`details-${o}-${E}`)})})]})},sr=({wasOpen:r,pedido:t,stateRenglones:s,esCliente:i})=>e.jsx(S,{sx:{mt:6},children:r&&s.map({loading:n=>e.jsx(er,{}),error:n=>e.jsx(Qs,{}),success:n=>{const{id:o}=t,l=n.data?.[o];return Array.isArray(l)?e.jsx(tr,{pedido:t,renglones:l,esCliente:i}):e.jsx(Js,{})}})}),rr=({estado:r})=>{const t=ts(r),s=we(r);return e.jsx(ps,{fontSize:"1em",variant:"solid",colorScheme:s,lineHeight:"1.5em",children:t})},ir=r=>{const{app:t,pedido:s,total:i,estado:n,handleToggleDetails:o}=r,{numero_pedido:l,fecha_hora_ingreso:u,fecha_entrega:g,codigo_cliente:p,codigo_vendedor:f,codigo_transporte:j,nombre_cliente:a,nombre_vendedor:c,nombre_transporte:d,descuento:m,comentarios:E,sin_iva:h,sin_ii:_}=s,x=t.authState.isSeller(),D=t.authState.isCustomer(),A=E!=null&&E.length>0;return e.jsxs(G,{templateColumns:{base:"repeat(2, 1fr)",lg:"repeat(4, 1fr)"},gap:6,sx:{cursor:"pointer"},onClick:()=>{o()},children:[e.jsxs(R,{children:[e.jsx(O,{size:"sm",children:"Pedido"}),e.jsx(B,{children:l})]}),e.jsxs(R,{children:[e.jsx(O,{size:"sm",children:"Estado"}),e.jsx(rr,{estado:n})]}),e.jsxs(R,{children:[e.jsx(O,{size:"sm",children:"Ingreso"}),e.jsx(B,{children:Mt(u)})]}),e.jsxs(R,{children:[e.jsx(O,{size:"sm",children:"Entrega"}),e.jsx(B,{children:Bt(g)})]}),!D&&e.jsxs(R,{...x?{colSpan:{base:1,lg:2}}:void 0,children:[e.jsxs(O,{size:"sm",children:["Cliente ",p]}),e.jsx(L,{children:a})]}),!x&&!D&&e.jsxs(R,{children:[e.jsxs(O,{size:"sm",children:["Vendedor ",f]}),e.jsx(L,{children:c})]}),e.jsxs(R,{...D?{colSpan:{base:1,lg:3}}:void 0,...x?{colSpan:{base:1,lg:1}}:void 0,children:[e.jsxs(O,{size:"sm",children:["Transporte ",j]}),e.jsx(L,{children:d})]}),e.jsxs(R,{...x?{colSpan:{base:2,lg:1}}:void 0,children:[e.jsxs(O,{size:"sm",sx:{textTransform:"uppercase",color:n===C.APROBADO&&"green.400",whiteSpace:"normal"},children:["Total ",m>0&&e.jsx(e.Fragment,{children:` -${m}%`}),e.jsxs("span",{style:{fontSize:"small"},children:[" ",`(${Re(h,_)})`]})]}),e.jsx(O,{size:"sm",sx:{fontWeight:"bolder",color:n===C.APROBADO&&"green.400"},children:i!=null&&e.jsx(N,{precio:i,moneda:"$"})})]}),A&&e.jsx(R,{colSpan:{base:2,lg:4},children:e.jsx(F,{status:"info",children:e.jsx(k,{dangerouslySetInnerHTML:{__html:Oe(E)},sx:{whiteSpace:"normal"}})})})]})},nr=r=>{const{app:t,pedido:s,estado:i,total:n,handleToggleDetails:o}=r,{codigo_cliente:l,codigo_vendedor:u,codigo_transporte:g,nombre_cliente:p,nombre_vendedor:f,nombre_transporte:j,descuento:a,comentarios:c,descripcion:d,es_favorito:m,sin_iva:E,sin_ii:h}=s,_=t.authState.isSeller(),x=t.authState.isCustomer(),D=c!=null&&c.length>0,A={base:_||x?1:2,md:_?2:x?1:2,lg:_?3:x?2:4},b={base:_||x?"repeat(1, 1fr)":"repeat(2, 1fr)",md:_?"repeat(2, 1fr)":x?"repeat(1, 1fr)":"repeat(2, 1fr)",lg:_?"repeat(3, 1fr)":x?"repeat(2, 1fr)":"repeat(4, 1fr)"};return e.jsxs(G,{templateColumns:b,gap:6,sx:{cursor:"pointer"},onClick:()=>{o()},children:[e.jsx(R,{colSpan:A,children:e.jsx(O,{size:"md",textTransform:"uppercase",children:d})}),!x&&e.jsxs(R,{children:[e.jsxs(O,{size:"sm",children:["Cliente ",l]}),e.jsx(L,{children:p})]}),!_&&!x&&e.jsxs(R,{children:[e.jsxs(O,{size:"sm",children:["Vendedor ",u]}),e.jsx(L,{children:f})]}),e.jsxs(R,{children:[e.jsxs(O,{size:"sm",children:["Transporte ",g]}),e.jsx(L,{children:j})]}),e.jsxs(R,{children:[e.jsxs(O,{size:"sm",sx:{textTransform:"uppercase",color:i===C.APROBADO&&"green.400",whiteSpace:"normal"},children:["Total ",a>0&&e.jsx(e.Fragment,{children:` -${a}%`}),e.jsxs("span",{style:{fontSize:"small"},children:[" ",`(${Re(E,h)})`]})]}),e.jsx(O,{size:"sm",sx:{fontWeight:"bolder",color:i===C.APROBADO&&"green.400"},children:n!=null&&e.jsx(N,{precio:n,moneda:"$"})})]}),D&&e.jsx(R,{colSpan:A,children:e.jsx(F,{status:"info",children:e.jsx(k,{dangerouslySetInnerHTML:{__html:Oe(c)},sx:{whiteSpace:"normal"}})})})]})};function ar(r,t){return t.isSuccess()?ss(r,t.data[r.id]):null}const J="togglePedidoDetails",or=({index:r,app:t,draft:s,pedido:i,stateRenglones:n,handleDelete:o,handleMarkAsFavorite:l,isHidden:u})=>{const[g,p]=T.useState(!1),[f,j]=T.useState(!1),a=Q("gray.800","white"),c=T.useRef(!1),d=Ws(i,n),m=i.total!=null?i.total:ar(i,n),E=T.useMemo(()=>e.jsx(sr,{wasOpen:c.current,pedido:i,stateRenglones:n,esCliente:t.authState.isCustomer()}),[c.current,n.constructor.name]),h=()=>{const b=!g;b&&(c.current=!0),p(b),P.emit(J,{id:i.id})},_=(b,q)=>{j(!!b),P.emit(ne,{id:q,checked:b})};T.useEffect(()=>{const b=({id:q})=>{i.id!==q&&p(!1)};return P.on(J,b),()=>{P.removeListener(J,b)}},[]);const{id:x,es_favorito:D}=i,A=s&&D;return e.jsx(Ie,{sx:{...u&&!f&&{display:"none"}},children:e.jsxs(Le,{sx:{py:6,position:"relative",borderTopWidth:s?void 0:{base:"3px",md:"4px"},borderTopStyle:s?void 0:"solid",borderTopColor:s?void 0:we(d,".500 !important"),borderWidth:s?{base:"2px",md:"3px"}:void 0,borderStyle:s?"dashed":void 0,borderColor:s?D?"orange.500 !important":"blue.500 !important":void 0},children:[e.jsxs(S,{display:"flex",sx:{position:"absolute",right:2,top:5},flexDirection:"column",children:[e.jsx(Zs,{app:t,isDraft:s,pedido:i,onDelete:o,onMarkAsFavorite:l}),A&&e.jsx(ee,{backgroundColor:"orange",justifyContent:"center",alignItems:"center",sx:{mt:2,borderRadius:4,aspectRatio:1},children:e.jsx(V,{as:$s,boxSize:4,color:"white"})}),!s&&e.jsx(js,{size:"xl",colorScheme:"blue",sx:{mt:2,borderWidth:0,borderColor:a},onChange:b=>{_(b.target.checked,x)}})]}),s?e.jsx(nr,{app:t,pedido:i,estado:d,total:m,handleToggleDetails:h}):e.jsx(ir,{app:t,pedido:i,estado:d,total:m,handleToggleDetails:h}),e.jsx(S,{children:e.jsx(S,{sx:{display:g?"block":"none"},children:E})},`pedido-details-${r}`)]})})};function lr(r){const t=Ce(),i=t.authState.userInfo.borrar_pedido_al_anular.valueOf(),{draft:n,unfilteredPedidos:o,filteredPedidos:l,isFiltering:u,stateRenglones:g,reloadData:p}=r,f=Ds(),j=hs(),a=async d=>{if(await j({title:n?Ye:i?Ze:Je,message:n?Qe:i?et:tt})==he.accept){const E=n?await Kt(d,t):await Xt(d,t);E.map({success:h=>{f({title:n?st:i?rt:it,status:"success"})},error:h=>{f({title:h.errorInfoOrNull()?.error_description??Ut,status:"error"})}}),E.isSuccess()&&await p()}},c=async(d,m)=>{if(m){(await Yt(d,t)).isSuccess()&&await p();return}await j({title:nt,message:at})==he.accept&&(await Zt(d,t)).isSuccess()&&await p()};return e.jsx(Xe,{sx:{p:0,m:0},children:e.jsx(Es,{variant:"stripedOverCard",colorScheme:"gray",size:"md",sx:{borderCollapse:"separate",borderSpacing:"0 1rem"},children:e.jsxs(Rs,{children:[o.map((d,m)=>e.jsx(or,{index:m,draft:n,app:t,pedido:d,stateRenglones:g,handleDelete:a,handleMarkAsFavorite:c,isHidden:u&&!l.includes(d)},`pedido-${d.id}`)),!l.length&&e.jsx(Ie,{children:e.jsx(Le,{children:e.jsxs(F,{status:"info",children:[e.jsx(oe,{}),e.jsx(k,{children:u?Ht:n?as:os})]})})})]})})})}const cr=r=>{const{showDrafts:t,pedidos:s,reloadData:i}=r,n=$t().state.userOrThrow(),o=n.role==K.admin;n.role==K.seller;const l=n.role==K.customer,{filteredData:u,handleSearchInputChange:g,isFiltering:p}=Ae(s,["descripcion","comentarios",...t?[]:["numero_pedido"],...l?[]:["codigo_cliente","nombre_cliente"],...o?["codigo_vendedor","nombre_vendedor"]:[]]),{state:f}=Ee({...t?ot:lt,silent:!0,transformResponse:j=>(Object.values(j).forEach(a=>{Array.isArray(a)&&a.sort((c,d)=>c.renglon-d.renglon)}),j)});return e.jsxs(e.Fragment,{children:[e.jsx(be,{children:e.jsx(Fs,{isDraft:t,pedidos:s,stateRenglones:f,handleSearchInputChange:g})}),e.jsx(ve,{children:e.jsx(lr,{draft:t,stateRenglones:f,unfilteredPedidos:s,filteredPedidos:u,isFiltering:p,reloadData:i})})]})},Wr=r=>{const t=r.showDrafts===!0,{state:s,retry:i,reload:n}=Ee({...t?ct:dt,silent:!0});return s.map({loading:o=>e.jsx(As,{}),error:({error:o})=>e.jsx(Te,{error:o,retry:i,cancelAndNavigateTo:Wt}),success:o=>{const l=t?o.data.sort(dr):o.data.sort(hr);return e.jsx(cr,{showDrafts:t,pedidos:l,reloadData:n})}})};function dr(r,t){const s=r.es_favorito?1:0,i=t.es_favorito?1:0,n=s-i;if(n!=0)return n;const o=new Date(r.fecha_hora_ingreso).getTime();return new Date(t.fecha_hora_ingreso).getTime()-o}function hr(r,t){const s=r.estado-t.estado;if(s!=0)return s;const i=r.numero_pedido,n=t.numero_pedido;return i.localeCompare(n)}export{Wr as O};
