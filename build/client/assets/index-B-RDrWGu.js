import{r as v,j as e}from"./emotion-element-43c6fea0.browser.esm-Bukkp3pI.js";import{a as H,o as q}from"./yup-DmufeRdH.js";import{F as D,a as w,b as I}from"./useDXTApiFetch-DMZ_pwG5.js";import{c as X,D as $,A as W}from"./validation-EHFBNvNt.js";import{a as J,b as K}from"./app_resources-0MHmsA5u.js";import{u as Q}from"./useTangoList-BH5N6yVu.js";import{a as Y,b as Z}from"./app-ChKZjo6p.js";import{_ as ee,R as re}from"./auth_context-By8qlCOz.js";import{C as b}from"./CommonCard-B6Zs7VdS.js";import{C as P}from"./ControlledInput-Bfe1Y7Kq.js";import{C as se,a as t}from"./ControlledSwitch-nuCNmcKM.js";import{C as E}from"./ControlledSelect-C5AbekiF.js";import{F as oe}from"./FormErrors-DK3bqFxa.js";import{d as ae,V as te,P as ie}from"./vo_dxt_password-B_Q-LXlx.js";import{I as R}from"./InlineError-DcRSvLUF.js";import{S as ne}from"./SettingsFormButtons-Dtw3fGC3.js";import{y as le}from"./utils-DihYaFf6.js";import{c as de,a as pe}from"./index.esm-DLycO5Xl.js";import{G as T,a as r}from"./chunk-ZPFGWTBB-C6BSXP9K.js";import{H as x}from"./chunk-7OLJDQMT-DeTsz2JD.js";import{D as h}from"./chunk-W7WUSNWJ-D1ck6ov6.js";import{S as ce}from"./chunk-ZHMYA64R-DxFJ4KrV.js";import{H as n}from"./chunk-3ASUQ6PA-CMDtM4Gu.js";const me=()=>{const[l,a]=v.useState(null),p=de({password:pe().required("Ingrese una contraseña").test("password","Formato de contraseña no válido",i=>{if(i!=""&&i!=null){let c=ae(i);return ee.isEqual(l,c)||a(c),le(te,i)}return!0})}).required();return{yupValidationSchema:X.concat(p),passwordStatus:l}},ue=l=>{var C,S;const{typeSettings:a,returnUrl:p,title:m}=l,i=J(),c=K(),{yupValidationSchema:y,passwordStatus:F}=me(),{state:u,result:V}=Q({endpoint:W,fieldsMap:{label:"name",value:"id"}}),{state:f,result:A}=a.api.useGetRelation(),{handleSubmit:O,control:o,setError:L,resetField:U,watch:G,formState:{errors:N,isSubmitting:z,isSubmitSuccessful:M}}=H({defaultValues:{username:"",password:"",email:"",tango_id:0,perfil_facturacion_id:0,habilitado_en_dxt:!0,puede_crear_pedido:!0,puede_editar_pedido:!0,ver_pedidos_cumplidos:!0,ver_sin_precio:!1,mostrar_mensaje_de_advertencia:!1,puede_anular_pedido:!1,borrar_pedido_al_anular:!1,aprobar_pedido_al_crear:!1,dia_de_entrega:$},resolver:q(y)}),_=G("puede_anular_pedido");v.useEffect(()=>{_===!1&&U("borrar_pedido_al_anular",{defaultValue:!1})},[_]);const s=M||z,k=async j=>{const{...d}=j;d.email===""&&delete d.email;const B=d;(await a.api.post(B,i)).map({success:g=>{c({title:Z,status:"success"}),i.navigate(p)},error:g=>{c({title:re,status:"error"}),L("root",{message:g.info.error_description})}})};return e.jsx("form",{noValidate:!0,onSubmit:O(k),children:e.jsxs(Y,{children:[e.jsx(oe,{errors:N}),e.jsx(b,{children:e.jsxs(T,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(r,{colSpan:{md:2},children:e.jsx(x,{size:"sm",textTransform:"uppercase",children:m})}),e.jsxs(r,{colSpan:{md:2},children:[e.jsx(E,{fieldProps:{name:"tango_id",placeholder:(C=a.tangoRelatedFields)==null?void 0:C.placeholder,options:A,noOptionsMessage(j){var d;return(d=a.tangoRelatedFields)==null?void 0:d.empty},isSearchable:!0,selectedOptionStyle:"check",isLoading:f instanceof D,virtualized:!0},formControlProps:{isDisabled:s||!(f instanceof w)},formControlInnerProps:{label:(S=a.tangoRelatedFields)==null?void 0:S.label},control:o}),f instanceof I&&e.jsx(R,{error:f.errorOrNull().error})]}),e.jsx(r,{children:e.jsx(P,{fieldProps:{name:"username",id:"username",type:"text"},formControlProps:{isDisabled:s},formControlInnerProps:{label:"Nombre de Usuario"},control:o})}),e.jsx(r,{children:e.jsx(ie,{fieldProps:{name:"password",id:"password"},formControlInnerProps:{label:"Contraseña"},passwordStatus:F,disableForm:s,control:o})}),e.jsx(r,{children:e.jsx(P,{fieldProps:{name:"email",id:"email",type:"text",inputMode:"email"},formControlProps:{isDisabled:s},formControlInnerProps:{label:"Correo electrónico"},control:o})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(h,{})}),e.jsxs(r,{colSpan:{md:2},children:[e.jsx(E,{fieldProps:{name:"perfil_facturacion_id",placeholder:"Seleccione un perfil",options:V,noOptionsMessage(j){return"No hay perfiles disponibles"},isLoading:u instanceof D,selectedOptionStyle:"check"},formControlProps:{isDisabled:s||!(u instanceof w)},formControlInnerProps:{label:"Perfil de facturación"},control:o}),u instanceof I&&e.jsx(R,{error:u.errorOrNull().error})]}),e.jsx(r,{colSpan:{md:2},children:e.jsx(h,{})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(x,{size:"sm",textTransform:"uppercase",children:"Estado"})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(se,{fieldProps:{name:"habilitado_en_dxt",options:[{value:!0,label:"Establecido en Tango"},{value:!1,label:"Deshabilitado"}]},formControlProps:{isDisabled:s},radioProps:{size:{base:"sm",sm:"md"}},control:o})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(h,{})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(x,{size:"sm",textTransform:"uppercase",children:"Comunicación"})}),e.jsx(r,{children:e.jsx(t,{fieldProps:{name:"mostrar_mensaje_de_advertencia",id:"mostrar_mensaje_de_advertencia"},formControlProps:{width:"auto",isDisabled:s},formControlInnerProps:{label:"Mostrar mensaje de advertencia"},control:o})})]})}),e.jsx(b,{children:e.jsxs(T,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(r,{colSpan:{md:2},children:e.jsx(x,{size:"sm",textTransform:"uppercase",children:"Pedidos"})}),e.jsx(r,{colSpan:{md:2},children:e.jsxs(ce,{spacing:4,direction:{base:"column"},children:[e.jsx(n,{spacing:4,children:e.jsx(t,{fieldProps:{name:"puede_crear_pedido",id:"puede_crear_pedido"},formControlProps:{width:"auto",isDisabled:s},formControlInnerProps:{label:"Puede crear pedidos"},control:o})}),e.jsx(n,{spacing:4,children:e.jsx(t,{fieldProps:{name:"puede_editar_pedido",id:"puede_editar_pedido"},formControlProps:{width:"auto",isDisabled:s},formControlInnerProps:{label:"Puede editar pedidos"},control:o})}),e.jsx(n,{spacing:4,children:e.jsx(t,{fieldProps:{name:"puede_anular_pedido",id:"puede_anular_pedido"},formControlProps:{width:"auto",isDisabled:s},formControlInnerProps:{label:"Puede anular pedidos"},control:o})}),e.jsx(n,{spacing:4,children:e.jsx(t,{fieldProps:{name:"borrar_pedido_al_anular",id:"borrar_pedido_al_anular"},formControlProps:{width:"auto",isDisabled:s},formControlInnerProps:{label:"Borrar pedido al anular"},control:o,watch:{isDisabled:_===!1,..._===!1&&{isChecked:!1}}})}),e.jsx(n,{spacing:4,children:e.jsx(t,{fieldProps:{name:"aprobar_pedido_al_crear",id:"aprobar_pedido_al_crear"},formControlProps:{width:"auto",isDisabled:s},formControlInnerProps:{label:"Los pedidos se aprueban al crearlos"},control:o})}),e.jsx(n,{spacing:4,children:e.jsx(t,{fieldProps:{name:"ver_pedidos_cumplidos",id:"ver_pedidos_cumplidos"},formControlProps:{width:"auto",isDisabled:s},formControlInnerProps:{label:"Puede ver los pedidos cumplidos"},control:o})}),e.jsx(n,{spacing:4,children:e.jsx(t,{fieldProps:{name:"ver_sin_precio",id:"ver_sin_precio"},formControlProps:{width:"auto",isDisabled:s},formControlInnerProps:{label:"Puede ver artículos sin precio"},control:o})})]})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(h,{})}),e.jsx(r,{children:e.jsx(P,{fieldProps:{name:"dia_de_entrega",id:"dia_de_entrega",type:"number",inputMode:"tel"},formControlProps:{isDisabled:s},formControlInnerProps:{label:"Tiempo de entrega de pedidos",helperText:"Expresado en días"},control:o})}),e.jsx(r,{})]})}),e.jsx(b,{children:e.jsx(ne,{buttonActionText:"Guardar",isLoading:s,hideCancelButton:!0})})]})})},Ge=l=>{const{typeSettings:a,returnUrl:p,title:m}=l;return e.jsx(ue,{typeSettings:a,returnUrl:p,title:m})};export{Ge as D};
