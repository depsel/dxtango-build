const __vite__fileDeps=["assets/PrintModal.client-DlexSPx1.js","assets/emotion-element-43c6fea0.browser.esm-Bukkp3pI.js","assets/auth_context-D8ug2Qcd.js","assets/index.esm-DZ5Rht_2.js","assets/select-rNofBLKa.js","assets/chunk-56K2BSAJ-8vSmiqh4.js","assets/app-B420985G.js","assets/app_resources-CEgZe0CK.js","assets/chunk-3Y4YXCR2-K1dpGGRN.js","assets/chunk-QURMB2UJ-CfPn0lni.js","assets/chunk-3KCBMPN5-C6G4MaXF.js","assets/chunk-ZHMYA64R-D24w8AgT.js","assets/chunk-6QYXN73V-BQTiQyuX.js","assets/chunk-W7WUSNWJ-DDHZDhn1.js","assets/chunk-HB6KBUMZ-B8DBlAPS.js","assets/useDXTApiFetch-BjHmfZbr.js","assets/paths-Cp9jAs9D.js","assets/ApiErrors-DeZcFLHr.js","assets/chunk-3ASUQ6PA-BAcdPhwD.js","assets/chunk-2OOHT3W5-B6Vi5BjQ.js","assets/chunk-7OLJDQMT-W4l9hI3h.js","assets/chunk-KRPLQIP4-Cm2LXMK6.js","assets/pedidos-B6DIYHPv.js","assets/chunk-5MKCW436-B32KkSB4.js","assets/FormSkeletons-D_WNCpXW.js","assets/Navbar-CA3F-e3V.js","assets/ColorModeSelector-CJRct6HX.js","assets/chunk-BL2ZZSHG-BUdH9WQK.js","assets/chunk-ZPFGWTBB-qFhw8OhE.js","assets/SearchField-CFxZBq2H.js","assets/chunk-2ZHRCML3-DqPZ_H3Z.js","assets/chunk-6CVSDS6C-ClQyf_Ch.js","assets/AccountCancelIcon-BwrrLNSn.js","assets/TextWordBreak-DSr4qhOr.js","assets/chunk-46CXQZ4E-CsbUyZmS.js","assets/chunk-NTCQBYKE-DltSH_Ws.js","assets/vo_user_name-BxAuo4rt.js","assets/chunk-Z6RXEUPO-I6sIG1fJ.js","assets/chunk-CWVAJCXJ-D2F6Xv32.js","assets/chunk-7D6N5TE5-DSLyEd9l.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{j as e,r as D,o as ge}from"./emotion-element-43c6fea0.browser.esm-Bukkp3pI.js";import{u as ke}from"./useDXTApiFetch-BjHmfZbr.js";import{O as Be,e as U,P as mt,a as _t,b as ft,c as pt,d as gt,f as xt,g as Ot,h as Et,i as vt,j as jt,k as Dt,l as At,m as Rt,n as bt,o as Tt,T as Re,p as Ct,q as Pt,r as St,s as It,t as wt,u as yt,v as Lt,w as zt,x as Nt,y as Ft,z as Ut,A as Ht,B as kt,C as Bt,D as Mt,E as Vt}from"./pedidos-B6DIYHPv.js";import{P as xe,aZ as Me,a_ as W,a9 as $t,f as z,u as Wt,o as Ve,c as V,d as $e,h as Gt,i as qt,I as Oe,aD as We,aF as Ge,aE as qe,aG as Xe,a$ as Ye,aH as Ze,U as Xt,_ as Ke,aO as B,b0 as Yt,b1 as Zt,b2 as Kt,b3 as Qt,b4 as Jt,b5 as es,b6 as ts,aU as A,b7 as ee,b8 as Ee,b9 as ss,ba as rs,bb as ns,V as ce,bc as be,bd as S,be as G,D as is,ao as as,l as os,bf as ls,bg as cs,am as ds,bh as hs,bi as us,bj as ms,bk as _s,bl as fs,bm as ps,bn as gs,e as xs,bo as Te,aN as Os,Q as Es,Z as vs,aV as js}from"./auth_context-D8ug2Qcd.js";import{S as Ce,A as Qe}from"./ApiErrors-DeZcFLHr.js";import{F as L,a as F}from"./FormSkeletons-D_WNCpXW.js";import{N as Je,M as Ds,a as As,b as k,c as Rs}from"./Navbar-CA3F-e3V.js";import{a as I,E as bs,F as Ts,O as Cs,G as Ps,H as Ss}from"./app-B420985G.js";import{G as M,a as p}from"./chunk-ZPFGWTBB-qFhw8OhE.js";import{a as et,S as tt,u as ue}from"./SearchField-CFxZBq2H.js";import{u as st,R as Pe,a as Is}from"./app_resources-CEgZe0CK.js";import{i as ws,A as ys}from"./AccountCancelIcon-BwrrLNSn.js";import{A as Ls,T as rt,a as zs,b as Z,c as Ns,d as nt,e as ve,f as q,D as Fs}from"./TextWordBreak-DSr4qhOr.js";import{F as Us}from"./index.esm-DZ5Rht_2.js";import{a as Hs,L as ks,b as Se}from"./chunk-46CXQZ4E-CsbUyZmS.js";import{V as it}from"./chunk-NTCQBYKE-DltSH_Ws.js";import{F as Ie}from"./chunk-KRPLQIP4-Cm2LXMK6.js";import{H as we}from"./chunk-3ASUQ6PA-BAcdPhwD.js";import{V as Bs}from"./vo_user_name-BxAuo4rt.js";import{B as Ms}from"./chunk-Z6RXEUPO-I6sIG1fJ.js";import{f as Vs}from"./chunk-HB6KBUMZ-B8DBlAPS.js";import{I as $s}from"./chunk-6QYXN73V-BQTiQyuX.js";import{A as te}from"./chunk-3KCBMPN5-C6G4MaXF.js";import{A as se,a as re}from"./chunk-QURMB2UJ-CfPn0lni.js";import{H as R}from"./chunk-7OLJDQMT-W4l9hI3h.js";import{T as X}from"./chunk-2OOHT3W5-B6Vi5BjQ.js";import{C as Ws}from"./chunk-CWVAJCXJ-D2F6Xv32.js";class Gs extends xe{throwInvalidAddressError(s){this.throwError(s,"Invalid email address")}validate(s){if(typeof s=="string"){const r=s.trim().toLowerCase();if(Me.isEmail(r,{domain_specific_validation:!0}))return r}this.throwError(s)}}class je extends xe{constructor(s){W.isBuffer(s)&&(s=s.toString("hex")),super(s)}validate(s){let r;if(W.isBuffer(s)&&(r=s.toString("hex")),typeof s=="string"&&(r=s.trim().toLowerCase()),typeof r=="string"&&Me.isMD5(r))return r;this.throwError(s)}toBuffer(){return W.from(this.value,"hex")}static random(){const s=Array(16);for(let r=0;r<s.length;r++)s[r]=$t(0,255);return new je(W.from(s))}}var at=z(function(s,r){const n=Wt("Link",s),{className:i,isExternal:o,...l}=Ve(s);return e.jsx(V.a,{target:o?"_blank":void 0,rel:o?"noopener":void 0,ref:r,className:$e("chakra-link",i),...l,__css:n})});at.displayName="Link";var ot=z((t,s)=>{var r;const{overflow:n,overflowX:i,className:o,...l}=t;return e.jsx(V.div,{ref:s,className:$e("chakra-table__container",o),...l,__css:{display:"block",whiteSpace:"nowrap",WebkitOverflowScrolling:"touch",overflowX:(r=n??i)!=null?r:"auto",overflowY:"hidden",maxWidth:"100%"}})}),[qs,lt]=Gt({name:"TagStylesContext",errorMessage:`useTagStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tag />" `}),me=z((t,s)=>{const r=qt("Tag",t),n=Ve(t),i={display:"inline-flex",verticalAlign:"top",alignItems:"center",maxWidth:"100%",...r.container};return e.jsx(qs,{value:r,children:e.jsx(V.span,{ref:s,...n,__css:i})})});me.displayName="Tag";var _e=z((t,s)=>{const r=lt();return e.jsx(V.span,{ref:s,noOfLines:1,...t,__css:r.label})});_e.displayName="TagLabel";var Xs=z((t,s)=>e.jsx(Oe,{ref:s,verticalAlign:"top",marginEnd:"0.5rem",...t}));Xs.displayName="TagLeftIcon";var Ys=z((t,s)=>e.jsx(Oe,{ref:s,verticalAlign:"top",marginStart:"0.5rem",...t}));Ys.displayName="TagRightIcon";var ct=t=>e.jsx(Oe,{verticalAlign:"inherit",viewBox:"0 0 512 512",...t,children:e.jsx("path",{fill:"currentColor",d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})});ct.displayName="TagCloseIcon";var Zs=z((t,s)=>{const{isDisabled:r,children:n,...i}=t,l={display:"flex",alignItems:"center",justifyContent:"center",outline:"0",...lt().closeButton};return e.jsx(V.button,{ref:s,"aria-label":"close",...i,type:"button",disabled:r,__css:l,children:n||e.jsx(ct,{})})});Zs.displayName="TagCloseButton";const Ks=()=>e.jsxs(e.Fragment,{children:[e.jsx(Je,{}),e.jsx(Be,{children:e.jsx(I,{width:"full",sx:{mt:8,mb:4},children:e.jsxs(M,{templateColumns:"1fr",alignItems:"center",gap:4,children:[e.jsx(p,{children:e.jsx(L,{})}),e.jsx(p,{children:e.jsx(F,{height:"120px"})}),e.jsx(p,{children:e.jsx(F,{height:"120px"})}),e.jsx(p,{children:e.jsx(F,{height:"120px"})}),e.jsx(p,{children:e.jsx(F,{height:"120px"})}),e.jsx(p,{children:e.jsx(F,{height:"120px"})}),e.jsx(p,{children:e.jsx(F,{height:"120px"})})]})})})]});function Qs(t){return t&&typeof t=="object"&&"default"in t?t.default:t}var K=Qs(D),Js=Object.assign||function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},er=function(t,s){var r={};for(var n in t)s.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r},ye=function(s){var r=s.color,n=r===void 0?"currentColor":r,i=s.size,o=i===void 0?24:i;s.children;var l=er(s,["color","size","children"]),c="mdi-icon "+(l.className||"");return K.createElement("svg",Js({},l,{className:c,width:o,height:o,fill:n,viewBox:"0 0 24 24"}),K.createElement("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}))},tr=K.memo?K.memo(ye):ye,sr=tr;const rr=ge(sr);function nr(t){return t&&typeof t=="object"&&"default"in t?t.default:t}var Q=nr(D),ir=Object.assign||function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ar=function(t,s){var r={};for(var n in t)s.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r},Le=function(s){var r=s.color,n=r===void 0?"currentColor":r,i=s.size,o=i===void 0?24:i;s.children;var l=ar(s,["color","size","children"]),c="mdi-icon "+(l.className||"");return Q.createElement("svg",ir({},l,{className:c,width:o,height:o,fill:n,viewBox:"0 0 24 24"}),Q.createElement("path",{d:"M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z"}))},or=Q.memo?Q.memo(Le):Le,lr=or;const cr=ge(lr);let T;typeof window<"u"?T=window:typeof self<"u"?T=self:T=global;let fe=null,pe=null;const ze=20,de=T.clearTimeout,Ne=T.setTimeout,he=T.cancelAnimationFrame||T.mozCancelAnimationFrame||T.webkitCancelAnimationFrame,Fe=T.requestAnimationFrame||T.mozRequestAnimationFrame||T.webkitRequestAnimationFrame;he==null||Fe==null?(fe=de,pe=function(s){return Ne(s,ze)}):(fe=function([s,r]){he(s),de(r)},pe=function(s){const r=Fe(function(){de(n),s()}),n=Ne(function(){he(r),s()},ze);return[r,n]});function dr(t){let s,r,n,i,o,l,c;const d=typeof document<"u"&&document.attachEvent;if(!d){l=function(m){const h=m.__resizeTriggers__,O=h.firstElementChild,b=h.lastElementChild,C=O.firstElementChild;b.scrollLeft=b.scrollWidth,b.scrollTop=b.scrollHeight,C.style.width=O.offsetWidth+1+"px",C.style.height=O.offsetHeight+1+"px",O.scrollLeft=O.scrollWidth,O.scrollTop=O.scrollHeight},o=function(m){return m.offsetWidth!==m.__resizeLast__.width||m.offsetHeight!==m.__resizeLast__.height},c=function(m){if(m.target.className&&typeof m.target.className.indexOf=="function"&&m.target.className.indexOf("contract-trigger")<0&&m.target.className.indexOf("expand-trigger")<0)return;const h=this;l(this),this.__resizeRAF__&&fe(this.__resizeRAF__),this.__resizeRAF__=pe(function(){o(h)&&(h.__resizeLast__.width=h.offsetWidth,h.__resizeLast__.height=h.offsetHeight,h.__resizeListeners__.forEach(function(C){C.call(h,m)}))})};let a=!1,f="";n="animationstart";const _="Webkit Moz O ms".split(" ");let u="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),j="";{const m=document.createElement("fakeelement");if(m.style.animationName!==void 0&&(a=!0),a===!1){for(let h=0;h<_.length;h++)if(m.style[_[h]+"AnimationName"]!==void 0){j=_[h],f="-"+j.toLowerCase()+"-",n=u[h],a=!0;break}}}r="resizeanim",s="@"+f+"keyframes "+r+" { from { opacity: 0; } to { opacity: 0; } } ",i=f+"animation: 1ms "+r+"; "}const x=function(a){if(!a.getElementById("detectElementResize")){const f=(s||"")+".resize-triggers { "+(i||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',_=a.head||a.getElementsByTagName("head")[0],u=a.createElement("style");u.id="detectElementResize",u.type="text/css",t!=null&&u.setAttribute("nonce",t),u.styleSheet?u.styleSheet.cssText=f:u.appendChild(a.createTextNode(f)),_.appendChild(u)}};return{addResizeListener:function(a,f){if(d)a.attachEvent("onresize",f);else{if(!a.__resizeTriggers__){const _=a.ownerDocument,u=T.getComputedStyle(a);u&&u.position==="static"&&(a.style.position="relative"),x(_),a.__resizeLast__={},a.__resizeListeners__=[],(a.__resizeTriggers__=_.createElement("div")).className="resize-triggers";const j=_.createElement("div");j.className="expand-trigger",j.appendChild(_.createElement("div"));const m=_.createElement("div");m.className="contract-trigger",a.__resizeTriggers__.appendChild(j),a.__resizeTriggers__.appendChild(m),a.appendChild(a.__resizeTriggers__),l(a),a.addEventListener("scroll",c,!0),n&&(a.__resizeTriggers__.__animationListener__=function(O){O.animationName===r&&l(a)},a.__resizeTriggers__.addEventListener(n,a.__resizeTriggers__.__animationListener__))}a.__resizeListeners__.push(f)}},removeResizeListener:function(a,f){if(d)a.detachEvent("onresize",f);else if(a.__resizeListeners__.splice(a.__resizeListeners__.indexOf(f),1),!a.__resizeListeners__.length){a.removeEventListener("scroll",c,!0),a.__resizeTriggers__.__animationListener__&&(a.__resizeTriggers__.removeEventListener(n,a.__resizeTriggers__.__animationListener__),a.__resizeTriggers__.__animationListener__=null);try{a.__resizeTriggers__=!a.removeChild(a.__resizeTriggers__)}catch{}}}}}class hr extends D.Component{constructor(...s){super(...s),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;const{disableHeight:r,disableWidth:n,onResize:i}=this.props;if(this._parentNode){const o=window.getComputedStyle(this._parentNode)||{},l=parseFloat(o.paddingLeft||"0"),c=parseFloat(o.paddingRight||"0"),d=parseFloat(o.paddingTop||"0"),x=parseFloat(o.paddingBottom||"0"),g=this._parentNode.getBoundingClientRect(),v=g.height-d-x,a=g.width-l-c,f=this._parentNode.offsetHeight-d-x,_=this._parentNode.offsetWidth-l-c;(!r&&(this.state.height!==f||this.state.scaledHeight!==v)||!n&&(this.state.width!==_||this.state.scaledWidth!==a))&&(this.setState({height:f,width:_,scaledHeight:v,scaledWidth:a}),typeof i=="function"&&i({height:f,scaledHeight:v,scaledWidth:a,width:_}))}},this._setRef=r=>{this._autoSizer=r}}componentDidMount(){const{nonce:s}=this.props,r=this._autoSizer?this._autoSizer.parentNode:null;if(r!=null&&r.ownerDocument&&r.ownerDocument.defaultView&&r instanceof r.ownerDocument.defaultView.HTMLElement){this._parentNode=r;const n=r.ownerDocument.defaultView.ResizeObserver;n!=null?(this._resizeObserver=new n(()=>{this._timeoutId=setTimeout(this._onResize,0)}),this._resizeObserver.observe(r)):(this._detectElementResize=dr(s),this._detectElementResize.addResizeListener(r,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),this._timeoutId!==null&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){const{children:s,defaultHeight:r,defaultWidth:n,disableHeight:i=!1,disableWidth:o=!1,doNotBailOutOnEmptyChildren:l=!1,nonce:c,onResize:d,style:x={},tagName:g="div",...v}=this.props,{height:a,scaledHeight:f,scaledWidth:_,width:u}=this.state,j={overflow:"visible"},m={};let h=!1;return i||(a===0&&(h=!0),j.height=0,m.height=a,m.scaledHeight=f),o||(u===0&&(h=!0),j.width=0,m.width=u,m.scaledWidth=_),l&&(h=!1),D.createElement(g,{ref:this._setRef,style:{...j,...x},...v},!h&&s(m))}}const ur=t=>{const{isDraft:s,isOpen:r,onClose:n}=t,i=D.useRef(),{state:o,retry:l}=ws(),c=()=>{const{filteredData:d,handleSearchInputChange:x}=et(i.current??[],["screen_name"]),g=30,v=({style:a,index:f,data:_})=>{const u=_==null?void 0:_[f];return u!=null?e.jsx(e.Fragment,{children:e.jsx(ks,{style:a,children:u.habilitado?e.jsx(at,{href:B(s?Yt:Zt,{client:u.id}),children:e.jsxs(I,{children:[e.jsx(Se,{as:Ls,color:"green.400"}),u.screen_name]})}):e.jsxs(I,{color:"gray.400",sx:{cursor:"not-allowed"},children:[e.jsx(Se,{as:ys,color:"red.400"}),u.screen_name]})},u.id)}):e.jsx(e.Fragment,{})};return e.jsxs(e.Fragment,{children:[e.jsx(I,{sx:{pb:4},children:e.jsx(tt,{handleSearchInputChange:x})}),e.jsx(hr,{children:({height:a,width:f})=>e.jsx(Us,{height:a-60,itemCount:d.length??0,itemSize:g,innerElementType:Hs,width:f,itemData:d,children:v})})]})};return e.jsxs(We,{isCentered:!0,isOpen:r,onClose:n,scrollBehavior:"inside",size:{base:"full",sm:"md",md:"lg"},children:[e.jsx(Ge,{}),e.jsxs(qe,{sx:{maxHeight:"auto"},children:[e.jsx(Xe,{children:"Seleccione el cliente"}),e.jsx(Ye,{}),e.jsx(Ze,{minHeight:{base:"auto",sm:"420px !important"},children:o.map({loading:d=>e.jsxs(it,{spacing:4,children:[e.jsx(Ce,{width:"full",height:"36px",borderRadius:"md"}),e.jsx(Ce,{width:"full",height:"250px",borderRadius:"md"})]}),error:({error:d})=>e.jsx(Qe,{error:d,retry:l,cancelAndNavigateTo:Xt}),success:d=>(i.current=Ke.sortBy(d.data,["screen_name"]),e.jsx(c,{}))})})]})]})},mr="modulepreload",_r=function(t){return"/"+t},Ue={},fr=function(s,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.all(r.map(c=>{if(c=_r(c),c in Ue)return;Ue[c]=!0;const d=c.endsWith(".css"),x=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${x}`))return;const g=document.createElement("link");if(g.rel=d?"stylesheet":mr,d||(g.as="script",g.crossOrigin=""),g.href=c,l&&g.setAttribute("nonce",l),document.head.appendChild(g),d)return new Promise((v,a)=>{g.addEventListener("load",v),g.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${c}`)))})}))}return i.then(()=>s()).catch(o=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o})},pr=()=>e.jsxs(it,{spacing:4,children:[e.jsx(L,{}),e.jsx(L,{})]});let gr=D.lazy(()=>fr(()=>import("./PrintModal.client-DlexSPx1.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39])));const xr=t=>{const{pedidos:s,renglones:r,isOpen:n,onClose:i}=t;return e.jsxs(We,{isCentered:!0,isOpen:n,onClose:i,children:[e.jsx(Ge,{}),e.jsxs(qe,{children:[e.jsx(Xe,{children:"Impresión de pedidos"}),e.jsx(Ye,{}),e.jsx(Ze,{children:e.jsx(D.Suspense,{fallback:e.jsx(pr,{}),children:e.jsx(gr,{pedidos:s,renglones:r})})})]})]})},Or=({isDraft:t,pedidos:s,stateRenglones:r,handleSearchInputChange:n})=>{const i=st(),[o,l]=D.useState(!1),[c,d]=D.useState(!1),{isOpen:x,onOpen:g,onClose:v}=ue(),{isOpen:a,onOpen:f,onClose:_}=ue(),[u,j]=D.useState([]),m=D.useRef({pedidos:[],renglones:{}});D.useEffect(()=>{const w=({id:N,checked:ne})=>{j(ne?H=>[...H,N]:H=>H.filter(ie=>ie!==N))};return U.on("setUnsetSelectedPedido",w),()=>{U.removeListener("setUnsetSelectedPedido",w)}},[]);const h=()=>{if(i.authState.isCustomer()){i.navigate(t?es:ts);return}l(!0),g()},O=()=>{v(),l(!1)},b=()=>{m.current.pedidos=s.filter(w=>u.includes(w.id)),Array.isArray(m.current.pedidos)&&m.current.pedidos.length>0&&r.isSuccess()&&(m.current.renglones=Ke.pick(r.data,u)),d(!0),f()},C=()=>{_(),d(!1)},y=u.length<=0?void 0:u.length==1?`1 ${bs}`:`${u.length} ${Ts}`;return e.jsxs(e.Fragment,{children:[e.jsxs(Ie,{flex:1,alignItems:"center",justifyContent:"space-between",sx:{mx:4},children:[e.jsxs(we,{spacing:{base:2,sm:3},alignItems:"center",children:[(i.authState.isVendor()||i.authState.isCustomer())&&e.jsx(e.Fragment,{children:e.jsx(Pe,{icon:rr,text:t?Kt:Qt,sharedProps:{size:"sm",fontWeight:"400",colorScheme:t?"green":"orange",onClick:()=>{h()}},iconProps:{boxSize:{base:5,md:4}}})}),!t&&e.jsx(Pe,{icon:cr,text:Jt,sharedProps:{size:"sm",fontWeight:"400",colorScheme:"blue",onClick:()=>b(),isDisabled:u.length<=0},iconProps:{boxSize:{base:5,md:4}}}),y!=null&&e.jsxs(e.Fragment,{children:[e.jsx(me,{display:{base:"none",sm:"inherited"},height:8,borderRadius:40,size:"md",variant:"solid",colorScheme:"blue",children:e.jsx(_e,{marginX:1,children:y})}),e.jsx(me,{display:{base:"inherited",sm:"none"},height:8,borderRadius:40,size:"md",variant:"solid",colorScheme:"blue",children:e.jsx(_e,{marginX:1,children:u.length})})]})]}),e.jsx(Ie,{alignItems:"center",marginLeft:4,children:e.jsx(we,{spacing:{base:2,md:4},children:e.jsx(I,{children:e.jsx(tt,{handleSearchInputChange:n})})})})]}),o&&e.jsx(ur,{isDraft:t,isOpen:x,onClose:O}),c&&e.jsx(xr,{isOpen:a,onClose:C,pedidos:m.current.pedidos,renglones:m.current.renglones})]})};var E=(t=>(t[t.INVALIDO=0]="INVALIDO",t[t.INGRESADO=1]="INGRESADO",t[t.APROBADO=2]="APROBADO",t[t.CUMPLIDO=3]="CUMPLIDO",t[t.CERRADO=4]="CERRADO",t[t.ANULADO=5]="ANULADO",t[t.EN_PROGRESO=100]="EN_PROGRESO",t))(E||{});class Er{constructor(s){this.id=s}parentToUnsafe(){return{id:this.id.valueOf()}}}class vr extends Er{}function jr(t){try{return ss(A,t)}catch{throw new ee(`Invalid user role value: ${t}`)}}function Dr(t){try{return rs(A,t)}catch{throw new ee(`Invalid user role string: ${Ee(t,!0)}`)}}function Ar(t){switch(t){case A.customer:return 0;case A.vendor:return 1;case A.admin:return 2}throw new ee(`Invalid user role: ${Ee(t,!0)}`)}function Rr(t){switch(t){case 0:return A.customer;case 1:return A.vendor;case 2:return A.admin}throw new ee(`Invalid user role number: ${Ee(t,!0)}`)}class br extends xe{validate(s){try{if(typeof s=="string")return Dr(s);if(ns(A,s))return s}catch{}this.throwError(s)}toString(){return jr(this.value)}isAdmin(){return this.value.valueOf()==A.admin}isVendor(){return this.value.valueOf()==A.vendor}isCustomer(){return this.value.valueOf()==A.customer}}class Y extends vr{constructor(s){super(new ce(s.id));const{username:r,tango_id:n,habilitado_en_tango:i,screen_name:o,email:l,password_hash:c,role:d,habilitado_en_dxt:x,puede_crear_pedido:g,puede_editar_pedido:v,puede_anular_pedido:a,borrar_pedido_al_anular:f,perfil_facturacion_id:_,aprobar_pedido_al_crear:u,ver_pedidos_cumplidos:j,dia_de_entrega:m,ver_sin_precio:h,mostrar_mensaje_de_advertencia:O,timestamp_modificacion:b,vendedor_id:C,id_lista_alternativa:y,bonificacion_lista_alternativa:w,universal_id:N}=s;if(this.username=new Bs(r),this.screenName=new be(o),typeof l=="string"&&(this.email=new be(l.trim()!==""?new Gs(l).valueOf():"")),this.passwordHash=new je(c),this.role=new br(Rr(d)),this.habilitadoEnDXT=new S(x),this.puedeCrearPedido=new S(g),this.puedeEditarPedido=new S(v),this.puedeAnularPedido=new S(a),this.borrarPedidoAlAnular=new S(f),this.perfilFacturacionId=new G(_),this.aprobarPedidoAlCrear=new S(u),this.verPedidosCumplidos=new S(j),this.diaDeEntrega=new ce(m),this.verSinPrecio=new S(h),this.mostrarMensajeDeAdvertencia=new S(O),this.timestampModificacion=new ce(b),!this.role.isAdmin()&&n==null)throw new is(new as(os.UNPROCESSABLE_ENTITY,{extra:"tango_id missing in UserEntity"}));this.tangoId=n!=null?new G(n):void 0,this.habilitadoEnTango=i!=null?new S(i):void 0,this.vendedorId=C!=null?new G(C):void 0,this.idListaAlternativa=y!=null?new G(y):void 0,this.bonificacionListaAlternativa=w!=null?new ls(w):void 0,this.universalId=new cs(N.replaceAll("-",""))}toUnsafe(){var r,n,i,o,l;return{...this.parentToUnsafe(),username:this.username.valueOf(),tango_id:(r=this.tangoId)==null?void 0:r.valueOf(),habilitado_en_tango:(n=this.habilitadoEnTango)==null?void 0:n.valueOf(),screen_name:this.screenName.valueOf(),email:((i=this.email)==null?void 0:i.valueOf())??null,password_hash:this.passwordHash.valueOf(),role:Ar(this.role.valueOf()),habilitado_en_dxt:this.habilitadoEnDXT.valueOf(),puede_crear_pedido:this.puedeCrearPedido.valueOf(),puede_editar_pedido:this.puedeEditarPedido.valueOf(),puede_anular_pedido:this.puedeAnularPedido.valueOf(),borrar_pedido_al_anular:this.borrarPedidoAlAnular.valueOf(),perfil_facturacion_id:this.perfilFacturacionId.valueOf(),aprobar_pedido_al_crear:this.aprobarPedidoAlCrear.valueOf(),ver_pedidos_cumplidos:this.verPedidosCumplidos.valueOf(),dia_de_entrega:this.diaDeEntrega.valueOf(),ver_sin_precio:this.verSinPrecio.valueOf(),mostrar_mensaje_de_advertencia:this.mostrarMensajeDeAdvertencia.valueOf(),timestamp_modificacion:this.timestampModificacion.valueOf(),id_lista_alternativa:(o=this.idListaAlternativa)==null?void 0:o.valueOf(),bonificacion_lista_alternativa:(l=this.bonificacionListaAlternativa)==null?void 0:l.valueOf(),universal_id:this.universalId.valueOf()}}tangoUserExists(){return this.habilitadoEnTango!=null}habilitado(){return this.habilitadoEnDXT.valueOf()&&this.habilitadoEnTango!=null&&this.habilitadoEnTango.valueOf()}isAdmin(){return this.role.isAdmin()}isCustomer(){return this.role.isCustomer()}isVendor(){return this.role.isVendor()}hasAdminAccess(){return this.role.isAdmin()}}function Tr(t){switch(t){case E.INGRESADO:return Ot;case E.APROBADO:return xt;case E.CUMPLIDO:return gt;case E.CERRADO:return pt;case E.ANULADO:return ft;case E.EN_PROGRESO:return _t;default:return mt}}function Cr(t,s){const{estado:r}=t;if(!(s!=null&&(r==E.APROBADO||r==E.INGRESADO)))return r;for(const i of s){const{a_descontar:o,a_facturar:l,pendiente_descontar:c,pendiente_facturar:d}=i;if(o!=c||l!=d)return E.EN_PROGRESO}return r}function Pr(t,s){return(t instanceof Y?t.isAdmin():t.role==A.admin)?!1:s==E.INGRESADO}function Sr(t,s){if(s==E.INGRESADO)return!0;const r=t instanceof Y?t.isAdmin():t.role==A.admin;if(!(r?!0:t instanceof Y?t.puedeAnularPedido.valueOf():t.puede_anular_pedido))return!1;const i=t instanceof Y?t.aprobarPedidoAlCrear.valueOf():t.aprobar_pedido_al_crear;return!!(s==E.APROBADO&&i||(s==E.EN_PROGRESO||s==E.ANULADO)&&r)}function Ir(t,s){return s.isSuccess()?Cr(t,s.data[t.id]):t.estado}function dt(t,s){let r;switch(t){case E.INGRESADO:r="blue";break;case E.APROBADO:r="purple";break;case E.CUMPLIDO:r="green";break;case E.CERRADO:r="black";break;case E.ANULADO:r="red";break;default:r="gray"}return s==null?r:`${r}${s}`}const wr=({estado:t})=>{const s=Tr(t),r=dt(t);return e.jsx(Ms,{fontSize:"1em",variant:"solid",colorScheme:r,lineHeight:"1.5em",children:s})};function yr(t){return t&&typeof t=="object"&&"default"in t?t.default:t}var J=yr(D),Lr=Object.assign||function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zr=function(t,s){var r={};for(var n in t)s.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r},He=function(s){var r=s.color,n=r===void 0?"currentColor":r,i=s.size,o=i===void 0?24:i;s.children;var l=zr(s,["color","size","children"]),c="mdi-icon "+(l.className||"");return J.createElement("svg",Lr({},l,{className:c,width:o,height:o,fill:n,viewBox:"0 0 24 24"}),J.createElement("path",{d:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"}))},Nr=J.memo?J.memo(He):He,Fr=Nr;const Ur=ge(Fr),Hr=({app:t,draft:s,pedido:r,onDelete:n})=>{const i=t.authState.userInfo,o=i.role==A.admin,l=Pr(i,r.estado),c=s||Sr(i,r.estado),d=s||i.borrar_pedido_al_anular;return e.jsxs(Vs,{isLazy:!0,id:"menu",children:[e.jsx(Ds,{as:$s,size:"sm","aria-label":Cs,icon:e.jsx(Ur,{}),variant:"outline",colorScheme:"white"}),e.jsx(ds,{children:e.jsxs(As,{rootProps:{zIndex:2e3},children:[!o&&e.jsxs(e.Fragment,{children:[e.jsx(k,{onClick:()=>{t.navigate(B(s?hs:us,{id:r.id}))},isDisabled:!l,children:Et}),e.jsx(k,{onClick:()=>{t.navigate(B(s?ms:_s,{id:r.id}))},children:vt}),e.jsx(k,{onClick:()=>{t.navigate(B(s?fs:ps,{id:r.id}))},children:s?jt:Dt}),s&&e.jsx(k,{onClick:()=>{t.navigate(B(gs,{id:r.id}))},children:At}),e.jsx(Rs,{})]}),e.jsx(k,{onClick:()=>n(r.id),isDisabled:!c,children:d?Rt:bt})]})})]})},kr=()=>e.jsxs(te,{status:"warning",children:[e.jsx(se,{}),e.jsx(re,{children:"El pedido no cuenta con productos."})]}),Br=()=>e.jsxs(te,{status:"error",children:[e.jsx(se,{}),e.jsx(re,{children:"Ocurrió un error al cargar los detalles del pedido."})]}),Mr=()=>e.jsx(I,{width:"full",sx:{mt:8,mb:4},children:e.jsxs(M,{templateColumns:"1fr",alignItems:"center",gap:2,children:[e.jsx(p,{children:e.jsx(L,{height:"20px"})}),e.jsx(p,{children:e.jsx(L,{height:"20px"})}),e.jsx(p,{children:e.jsx(L,{height:"20px"})}),e.jsx(p,{children:e.jsx(L,{height:"20px"})})]})}),Vr=({nro_pedido:t,renglones:s})=>e.jsx(ot,{sx:{p:0,m:0},children:e.jsxs(rt,{variant:"stripedHoverOverCard",colorScheme:"gray",size:"sm",borderWidth:"1px",children:[e.jsx(zs,{children:e.jsx(Z,{children:e.jsx(Ns,{sx:{py:2},children:e.jsxs(M,{templateColumns:{base:"1fr 1fr 1fr",md:"4fr 1fr 1fr 1fr"},gap:6,children:[e.jsx(p,{children:e.jsx(R,{fontSize:{base:"xs",md:"sm"},children:"Artículo"})}),e.jsx(p,{sx:{display:{base:"none",md:"block"}},children:e.jsx(R,{fontSize:{base:"xs",md:"sm"},textAlign:"center",children:"Precio"})}),e.jsx(p,{children:e.jsx(R,{fontSize:{base:"xs",md:"sm"},textAlign:"center",children:"Cantidad"})}),e.jsx(p,{children:e.jsx(R,{fontSize:{base:"xs",md:"sm"},textAlign:"center",children:"Subtotal"})})]})})})}),e.jsx(nt,{children:s.map(({id_articulo:r,nombre_articulo:n,codigo_articulo:i,descripcion_adicional:o,precio:l,cantidad:c,subtotal:d},x)=>e.jsx(Z,{children:e.jsx(ve,{children:e.jsxs(M,{templateColumns:{base:"1fr 1fr 1fr",md:"4fr 1fr 1fr 1fr"},gap:6,children:[e.jsx(p,{children:e.jsx(q,{children:Tt(n,i,o)})}),e.jsx(p,{sx:{display:{base:"none",md:"block"}},children:e.jsx(Re,{precio:l,moneda:"$"})}),e.jsx(p,{children:e.jsx(X,{textAlign:"center",children:c})}),e.jsx(p,{children:e.jsx(Re,{precio:d,moneda:"$"})})]})})},`details-${t}-${x}`))})]})}),$r=({wasOpen:t,pedido:s,stateRenglones:r})=>e.jsx(I,{sx:{mt:6},children:t&&r.map({loading:n=>e.jsx(Mr,{}),error:n=>e.jsx(Br,{}),success:n=>{var c;const{id:i,numero_pedido:o}=s,l=(c=n.data)==null?void 0:c[i];return Array.isArray(l)?e.jsx(Vr,{nro_pedido:o,renglones:l}):e.jsx(kr,{})}})}),Wr=({index:t,app:s,draft:r,pedido:n,stateRenglones:i,onDelete:o,isHidden:l})=>{const[c,d]=D.useState(!1),[x,g]=D.useState(!1),v=xs("gray.800","white"),a=D.useRef(!1),f=Ir(n,i),_=D.useMemo(()=>e.jsx($r,{wasOpen:a.current,pedido:n,stateRenglones:i}),[a.current,i.constructor.name]),u=()=>{const P=!c;P&&(a.current=!0),d(P),U.emit("togglePedidoDetails",{id:n.id})},j=(P,le)=>{g(!!P),U.emit("setUnsetSelectedPedido",{id:le,checked:P})};D.useEffect(()=>{const P=({id:le})=>{n.id!==le&&d(!1)};return U.on("togglePedidoDetails",P),()=>{U.removeListener("togglePedidoDetails",P)}},[]);const{id:m,numero_pedido:h,fecha_alta:O,fecha_entrega:b,codigo_cliente:C,codigo_vendedor:y,codigo_transporte:w,nombre_cliente:N,nombre_vendedor:ne,nombre_transporte:H,total:ie,descuento:De,comentarios:ae,descripcion:ht}=n,$=f,ut=ae!=null&&ae.length>0;s.authState.isAdmin();const Ae=s.authState.isVendor(),oe=s.authState.isCustomer();return e.jsx(Z,{sx:{...l&&!x&&{display:"none"}},children:e.jsxs(ve,{sx:{py:6,position:"relative",borderTopWidth:{base:"3px",md:"4px"},borderTopStyle:"solid",borderTopColor:`${r?"blue.500 !important":dt($,".500 !important")}`},children:[e.jsxs(I,{display:"flex",sx:{position:"absolute",right:5,top:5},flexDirection:"column",children:[e.jsx(Hr,{app:s,draft:r,pedido:n,onDelete:o}),!r&&e.jsx(Ws,{size:"xl",colorScheme:"blue",sx:{mt:2,borderWidth:0,borderColor:v},onChange:P=>{j(P.target.checked,m)}})]}),e.jsxs(M,{templateColumns:{base:"repeat(2, 1fr)",md:"repeat(4, 1fr)"},gap:6,sx:{cursor:"pointer"},onClick:()=>{u()},children:[r?e.jsx(e.Fragment,{children:e.jsx(p,{colSpan:{base:2,md:4},children:e.jsx(R,{size:"md",textTransform:"uppercase",children:ht})})}):e.jsxs(e.Fragment,{children:[e.jsxs(p,{children:[e.jsx(R,{size:"sm",children:"Pedido"}),e.jsx(X,{children:h})]}),e.jsxs(p,{children:[e.jsx(R,{size:"sm",children:"Estado"}),e.jsx(wr,{estado:$})]}),e.jsxs(p,{children:[e.jsx(R,{size:"sm",children:"Emisión"}),e.jsx(X,{children:Te(O)})]}),e.jsxs(p,{children:[e.jsx(R,{size:"sm",children:"Entrega"}),e.jsx(X,{children:Te(b)})]})]}),!oe&&e.jsxs(p,{...Ae&&{colSpan:2},children:[e.jsxs(R,{size:"sm",children:["Cliente: ",C]}),e.jsx(q,{children:N})]}),!Ae&&!oe&&e.jsxs(p,{children:[e.jsxs(R,{size:"sm",children:["Vendedor: ",y]}),e.jsx(q,{children:ne})]}),e.jsxs(p,{...oe&&{colSpan:3},children:[e.jsxs(R,{size:"sm",children:["Transporte: ",w]}),e.jsx(q,{children:H})]}),e.jsxs(p,{children:[e.jsxs(R,{size:"md",sx:{textTransform:"uppercase",color:$===E.APROBADO&&"green.400"},children:["Total",De!=null&&e.jsxs(e.Fragment,{children:[" ",`-${De}%`]})]}),e.jsx(R,{size:"md",sx:{fontWeight:"bolder",color:$===E.APROBADO&&"green.400"},children:e.jsx(Ct,{precio:ie,moneda:"$"})})]}),ut&&e.jsx(p,{colSpan:{base:2,md:4},children:e.jsxs(te,{status:"info",children:[e.jsx(se,{}),e.jsx(re,{children:ae})]})})]}),e.jsx(I,{children:e.jsx(I,{sx:{display:c?"block":"none"},children:_})},`pedido-details-${t}`)]})})};function Gr(t){const s=st(),n=s.authState.userInfo.borrar_pedido_al_anular.valueOf(),{draft:i,unfilteredPedidos:o,filteredPedidos:l,isFiltering:c,stateRenglones:d,reloadData:x}=t,g=Is(),v=ue(),{isOpen:a,onOpen:f,onClose:_}=v,u=D.useRef(null),j=h=>{u.current=h,f()},m=async()=>{const h=u.current;if(h!=null){const O=i?await zt(h,s):await Nt(h,s);console.log(O),O.map({success:b=>{g({title:i?Ft:n?Ut:Ht,status:"success"})},error:b=>{g({title:Es,status:"error"})}}),O.isSuccess()&&await x(),_()}};return e.jsxs(ot,{sx:{p:0,m:0},children:[e.jsx(rt,{variant:"stripedOverCard",colorScheme:"gray",size:"md",sx:{borderCollapse:"separate",borderSpacing:"0 1rem"},children:e.jsxs(nt,{children:[o.map((h,O)=>e.jsx(Wr,{index:O,draft:i,app:s,pedido:h,stateRenglones:d,onDelete:j,isHidden:c&&!l.includes(h)},`pedido-${h.id}`)),!l.length&&e.jsx(Z,{children:e.jsx(ve,{children:e.jsxs(te,{status:"info",children:[e.jsx(se,{}),e.jsx(re,{children:c?Os:i?Ps:Ss})]})})})]})}),e.jsx(Fs,{isOpen:a,onClose:_,handleDeletion:m,message:{title:i?Pt:n?St:It,body:i?wt:n?yt:Lt}})]})}const qr=t=>{const{showDrafts:s,pedidos:r,reloadData:n}=t,i=vs().state.userOrThrow(),o=i.role==A.admin;i.role==A.vendor;const l=i.role==A.customer,{filteredData:c,handleSearchInputChange:d,isFiltering:x}=et(r,["descripcion","comentarios",...s?[]:["numero_pedido"],...l?[]:["codigo_cliente","nombre_cliente"],...o?["codigo_vendedor","nombre_vendedor"]:[]]),{state:g}=ke({...s?kt:Bt,silent:!0,transformResponse:v=>(Object.values(v).forEach(a=>{Array.isArray(a)&&a.sort((f,_)=>f.renglon-_.renglon)}),v)});return e.jsxs(e.Fragment,{children:[e.jsx(Je,{children:e.jsx(Or,{isDraft:s,pedidos:r,stateRenglones:g,handleSearchInputChange:d})}),e.jsx(Be,{children:e.jsx(Gr,{draft:s,stateRenglones:g,unfilteredPedidos:r,filteredPedidos:c,isFiltering:x,reloadData:n})})]})},jn=t=>{const s=t.showDrafts===!0,{state:r,retry:n,reload:i}=ke({...s?Mt:Vt,silent:!0});return r.map({loading:o=>e.jsx(Ks,{}),error:({error:o})=>e.jsx(Qe,{error:o,retry:n,cancelAndNavigateTo:js}),success:o=>e.jsx(qr,{showDrafts:s,pedidos:o.data,reloadData:i})})};export{jn as O,pr as P,Tr as g};
