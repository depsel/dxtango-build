import{r as j,j as s,u as P}from"./emotion-element-43c6fea0.browser.esm-Bukkp3pI.js";import{_ as g,S as R,T as b,W as c,R as A}from"./auth_context-By8qlCOz.js";import{a as V,C as E}from"./app-ChKZjo6p.js";import{S as I}from"./SettingsFormHeading-DRaop4b3.js";import{a as y,o as F}from"./yup-DmufeRdH.js";import{a as O,b as q}from"./app_resources-0MHmsA5u.js";import{A as v}from"./refresh_all-BSF23UiD.js";import{C as l}from"./CommonCard-B6Zs7VdS.js";import{F as D}from"./FormErrors-DK3bqFxa.js";import{d as N,V as G,P as m}from"./vo_dxt_password-B_Q-LXlx.js";import{S as T}from"./SettingsFormButtons-Dtw3fGC3.js";import{y as W}from"./utils-DihYaFf6.js";import{c as B,a as p,b as H}from"./index.esm-DLycO5Xl.js";import{G as L,a as u}from"./chunk-ZPFGWTBB-C6BSXP9K.js";import{C as $}from"./chunk-5MKCW436-DxsHWDvy.js";import"./chunk-KRPLQIP4-BIcN844u.js";import"./chunk-BL2ZZSHG-CllUrry9.js";import"./chunk-7OLJDQMT-DeTsz2JD.js";import"./chunk-6QYXN73V-e7cXtMTs.js";import"./chunk-56K2BSAJ-HKDUOZgn.js";import"./chunk-3Y4YXCR2-BRX7qSte.js";import"./chunk-QURMB2UJ-DZ-0JI-4.js";import"./chunk-3KCBMPN5-BSyM0bpq.js";import"./chunk-ZHMYA64R-DxFJ4KrV.js";import"./chunk-YQO7BFFX--iiPSc49.js";import"./chunk-MFVQSVQB-DALUCuvz.js";import"./chunk-46CXQZ4E-3v06V3Zr.js";import"./ControlledInput-Bfe1Y7Kq.js";import"./chunk-6CVSDS6C-DbHhw9T-.js";import"./chunk-2ZHRCML3-p9ky5-ds.js";import"./chunk-Z6RXEUPO-BTzJ3cmm.js";const U=()=>{const[r,o]=j.useState(null);return{yupValidationSchema:B({old_password:p().required("Ingrese su contaseña actual"),new_password:p().required("Ingrese su nueva contraseña").test("password","Formato de contraseña no válido",t=>{if(t!=""&&t!=null){let a=N(t);return g.isEqual(r,a)||o(a),W(G,t)}return!0}),new_password_repeat:p().required("Repita su nueva contraseña").oneOf([H("new_password")],"Las contraseñas deben coincidir")}).required(),passwordStatus:r}},k=()=>{const r=O(),o=q(),{yupValidationSchema:d,passwordStatus:t}=U(),{handleSubmit:a,control:n,reset:M,setError:w,formState:{errors:f,isSubmitting:_,isSubmitSuccessful:S}}=y({defaultValues:{old_password:"",new_password:"",new_password_repeat:""},resolver:F(d)}),e=S||_,x=async h=>{const{new_password_repeat:X,...C}=h;(await R(C,r)).map({success:i=>{o({title:b,status:"success"}),r.authDispatch(new v(i.data.user)),r.navigate(c)},error:i=>{o({title:A,status:"error"}),w("root",{message:i.info.error_description})}})};return s.jsx("form",{noValidate:!0,onSubmit:a(x),children:s.jsxs(V,{children:[s.jsx(D,{errors:f}),s.jsx(l,{children:s.jsxs(L,{templateColumns:"1fr",alignItems:"start",gap:4,children:[s.jsx(u,{children:s.jsx(m,{fieldProps:{name:"old_password",id:"old_password"},formControlInnerProps:{label:"Contraseña Actual"},disableForm:e,control:n})}),s.jsx(u,{children:s.jsx(m,{fieldProps:{name:"new_password",id:"new_password"},formControlInnerProps:{label:"Nueva contraseña"},passwordStatus:t,disableForm:e,control:n})}),s.jsx(u,{children:s.jsx(m,{fieldProps:{name:"new_password_repeat",id:"new_password_repeat"},formControlInnerProps:{label:"Confirmar nueva contraseña"},disableForm:e,control:n})})]})}),s.jsx(l,{children:s.jsx(T,{isLoading:e,hideCancelButton:!0})})]})})};function Vs(){const r=P();return s.jsxs($,{maxW:"2xl",sx:{my:4},children:[s.jsx(I,{title:E,returnButton:{buttonProps:{onClick:()=>{r(c)}}}}),s.jsx(k,{})]})}export{Vs as default};
