import{j as e,u as H}from"./emotion-element-43c6fea0.browser.esm-CqNy1Myq.js";import{J as N,aI as O,U as I,Y as U}from"./auth_context-BPNKm5C_.js";import{V as z,q as G}from"./app-CX69rDqm.js";import{S as L}from"./SettingsFormHeading-DFLKZnIX.js";import{V as k,a as $,b as B}from"./requests-CrD5D48t.js";import{D as p,u as X}from"./useDXTApiFetch-DJJQmcPU.js";import{A as Y}from"./ApiErrors-DQxu8cuC.js";import{F as a,a as D}from"./FormSkeletons-FVNY-1Wx.js";import{B as q}from"./chunk-PULVB27S-CjXp21rs.js";import{G as u,a as r}from"./chunk-ZPFGWTBB-BGOvs2SN.js";import{u as J,c as K,f as v,a as m,e as y,d as Q,o as W}from"./index.esm-DRWPArKk.js";import{u as Z}from"./app_resources-BncH8wDZ.js";import{C as c}from"./CommonCard-C8mdcxSI.js";import{F as ee,a as re}from"./chunk-56K2BSAJ-GUqegmVg.js";import{F as se}from"./chunk-KRPLQIP4-BuYv1GpP.js";import{C as oe}from"./chunk-CWVAJCXJ-DgVmidFC.js";import{C as d}from"./ControlledInput-B1wc2r1g.js";import{C as A}from"./ControlledTextarea-43CRl7fs.js";import{F as te}from"./FormErrors-CgyDTrkn.js";import{S as ie}from"./SettingsFormButtons-Dr71bDKY.js";import{y as M}from"./utils-DihYaFf6.js";import{A as E,b as w}from"./index-BBOeOfQH.js";import{u as ne}from"./chunk-6RSEZNRH-wKYG4vTw.js";import{H as j}from"./chunk-7OLJDQMT-Dt4RFKr6.js";import"./ResponsiveIconButton-DTsMLJ6O.js";import"./chunk-VMD3UMGK-7pfkPLnR.js";import"./chunk-6QYXN73V-QyLCLJ50.js";import"./chunk-BL2ZZSHG-BVnSQMvm.js";import"./CloseIcon-DhOj6wIL.js";import"./components-F5Cv7EYO.js";import"./chunk-3ASUQ6PA-hNB_nry7.js";import"./chunk-2OOHT3W5-U8fop6km.js";import"./chunk-YQO7BFFX-CkL1T7LL.js";import"./chunk-MFVQSVQB-DR_sqUop.js";import"./chunk-7D6N5TE5-Bi3ngImC.js";import"./index-CAKzuJDV.js";import"./chunk-H46NUPBZ-CEXsk7m2.js";import"./chunk-6CVSDS6C-CBdC6jDV.js";import"./chunk-3KCBMPN5-BlEVF58j.js";import"./chunk-46CXQZ4E-B49QqCoR.js";import"./chunk-3Y4YXCR2-VQX1029H.js";import"./chunk-QURMB2UJ-CVr_6ThV.js";class ae extends N{validate(l){let s=l;if(typeof s=="string"&&(s=s.trim().toLowerCase(),O(s)))return s;this.throwError(l)}}const le=()=>e.jsx(q,{width:"full",sx:{mt:8,mb:4},children:e.jsxs(u,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"center",gap:4,children:[e.jsx(r,{children:e.jsx(a,{})}),e.jsx(r,{children:e.jsx(a,{})}),e.jsx(r,{children:e.jsx(a,{})}),e.jsx(r,{children:e.jsx(a,{})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(p,{})}),e.jsx(r,{children:e.jsx(a,{})}),e.jsx(r,{children:e.jsx(a,{})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(p,{})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(a,{})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(D,{})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(p,{})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(a,{})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(D,{})}),e.jsx(r,{children:e.jsx(a,{})}),e.jsx(r,{children:e.jsx(a,{})})]})}),F=i=>{const{fieldProps:l,formControlProps:s,formControlInnerProps:x,control:f}=i,{text:o,helperText:h,helperAction:_}=x||{},{field:{ref:b,onChange:g,value:S},fieldState:{invalid:C},formState:{errors:T}}=J({name:l.name,control:f});return e.jsxs(ee,{...s,isInvalid:C,ref:b,children:[e.jsxs(se,{alignItems:"center",children:[e.jsx(oe,{...l,onChange:g,isChecked:S,children:o}),_]}),h!=null&&e.jsx(re,{children:h})]})},me=K({smtp_enabled:v().required(),smtp_host:m().required("Ingrese el host SMTP").test("valid-host","Ingrese un host SMTP válido",i=>M(ae,i)),smtp_username:m().required("Ingrese el usuario SMTP"),smtp_password:m().required("Ingrese la contraseña SMTP"),smtp_port:y().required("Ingrese el puerto SMTP").typeError("Ingrese un número de puerto SMTP válido").test("is-port","Ingrese un puerto SMTP válido",i=>M(k,i)),smtp_use_tls:v().required(),smtp_from_email:m().required("Ingrese el correo electrónico de salida").email("Ingrese un correo electrónico válido"),auth_expiration_days:y().min(E,`El tiempo de espera debe ser mayor a ${E}`).max(w,`El tiempo de espera debe ser menor a ${w}`).required("Ingrese el tiempo de espera para logout").typeError("Ingrese el tiempo de espera para logout"),admin_email:m().required("Ingrese el correo electrónico del Administrador").email("Ingrese un correo electrónico válido"),user_warning_message_title:m().required("Ingrese el título del mensaje de advertencia"),user_warning_message_content:m().required("Ingrese el contenido del mensaje de advertencia"),user_disabled_message_title:m().required("Ingrese el título del mensaje de inhabilitación"),user_disabled_message_content:m().required("Ingrese el contenido del mensaje de inhabilitación")}).required(),de=i=>{const{stateData:l}=i,s=Z(),x=ne(),{handleSubmit:f,control:o,reset:h,setError:_,formState:{errors:b,isSubmitting:g,isSubmitSuccessful:S},watch:C}=Q({defaultValues:l,resolver:W(me)}),T=C("smtp_enabled"),t=S||g,n=t||!T,R=async V=>{(await $(V,s)).map({success:P=>{x({title:z,status:"success"}),s.navigate(I)},error:P=>{x({title:P.errorInfoOrNull()?.error_description??U}),_("root",{message:P.info.error_description})}})};return e.jsx("form",{noValidate:!0,onSubmit:f(R),children:e.jsxs(q,{children:[e.jsx(te,{errors:b}),e.jsx(c,{children:e.jsxs(u,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(r,{colSpan:{md:2},children:e.jsx(j,{size:"sm",textTransform:"uppercase",children:"Mensajes"})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(d,{fieldProps:{name:"user_warning_message_title",id:"user_warning_message_title",type:"text",isDisabled:t},formControlProps:{isDisabled:t},formControlInnerProps:{label:"Título del mensaje de advertencia"},control:o})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(A,{fieldProps:{name:"user_warning_message_content",id:"user_warning_message_content",isDisabled:t},formControlProps:{isDisabled:t},formControlInnerProps:{label:"Contenido del mensaje de advertencia"},control:o})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(p,{})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(d,{fieldProps:{name:"user_disabled_message_title",id:"user_disabled_message_title",type:"text",isDisabled:t},formControlProps:{isDisabled:t},formControlInnerProps:{label:"Título del mensaje de inhabilitación"},control:o})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(A,{fieldProps:{name:"user_disabled_message_content",id:"user_disabled_message_content",isDisabled:t},formControlProps:{isDisabled:t},formControlInnerProps:{label:"Contenido del mensaje de inhabilitación"},control:o})})]})}),e.jsx(c,{children:e.jsxs(u,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(r,{colSpan:{md:2},children:e.jsx(j,{size:"sm",textTransform:"uppercase",children:"Administrador"})}),e.jsx(r,{children:e.jsx(d,{fieldProps:{name:"admin_email",id:"admin_email",type:"text",inputMode:"email",htmlSize:30,width:"auto",isDisabled:t},formControlProps:{isDisabled:t},formControlInnerProps:{label:"Correo electrónico"},control:o})})]})}),e.jsx(c,{children:e.jsxs(u,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(r,{colSpan:{md:2},children:e.jsx(j,{size:"sm",textTransform:"uppercase",children:"Sesiones"})}),e.jsx(r,{children:e.jsx(d,{fieldProps:{name:"auth_expiration_days",id:"auth_expiration_days",type:"number",inputMode:"tel",htmlSize:5,maxLength:5,width:"auto",isDisabled:t},formControlProps:{isDisabled:t},formControlInnerProps:{label:"Tiempo de espera para logout (en días)"},control:o})})]})}),e.jsx(c,{children:e.jsxs(u,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(r,{colSpan:{md:2},children:e.jsx(j,{size:"sm",textTransform:"uppercase",children:"Envío de correo SMTP"})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(F,{control:o,fieldProps:{id:"smtp_enabled",name:"smtp_enabled"},formControlProps:{isDisabled:t},formControlInnerProps:{text:"Habilitado"}})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(p,{})}),e.jsx(r,{children:e.jsx(d,{fieldProps:{name:"smtp_host",id:"smtp_host",type:"text",isDisabled:n},formControlProps:{isDisabled:n},formControlInnerProps:{label:"Host"},control:o})}),e.jsx(r,{children:e.jsx(d,{fieldProps:{name:"smtp_username",id:"smtp_username",type:"text",isDisabled:n},formControlProps:{isDisabled:n},formControlInnerProps:{label:"Usuario"},control:o})}),e.jsx(r,{children:e.jsx(d,{fieldProps:{name:"smtp_password",id:"smtp_password",type:"text",isDisabled:n},formControlProps:{isDisabled:n},formControlInnerProps:{label:"Contraseña"},control:o})}),e.jsx(r,{children:e.jsx(d,{fieldProps:{name:"smtp_port",id:"smtp_port",type:"number",inputMode:"tel",htmlSize:5,maxLength:5,width:"auto",isDisabled:n},formControlProps:{isDisabled:n},formControlInnerProps:{label:"Puerto"},control:o})}),e.jsx(r,{children:e.jsx(F,{control:o,fieldProps:{id:"smtp_use_tls",name:"smtp_use_tls",isDisabled:n},formControlInnerProps:{text:"Usar TLS"}})}),e.jsx(r,{colSpan:{md:2},children:e.jsx(p,{})}),e.jsx(r,{children:e.jsx(d,{fieldProps:{name:"smtp_from_email",id:"smtp_from_email",type:"text",inputMode:"email",htmlSize:30,width:"auto",isDisabled:n},formControlProps:{isDisabled:n},formControlInnerProps:{label:"Correo electrónico de salida"},control:o})})]})}),e.jsx(c,{children:e.jsx(ie,{isLoading:t,hideCancelButton:!0})})]})})},pe=()=>{const{state:i,retry:l}=X({...B,silent:!0});return i.map({loading:s=>e.jsx(le,{}),error:({error:s})=>e.jsx(Y,{error:s,retry:l,cancelAndNavigateTo:I}),success:s=>e.jsx(de,{stateData:s.data})})};function sr(){const i=H();return e.jsxs(e.Fragment,{children:[e.jsx(L,{title:G,returnButton:{buttonProps:{onClick:()=>{i(I)}}}}),e.jsx(pe,{})]})}export{sr as default};
