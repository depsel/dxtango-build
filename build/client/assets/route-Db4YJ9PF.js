import{j as e,u as D}from"./emotion-element-5486c51c.browser.esm-CMT9BBIk.js";import{L as E,U as p,a6 as y}from"./auth_context-CCfWU2Jo.js";import{T as O,q}from"./app-DHK1Xtws.js";import{S as A}from"./SettingsFormHeading-389CUOcW.js";import{c as B,d as F}from"./requests-CGosjl0w.js";import{u as R}from"./useDXTApiFetch-D7fvlkDE.js";import{A as M}from"./ApiErrors-Blpol96Y.js";import{F as i}from"./FormSkeletons-Ch1cmlVo.js";import{B as _}from"./chunk-PULVB27S-C1tz_n3L.js";import{G as j,a as o}from"./chunk-ZPFGWTBB-Bu2gzu07.js";import{c as U,a as m,f as c,d as G,o as L}from"./index.esm-CzxlHhdA.js";import{u as w}from"./app_resources-Di8KxAHS.js";import{C as f}from"./CommonCard-CfkzH5Am.js";import{C as d}from"./ControlledInput-BKce-7V6.js";import{F as V}from"./FormErrors-COO1VgQ3.js";import{S as $}from"./SettingsFormButtons-BcygzEqX.js";import{y as x}from"./utils-DQu-C9ov.js";import{D as b,b as g,V as v}from"./misc_settings.consts-CNGs7G2v.js";import"./order_settings.consts-BS2ZOo_e.js";import{u as z}from"./chunk-6RSEZNRH-p2hFl890.js";import"./ResponsiveIconButton-CQwgfxML.js";import"./chunk-VMD3UMGK-D9IL_j_8.js";import"./chunk-6QYXN73V-tPml5wjb.js";import"./chunk-BL2ZZSHG-BDLdsFeM.js";import"./chunk-7OLJDQMT-DqhdIuo6.js";import"./chunk-KRPLQIP4-Duu5zv9H.js";import"./CloseIcon-B6Be6esX.js";import"./components-BuCL6aou.js";import"./chunk-3ASUQ6PA-BkEgKCWb.js";import"./chunk-2OOHT3W5-CC38uFWT.js";import"./chunk-W7WUSNWJ-CwvPeB9a.js";import"./chunk-YQO7BFFX-BA4DVzl3.js";import"./chunk-MFVQSVQB-Bvk0kezP.js";import"./chunk-56K2BSAJ-Bys-b2nt.js";import"./chunk-H46NUPBZ-CGUTFX_3.js";import"./chunk-6CVSDS6C-BMnlnkqH.js";import"./chunk-3KCBMPN5-D8G8ZRLu.js";import"./chunk-46CXQZ4E-CqQSj_hs.js";import"./index-CIB9SwPf.js";import"./chunk-3Y4YXCR2-WVOthZPF.js";import"./index-BtnUei1e.js";import"./chunk-QURMB2UJ-Dpy63TOY.js";const H=()=>e.jsx(_,{width:"full",sx:{mt:8,mb:4},children:e.jsxs(j,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"center",gap:4,children:[e.jsx(o,{children:e.jsx(i,{})}),e.jsx(o,{children:e.jsx(i,{})}),e.jsx(o,{children:e.jsx(i,{})}),e.jsx(o,{children:e.jsx(i,{})}),e.jsx(o,{children:e.jsx(i,{})}),e.jsx(o,{children:e.jsx(i,{})}),e.jsx(o,{children:e.jsx(i,{})}),e.jsx(o,{children:e.jsx(i,{})})]})});function k(r){if(typeof r!="string"||r.length<1)return!1;const s=r[0];return s>="0"&&s<="9"?!1:/^[A-Za-z0-9_]*$/.test(r)}function Q(r){return k(r)?typeof r=="string"&&r[0]!=="_":!1}class X extends E{validate(s){if(typeof s=="string"){const t=s.trim();if(Q(s))return t}this.throwError(s)}}const Z=U({db_host:m().required("Ingrese el host de la base de datos"),db_port:c().required("Ingrese un puerto").typeError("Ingrese un número de puerto válido").test("is-port","Ingrese un puerto válido",r=>x(v,r)),db_user:m().required("Ingrese el usuario de la base de datos"),db_password:m().required("Ingrese la contraseña de la base de datos"),tango_dictionary:m().required("Ingrese el diccionario base de Tango").test("mssql-db-name","Ingrese un nombre de Diccionario base válido",r=>x(X,r)),db_connection_timeout_seconds:c().min(b,`El tiempo de espera debe ser mayor a ${b} segundos`).max(g,`El tiempo de espera debe ser menor a ${g} segundos`).required("Ingrese el tiempo de espera de la conexión a la base de datos").typeError("Ingrese el tiempo de espera de la conexión a la base de datos")}).required(),J=r=>{const{stateData:s}=r,t=w(),u=z(),{handleSubmit:h,control:a,reset:W,setError:C,formState:{errors:S,isSubmitting:I,isSubmitSuccessful:T}}=G({defaultValues:s,resolver:L(Z)}),n=T||I,N=async P=>{(await B(P,t)).map({success:l=>{u({title:O,status:"success"}),t.navigate(p)},error:l=>{u({title:l.errorInfoOrNull()?.error_description??y,status:"error"}),C("root",{message:l.info.error_description})}})};return e.jsx("form",{noValidate:!0,onSubmit:h(N),children:e.jsxs(_,{children:[e.jsx(V,{errors:S}),e.jsx(f,{children:e.jsxs(j,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(o,{children:e.jsx(d,{fieldProps:{name:"db_host",id:"db_host",type:"text"},formControlProps:{isDisabled:n},formControlInnerProps:{label:"Host"},control:a})}),e.jsx(o,{children:e.jsx(d,{fieldProps:{name:"db_port",id:"db_port",type:"number",inputMode:"tel",htmlSize:5,width:"auto"},formControlProps:{isDisabled:n},formControlInnerProps:{label:"Puerto"},control:a})}),e.jsx(o,{children:e.jsx(d,{fieldProps:{name:"db_user",id:"db_user",type:"text"},formControlProps:{isDisabled:n},formControlInnerProps:{label:"Usuario SQL"},control:a})}),e.jsx(o,{children:e.jsx(d,{fieldProps:{name:"db_password",id:"db_password",type:"password"},formControlProps:{isDisabled:n},formControlInnerProps:{label:"Contraseña SQL"},control:a})}),e.jsx(o,{children:e.jsx(d,{fieldProps:{name:"tango_dictionary",id:"tango_dictionary",type:"text"},formControlProps:{isDisabled:n},formControlInnerProps:{label:"Diccionario base"},control:a})}),e.jsx(o,{children:e.jsx(d,{fieldProps:{name:"db_connection_timeout_seconds",id:"db_connection_timeout_seconds",type:"number",inputMode:"tel",htmlSize:5,maxLength:5,width:"auto"},formControlProps:{isDisabled:n},formControlInnerProps:{label:"Tiempo de espera (segundos)"},control:a})})]})}),e.jsx(f,{children:e.jsx($,{isLoading:n,hideCancelButton:!0})})]})})},K=()=>{const{state:r,retry:s}=R({...F,silent:!0});return r.map({loading:t=>e.jsx(H,{}),error:({error:t})=>e.jsx(M,{error:t,retry:s,cancelAndNavigateTo:p}),success:t=>e.jsx(J,{stateData:t.data})})};function ve(){const r=D();return e.jsxs(e.Fragment,{children:[e.jsx(A,{title:q,returnButton:{buttonProps:{onClick:()=>{r(p)}}}}),e.jsx(K,{})]})}export{ve as default};
