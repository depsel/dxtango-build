import{j as e,u as N}from"./emotion-element-43c6fea0.browser.esm-B14dlTTQ.js";import{J as V,aB as H,U as _,$ as O}from"./auth_context-o-QFsdoP.js";import{p as U,V as z}from"./app-DHK1Xtws.js";import{S as G}from"./SettingsFormHeading-4dxgzrMK.js";import{a as L,b as $}from"./requests-6J8-6hNY.js";import{D as p,u as B}from"./useDXTApiFetch-CrYRM0vP.js";import{A as k}from"./ApiErrors-BF4FVKaX.js";import{F as n,a as h}from"./FormSkeletons-DRR2_CBk.js";import{B as D}from"./chunk-PULVB27S-CTGxufhx.js";import{G as u,a as s}from"./chunk-ZPFGWTBB-CvOtOCTn.js";import{c as X,e as b,a as l,f as g,d as Y,o as J}from"./index.esm-Dw-Md1--.js";import{u as K}from"./app_resources-v7SdCuXf.js";import{C as c}from"./CommonCard-CNKA2ktH.js";import{C as S}from"./ControlledCheckbox-DBqfAjlo.js";import{C as m}from"./ControlledInput-6nHeRWma.js";import{C as P}from"./ControlledTextarea-DrJmpSKb.js";import{F as Q}from"./FormErrors-CbGnKS3X.js";import{S as W}from"./SettingsFormButtons-xXBQWHLS.js";import{y as C}from"./utils-DQu-C9ov.js";import{A as I,a as T,V as Z}from"./misc_settings.consts-BHr1Rl5O.js";import"./order_settings.consts-BS2ZOo_e.js";import{u as ee}from"./chunk-6RSEZNRH-BQPG2CNv.js";import{H as x}from"./chunk-7OLJDQMT-DXq5cz3n.js";import"./ResponsiveIconButton-DPkbktow.js";import"./chunk-VMD3UMGK-H-jGd6rm.js";import"./chunk-6QYXN73V-DuvmeX8Y.js";import"./chunk-BL2ZZSHG-YlViSguk.js";import"./chunk-KRPLQIP4-CzoNRLSk.js";import"./CloseIcon-zI_k4qMr.js";import"./components-BGc_6s7t.js";import"./chunk-3ASUQ6PA-BtRLtW3F.js";import"./chunk-2OOHT3W5-BiVR3QPi.js";import"./chunk-YQO7BFFX-47bIbVCp.js";import"./chunk-MFVQSVQB-gFjt-wgC.js";import"./chunk-56K2BSAJ-sHIJjNP8.js";import"./chunk-CWVAJCXJ-Bx_GRDS0.js";import"./chunk-7D6N5TE5-xUeJJcj_.js";import"./index-BANIvhx6.js";import"./chunk-H46NUPBZ-bbDm42L7.js";import"./chunk-6CVSDS6C-HiurDJg9.js";import"./chunk-3KCBMPN5-CDYb5DH_.js";import"./chunk-46CXQZ4E-BGRD5_qx.js";import"./index-CIB9SwPf.js";import"./chunk-3Y4YXCR2-DQF11Gk3.js";import"./chunk-QURMB2UJ-lkfg7u0_.js";class se extends V{validate(d){let t=d;if(typeof t=="string"&&(t=t.trim().toLowerCase(),H(t)))return t;this.throwError(d)}}const re=()=>e.jsx(D,{width:"full",sx:{mt:8,mb:4},children:e.jsxs(u,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"center",gap:4,children:[e.jsx(s,{children:e.jsx(n,{})}),e.jsx(s,{children:e.jsx(n,{})}),e.jsx(s,{children:e.jsx(n,{})}),e.jsx(s,{children:e.jsx(n,{})}),e.jsx(s,{colSpan:{md:2},children:e.jsx(p,{})}),e.jsx(s,{children:e.jsx(n,{})}),e.jsx(s,{children:e.jsx(n,{})}),e.jsx(s,{colSpan:{md:2},children:e.jsx(p,{})}),e.jsx(s,{colSpan:{md:2},children:e.jsx(n,{})}),e.jsx(s,{colSpan:{md:2},children:e.jsx(h,{})}),e.jsx(s,{colSpan:{md:2},children:e.jsx(p,{})}),e.jsx(s,{colSpan:{md:2},children:e.jsx(n,{})}),e.jsx(s,{colSpan:{md:2},children:e.jsx(h,{})}),e.jsx(s,{children:e.jsx(n,{})}),e.jsx(s,{children:e.jsx(n,{})})]})}),te=X({smtp_enabled:b().required(),smtp_host:l().required("Ingrese el host SMTP").test("valid-host","Ingrese un host SMTP válido",a=>C(se,a)),smtp_username:l().required("Ingrese el usuario SMTP"),smtp_password:l().required("Ingrese la contraseña SMTP"),smtp_port:g().required("Ingrese el puerto SMTP").typeError("Ingrese un número de puerto SMTP válido").test("is-port","Ingrese un puerto SMTP válido",a=>C(Z,a)),smtp_use_tls:b().required(),smtp_from_email:l().required("Ingrese el correo electrónico de salida").email("Ingrese un correo electrónico válido"),auth_expiration_days:g().min(I,`El tiempo de espera debe ser mayor a ${I}`).max(T,`El tiempo de espera debe ser menor a ${T}`).required("Ingrese el tiempo de espera para logout").typeError("Ingrese el tiempo de espera para logout"),admin_email:l().required("Ingrese el correo electrónico del Administrador").email("Ingrese un correo electrónico válido"),user_warning_message_title:l().required("Ingrese el título del mensaje de advertencia"),user_warning_message_content:l().required("Ingrese el contenido del mensaje de advertencia"),user_disabled_message_title:l().required("Ingrese el título del mensaje de inhabilitación"),user_disabled_message_content:l().required("Ingrese el contenido del mensaje de inhabilitación"),order_warning_message:l()}).required(),oe=a=>{const{stateData:d}=a,t=K(),f=ee(),{handleSubmit:y,control:o,reset:ae,setError:M,formState:{errors:w,isSubmitting:A,isSubmitSuccessful:E},watch:v}=Y({defaultValues:d,resolver:J(te)}),q=v("smtp_enabled"),r=E||A,i=r||!q,R=async F=>{(await L(F,t)).map({success:j=>{f({title:U,status:"success"}),t.navigate(_)},error:j=>{f({title:j.errorInfoOrNull()?.error_description??O}),M("root",{message:j.info.error_description})}})};return e.jsx("form",{noValidate:!0,onSubmit:y(R),children:e.jsxs(D,{children:[e.jsx(Q,{errors:w}),e.jsx(c,{children:e.jsxs(u,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(s,{colSpan:{md:2},children:e.jsx(x,{size:"sm",textTransform:"uppercase",children:"Mensajes"})}),e.jsx(s,{colSpan:{md:2},children:e.jsx(m,{fieldProps:{name:"user_warning_message_title",id:"user_warning_message_title",type:"text",isDisabled:r},formControlProps:{isDisabled:r},formControlInnerProps:{label:"Título del mensaje de advertencia"},control:o})}),e.jsx(s,{colSpan:{md:2},children:e.jsx(P,{fieldProps:{name:"user_warning_message_content",id:"user_warning_message_content",isDisabled:r},formControlProps:{isDisabled:r},formControlInnerProps:{label:"Contenido del mensaje de advertencia"},control:o})}),e.jsx(s,{colSpan:{md:2},children:e.jsx(p,{})}),e.jsx(s,{colSpan:{md:2},children:e.jsx(m,{fieldProps:{name:"user_disabled_message_title",id:"user_disabled_message_title",type:"text",isDisabled:r},formControlProps:{isDisabled:r},formControlInnerProps:{label:"Título del mensaje de inhabilitación"},control:o})}),e.jsx(s,{colSpan:{md:2},children:e.jsx(P,{fieldProps:{name:"user_disabled_message_content",id:"user_disabled_message_content",isDisabled:r},formControlProps:{isDisabled:r},formControlInnerProps:{label:"Contenido del mensaje de inhabilitación"},control:o})})]})}),e.jsx(c,{children:e.jsxs(u,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(s,{colSpan:{md:2},children:e.jsx(x,{size:"sm",textTransform:"uppercase",children:"Administrador"})}),e.jsx(s,{children:e.jsx(m,{fieldProps:{name:"admin_email",id:"admin_email",type:"text",inputMode:"email",htmlSize:30,width:"auto",isDisabled:r},formControlProps:{isDisabled:r},formControlInnerProps:{label:"Correo electrónico"},control:o})})]})}),e.jsx(c,{children:e.jsxs(u,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(s,{colSpan:{md:2},children:e.jsx(x,{size:"sm",textTransform:"uppercase",children:"Sesiones"})}),e.jsx(s,{children:e.jsx(m,{fieldProps:{name:"auth_expiration_days",id:"auth_expiration_days",type:"number",inputMode:"tel",htmlSize:5,maxLength:5,width:"auto",isDisabled:r},formControlProps:{isDisabled:r},formControlInnerProps:{label:"Tiempo de espera para logout (en días)"},control:o})})]})}),e.jsx(c,{children:e.jsxs(u,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(s,{colSpan:{md:2},children:e.jsx(x,{size:"sm",textTransform:"uppercase",children:"Envío de correo SMTP"})}),e.jsx(s,{colSpan:{md:2},children:e.jsx(S,{control:o,fieldProps:{id:"smtp_enabled",name:"smtp_enabled"},formControlProps:{isDisabled:r},formControlInnerProps:{text:"Habilitado"}})}),e.jsx(s,{colSpan:{md:2},children:e.jsx(p,{})}),e.jsx(s,{children:e.jsx(m,{fieldProps:{name:"smtp_host",id:"smtp_host",type:"text",isDisabled:i},formControlProps:{isDisabled:i},formControlInnerProps:{label:"Host"},control:o})}),e.jsx(s,{children:e.jsx(m,{fieldProps:{name:"smtp_username",id:"smtp_username",type:"text",isDisabled:i},formControlProps:{isDisabled:i},formControlInnerProps:{label:"Usuario"},control:o})}),e.jsx(s,{children:e.jsx(m,{fieldProps:{name:"smtp_password",id:"smtp_password",type:"text",isDisabled:i},formControlProps:{isDisabled:i},formControlInnerProps:{label:"Contraseña"},control:o})}),e.jsx(s,{children:e.jsx(m,{fieldProps:{name:"smtp_port",id:"smtp_port",type:"number",inputMode:"tel",htmlSize:5,maxLength:5,width:"auto",isDisabled:i},formControlProps:{isDisabled:i},formControlInnerProps:{label:"Puerto"},control:o})}),e.jsx(s,{children:e.jsx(S,{control:o,fieldProps:{id:"smtp_use_tls",name:"smtp_use_tls",isDisabled:i},formControlInnerProps:{text:"Usar TLS"}})}),e.jsx(s,{colSpan:{md:2},children:e.jsx(p,{})}),e.jsx(s,{children:e.jsx(m,{fieldProps:{name:"smtp_from_email",id:"smtp_from_email",type:"text",inputMode:"email",htmlSize:30,width:"auto",isDisabled:i},formControlProps:{isDisabled:i},formControlInnerProps:{label:"Correo electrónico de salida"},control:o})})]})}),e.jsx(c,{children:e.jsx(W,{isLoading:r,hideCancelButton:!0})})]})})},ie=()=>{const{state:a,retry:d}=B({...$,silent:!0});return a.map({loading:t=>e.jsx(re,{}),error:({error:t})=>e.jsx(k,{error:t,retry:d,cancelAndNavigateTo:_}),success:t=>e.jsx(oe,{stateData:t.data})})};function es(){const a=N();return e.jsxs(e.Fragment,{children:[e.jsx(G,{title:z,returnButton:{buttonProps:{onClick:()=>{a(_)}}}}),e.jsx(ie,{})]})}export{es as default};
