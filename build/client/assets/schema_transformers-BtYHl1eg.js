import{j as e,r as I,g as ye}from"./emotion-element-5486c51c.browser.esm-CMT9BBIk.js";import{L as Ue,aV as Le,X as V,I as de,k as Re,b8 as Oe,b9 as Ne,j as Ve,a6 as Fe,U as Me,a2 as Ge}from"./auth_context-CCfWU2Jo.js";import{A as qe}from"./ApiErrors-Blpol96Y.js";import{F as n}from"./FormSkeletons-Ch1cmlVo.js";import{G as ae,a as i}from"./chunk-ZPFGWTBB-Bu2gzu07.js";import{H as c}from"./chunk-3ASUQ6PA-BkEgKCWb.js";import{B as pe,S as re}from"./chunk-PULVB27S-C1tz_n3L.js";import{D as g}from"./chunk-W7WUSNWJ-CwvPeB9a.js";import{u as ue,d as ke,o as ze,f as E,a as v,e as f,c as D}from"./index.esm-CzxlHhdA.js";import{a as X,F as H,b as W}from"./useDXTApiFetch-D7fvlkDE.js";import{i as $e}from"./AccountCancelIcon-B2VjX7I2.js";import{u as Be}from"./app_resources-Di8KxAHS.js";import{u as Y}from"./useTangoList-DPObdK6h.js";import{x as Xe,y as He}from"./app-DHK1Xtws.js";import{C as Q}from"./CommonCard-CfkzH5Am.js";import{C as R}from"./ControlledInput-BKce-7V6.js";import{R as We,a as Ye}from"./chunk-RDF2AYID-Ckn2v1iE.js";import{F as ie,a as Qe}from"./chunk-56K2BSAJ-Bys-b2nt.js";import{C as Z}from"./ControlledSelect-DDMsMwex.js";import{S as Ze}from"./chunk-VTV6N5LE-DMsBM71Z.js";import{F as me}from"./chunk-H46NUPBZ-CGUTFX_3.js";import{F as Je}from"./FormErrors-COO1VgQ3.js";import{P as Ke,d as ea,V as aa}from"./vo_dxt_password-DQJmTFQe.js";import{I as J}from"./InlineError-D86JcCJL.js";import{S as ra}from"./SettingsFormButtons-BcygzEqX.js";import{u as ia}from"./chunk-6RSEZNRH-p2hFl890.js";import{H as O}from"./chunk-7OLJDQMT-DqhdIuo6.js";import{y as _e}from"./utils-DQu-C9ov.js";import{V as oa}from"./vo_user_name-DRov8-rC.js";class oe extends Ue{validate(a){let o=a;typeof o!="string"&&this.throwError(a);try{if(Le.isUUID(o,4))return o}catch{}this.throwError(a)}static random(){return new oe(sa())}}function sa(){let r=new Date().getTime(),a=0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){let s=Math.random()*16;return r>0?(s=(r+s)%16|0,r=Math.floor(r/16)):(s=(a+s)%16|0,a=Math.floor(a/16)),(o==="x"?s:s&3|8).toString(16)})}const na=()=>e.jsx(pe,{width:"full",sx:{mt:8,mb:4},children:e.jsxs(ae,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"center",gap:4,children:[e.jsx(i,{colSpan:{md:2},children:e.jsx(n,{})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(n,{})}),e.jsx(i,{children:e.jsx(n,{})}),e.jsx(i,{children:e.jsx(n,{})}),e.jsx(i,{children:e.jsx(n,{})}),e.jsx(i,{children:e.jsx(n,{})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(g,{})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(n,{})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(n,{})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(g,{})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(n,{})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(n,{})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(g,{})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(n,{})}),e.jsx(i,{colSpan:{md:2},children:e.jsxs(re,{spacing:4,direction:{base:"column"},children:[e.jsx(c,{spacing:4,children:e.jsx(n,{})}),e.jsx(c,{spacing:4,children:e.jsx(n,{})}),e.jsx(c,{spacing:4,children:e.jsx(n,{})}),e.jsx(c,{spacing:4,children:e.jsx(n,{})}),e.jsx(c,{spacing:4,children:e.jsx(n,{})}),e.jsx(c,{spacing:4,children:e.jsx(n,{})}),e.jsx(c,{spacing:4,children:e.jsx(n,{})}),e.jsx(c,{spacing:4,children:e.jsx(n,{})})]})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(g,{})}),e.jsx(i,{children:e.jsx(n,{})}),e.jsx(i,{}),e.jsx(i,{children:e.jsx(n,{})}),e.jsx(i,{children:e.jsx(n,{})}),e.jsx(i,{children:e.jsx(n,{})}),e.jsx(i,{children:e.jsx(n,{})}),e.jsx(i,{children:e.jsx(n,{})}),e.jsx(i,{children:e.jsx(n,{})}),e.jsx(i,{children:e.jsx(n,{})}),e.jsx(i,{children:e.jsx(n,{})}),e.jsx(i,{children:e.jsx(n,{})})]})});function ta(r){return r&&typeof r=="object"&&"default"in r?r.default:r}var N=ta(I),la=Object.assign||function(r){for(var a=1;a<arguments.length;a++){var o=arguments[a];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])}return r},da=function(r,a){var o={};for(var s in r)a.indexOf(s)>=0||Object.prototype.hasOwnProperty.call(r,s)&&(o[s]=r[s]);return o},ce=function(a){var o=a.color,s=o===void 0?"currentColor":o,d=a.size,p=d===void 0?24:d;a.children;var u=da(a,["color","size","children"]),x="mdi-icon "+(u.className||"");return N.createElement("svg",la({},u,{className:x,width:p,height:p,fill:s,viewBox:"0 0 24 24"}),N.createElement("path",{d:"M12 2C17.5 2 22 6.5 22 12S17.5 22 12 22 2 17.5 2 12 6.5 2 12 2M12 4C10.1 4 8.4 4.6 7.1 5.7L18.3 16.9C19.3 15.5 20 13.8 20 12C20 7.6 16.4 4 12 4M16.9 18.3L5.7 7.1C4.6 8.4 4 10.1 4 12C4 16.4 7.6 20 12 20C13.9 20 15.6 19.4 16.9 18.3Z"}))},ca=N.memo?N.memo(ce):ce,pa=ca;const ua=ye(pa),ma=V("/tango/lista","GET"),_a=V("/tango/perfil","GET"),fa=V("/tango/cliente","GET"),xa=V("/tango/vendedor","GET"),ha=r=>{const{fieldProps:a,formControlProps:o,formControlInnerProps:s,stackProps:d,radioProps:p,control:u}=r,{name:x}=a,{helperText:h}=s||{},{field:{ref:j,onChange:S,value:_},fieldState:{invalid:m},formState:{errors:w}}=ue({name:a.name,control:u});return e.jsxs(ie,{...o,isInvalid:m,children:[e.jsx(We,{...a,onChange:S,value:_.toString(),ref:j,children:e.jsx(re,{direction:"row",spacing:4,...d,children:a.options.map((P,G)=>e.jsx(Ye,{value:P.value.toString(),...p,children:P.label},`${x}-option-${G}`))})}),h!=null&&e.jsx(Qe,{children:h})]})},b=r=>{const{fieldProps:a,formControlProps:o,formControlInnerProps:s,control:d,watch:p}=r,{label:u}=s||{},{field:{ref:x,onChange:h,onBlur:j,value:S},fieldState:{invalid:_},formState:{errors:m}}=ue({name:a.name,control:d});return e.jsxs(ie,{display:"flex",alignItems:"center",...o,isInvalid:_,children:[e.jsx(Ze,{...a,...p,isChecked:S,onChange:w=>h(w.target.checked),onBlur:j,ref:x}),u!=null&&e.jsx(me,{htmlFor:a.id,sx:{mb:0,ms:4},color:a.isDisabled===!0?"gray.500":void 0,cursor:"pointer",children:u})]})};function ja(r){const[a,o]=I.useState(null);return{yupValidationSchema:r(a,o),passwordStatus:a}}const K=0,ee=365,ba=30,fe=r=>{const{stateData:a,typeSettings:o,returnUrl:s,title:d,schemaMaker:p,schemaDataToApiInput:u,saveUserCall:x}=r;I.useRef(oe.random().valueOf());const h=Be(),j=ia(),{yupValidationSchema:S,passwordStatus:_}=ja(p),{state:m,result:w}=Y({endpoint:_a,fieldsMap:{label:"name",value:"id"}}),{state:P,result:G}=Y({endpoint:o.userType==="cliente"?fa:xa,fieldsMap:{label:"screen_name",value:"id",isEnabled:"habilitado"},disabledIcon:e.jsx(de,{as:$e,color:"red.400",ml:2,boxSize:5})}),{state:se,result:Se}=Y({endpoint:ma,fieldsMap:{label:"nombre",value:"id",isEnabled:"habilitada"},disabledIcon:e.jsx(de,{as:ua,color:"red.400",ml:2,boxSize:5})}),q=a!==null;let k;q?k={username:a.username,email:a.email??"",tango_id:a.tango_id,id_lista_adicional:a.id_lista_adicional===null?0:a.id_lista_adicional,bonificacion_lista_adicional:a.bonificacion_lista_adicional===null?0:a.bonificacion_lista_adicional,bonificacion_lista_adicional_switch:a.bonificacion_lista_adicional!=null,perfil_facturacion_id:a.perfil_facturacion_id,habilitado_en_dxt:a.habilitado_en_dxt,puede_crear_pedido:a.puede_crear_pedido,puede_editar_pedido:a.puede_editar_pedido,puede_anular_pedido:a.puede_anular_pedido,borrar_pedido_al_anular:a.borrar_pedido_al_anular,aprobar_pedido_al_crear:a.aprobar_pedido_al_crear,ver_pedidos_cumplidos:a.ver_pedidos_cumplidos,ver_sin_precio:a.ver_sin_precio,mostrar_mensaje_de_advertencia:a.mostrar_mensaje_de_advertencia,dia_de_entrega:a.dia_de_entrega}:k={username:"",password:"",email:"",tango_id:0,perfil_facturacion_id:0,id_lista_adicional:0,bonificacion_lista_adicional:0,bonificacion_lista_adicional_switch:!1,habilitado_en_dxt:!0,puede_crear_pedido:!0,puede_editar_pedido:!0,ver_pedidos_cumplidos:!0,ver_sin_precio:!1,mostrar_mensaje_de_advertencia:!1,puede_anular_pedido:!1,borrar_pedido_al_anular:!1,aprobar_pedido_al_crear:!1,dia_de_entrega:ba};const Pe=!1,{handleSubmit:Ce,control:l,resetField:A,setError:Ee,watch:T,formState:{errors:Ie,isSubmitting:ve,isSubmitSuccessful:De}}=ke({defaultValues:k,resolver:ze(S)}),y=T("puede_anular_pedido"),ne=T("perfil_facturacion_id"),z=T("bonificacion_lista_adicional_switch"),U=T("id_lista_adicional");I.useEffect(()=>{y===!1&&A("borrar_pedido_al_anular",{defaultValue:!1})},[y]),I.useEffect(()=>{if(z===!1&&m.isSuccess()){const C=m.data.find(te=>te.id===ne)?.bonificacion??0;A("bonificacion_lista_adicional",{defaultValue:C})}U===0&&(A("bonificacion_lista_adicional",{defaultValue:0}),A("bonificacion_lista_adicional_switch",{defaultValue:!1}))},[m.isSuccess(),U,z,ne]);const t=De||ve,we=async C=>{const{bonificacion_lista_adicional_switch:te,...L}=C,Te={...C,email:L.email===""?void 0:L.email,password:L.password===""?void 0:L.password},le=u(Te);if(le==null){j({title:Ne(Ve.INVALID_PARAMETER),status:"error"});return}(await x(le,h)).map({success:B=>{j({title:q?Xe:He,status:"success"}),h.navigate(s)},error:B=>{j({title:B.errorInfoOrNull()?.error_description??Fe,status:"error"}),Ee("root",{message:B.info.error_description})}})},Ae=t||U===0||z===!1,$=t||U===0;return e.jsx("form",{noValidate:!0,onSubmit:Ce(we),children:e.jsxs(pe,{children:[e.jsx(Je,{errors:Ie}),e.jsx(Q,{children:e.jsxs(ae,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(i,{colSpan:{md:2},children:e.jsx(O,{size:"sm",textTransform:"uppercase",children:d})}),e.jsxs(i,{colSpan:{md:2},children:[e.jsx(Z,{fieldProps:{name:"tango_id",placeholder:o.tangoRelatedFields?.placeholder,options:G,noOptionsMessage(C){return o.tangoRelatedFields?.empty},isSearchable:!0,selectedOptionStyle:"check",isLoading:P instanceof X,virtualized:!0},formControlProps:{isDisabled:t||!(P instanceof H)},formControlInnerProps:{label:o.tangoRelatedFields?.label},control:l}),P instanceof W&&e.jsx(J,{error:P.errorOrNull().error})]}),e.jsx(i,{children:e.jsx(R,{fieldProps:{name:"username",id:"username",type:"text"},formControlProps:{isDisabled:t},formControlInnerProps:{label:"Nombre de Usuario"},control:l})}),e.jsx(i,{children:e.jsx(Ke,{fieldProps:{name:"password",id:"password"},formControlInnerProps:{label:"Contraseña"},passwordStatus:_,disableForm:t,control:l})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(R,{fieldProps:{name:"email",id:"email",type:"text",inputMode:"email"},formControlProps:{isDisabled:t},formControlInnerProps:{label:"Correo electrónico"},control:l})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(g,{})}),e.jsxs(i,{colSpan:{md:2},children:[e.jsx(Z,{fieldProps:{name:"perfil_facturacion_id",placeholder:"Seleccione un perfil",options:w,noOptionsMessage(C){return"No hay perfiles disponibles"},isLoading:m instanceof X,selectedOptionStyle:"check"},formControlProps:{isDisabled:t||!(m instanceof H)},control:l,formControlInnerProps:{label:"Perfil de facturación"}}),m instanceof W&&e.jsx(J,{error:m.errorOrNull().error})]}),e.jsxs(i,{children:[e.jsx(Z,{fieldProps:{name:"id_lista_adicional",options:[{label:"NINGUNA",value:0},...Se],noOptionsMessage(C){return"No hay listas adicionals"},isLoading:se instanceof X,selectedOptionStyle:"check"},formControlProps:{isDisabled:t||!(se instanceof H)},formControlInnerProps:{label:"Lista de precios adicional"},control:l}),m instanceof W&&e.jsx(J,{error:m.errorOrNull().error})]}),!$&&e.jsxs(i,{children:[e.jsx(ie,{isDisabled:$,children:e.jsx(me,{children:"Bonificación lista adicional (%)"})}),e.jsxs(c,{children:[e.jsx(R,{formControlProps:{width:"auto",isDisabled:Ae},fieldProps:{name:"bonificacion_lista_adicional",id:"bonificacion_lista_adicional",type:"text",inputMode:"tel",textAlign:"end",htmlSize:5,maxLength:5,minWidth:120},control:l}),e.jsx(b,{fieldProps:{name:"bonificacion_lista_adicional_switch",id:"bonificacion_lista_adicional_switch"},formControlProps:{width:"auto",isDisabled:$},control:l})]})]}),Pe,e.jsx(i,{colSpan:{md:2},children:e.jsx(g,{})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(O,{size:"sm",textTransform:"uppercase",children:"Estado"})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(ha,{fieldProps:{name:"habilitado_en_dxt",options:[{value:!0,label:"Establecido en Tango"},{value:!1,label:"Deshabilitado"}]},formControlProps:{isDisabled:t},radioProps:{size:{base:"sm",sm:"md"}},control:l})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(g,{})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(O,{size:"sm",textTransform:"uppercase",children:"Comunicación"})}),e.jsx(i,{children:e.jsx(b,{fieldProps:{name:"mostrar_mensaje_de_advertencia",id:"mostrar_mensaje_de_advertencia"},formControlProps:{width:"auto",isDisabled:t},formControlInnerProps:{label:"Mostrar mensaje de advertencia"},control:l})})]})}),e.jsx(Q,{children:e.jsxs(ae,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"start",gap:4,children:[e.jsx(i,{colSpan:{md:2},children:e.jsx(O,{size:"sm",textTransform:"uppercase",children:"Pedidos"})}),e.jsx(i,{colSpan:{md:2},children:e.jsxs(re,{spacing:4,direction:{base:"column"},children:[e.jsx(c,{spacing:4,children:e.jsx(b,{fieldProps:{name:"puede_crear_pedido",id:"puede_crear_pedido"},formControlProps:{width:"auto",isDisabled:t},formControlInnerProps:{label:"Puede crear pedidos"},control:l})}),e.jsx(c,{spacing:4,children:e.jsx(b,{fieldProps:{name:"puede_editar_pedido",id:"puede_editar_pedido"},formControlProps:{width:"auto",isDisabled:t},formControlInnerProps:{label:"Puede editar pedidos"},control:l})}),e.jsx(c,{spacing:4,children:e.jsx(b,{fieldProps:{name:"puede_anular_pedido",id:"puede_anular_pedido"},formControlProps:{width:"auto",isDisabled:t},formControlInnerProps:{label:"Puede anular pedidos"},control:l})}),e.jsx(c,{spacing:4,children:e.jsx(b,{fieldProps:{name:"borrar_pedido_al_anular",id:"borrar_pedido_al_anular"},formControlProps:{width:"auto",isDisabled:t},formControlInnerProps:{label:"Borrar pedido al anular"},control:l,watch:{isDisabled:y===!1,...y===!1&&{isChecked:!1}}})}),e.jsx(c,{spacing:4,children:e.jsx(b,{fieldProps:{name:"aprobar_pedido_al_crear",id:"aprobar_pedido_al_crear"},formControlProps:{width:"auto",isDisabled:t},formControlInnerProps:{label:"Los pedidos se aprueban al crearlos"},control:l})}),e.jsx(c,{spacing:4,children:e.jsx(b,{fieldProps:{name:"ver_pedidos_cumplidos",id:"ver_pedidos_cumplidos"},formControlProps:{width:"auto",isDisabled:t},formControlInnerProps:{label:"Puede ver los pedidos cumplidos"},control:l})}),e.jsx(c,{spacing:4,children:e.jsx(b,{fieldProps:{name:"ver_sin_precio",id:"ver_sin_precio"},formControlProps:{width:"auto",isDisabled:t},formControlInnerProps:{label:"Puede ver artículos sin precio"},control:l})})]})}),e.jsx(i,{colSpan:{md:2},children:e.jsx(g,{})}),e.jsx(i,{children:e.jsx(R,{fieldProps:{name:"dia_de_entrega",id:"dia_de_entrega",type:"number",inputMode:"tel"},formControlProps:{isDisabled:t},formControlInnerProps:{label:"Tiempo de entrega (en días)"},control:l})}),e.jsx(i,{})]})}),e.jsx(Q,{children:e.jsx(ra,{buttonActionText:q?Re:Oe,isLoading:t,hideCancelButton:!0})})]})})};function Ja(r){const{typeSettings:a,id:o,returnUrl:s,title:d,schemaMaker:p,schemaDataToApiInput:u,useGetOneHook:x,saveUserCall:h}=r,{state:j,retry:S}=x(o);return j.map({loading:_=>e.jsx(na,{}),error:({error:_})=>e.jsx(qe,{error:_,retry:S,cancelAndNavigateTo:Me}),success:_=>e.jsx(fe,{stateData:_.data,typeSettings:a,returnUrl:s,title:d,schemaMaker:p,schemaDataToApiInput:u,saveUserCall:h})})}function Ka(r){const{typeSettings:a,returnUrl:o,title:s,schemaMaker:d,schemaDataToApiInput:p,saveUserCall:u}=r;return e.jsx(fe,{stateData:null,typeSettings:a,returnUrl:o,title:s,schemaMaker:d,schemaDataToApiInput:p,saveUserCall:u})}const ga="admin",xe={tango_id:E().integer().min(1,"Seleccione un cliente de Tango").required("Seleccione un cliente de Tango").typeError("Seleccione un cliente de Tango"),username:v().required("Ingrese un nombre de usuario").test("username","Ingrese un nombre de usuario válido",r=>_e(oa,r)?r.toLowerCase()!=ga:!1),email:v().email("Ingrese un correo electrónico válido"),perfil_facturacion_id:E().integer().min(1,"Seleccione un perfil de facturación").required("Seleccione un perfil de facturación").typeError("Seleccione un perfil de facturación"),id_lista_adicional:E().integer(),bonificacion_lista_adicional:E().when(["id_lista_adicional"],{is:r=>r>0,then:r=>r.required("Ingrese una bonificación válida").typeError("Ingrese una bonificación válida").min(0,"La bonificación debe encontrarse entre 0 y 100%").max(100,"La bonificación debe encontrarse entre 0 y 100%"),otherwise:r=>r}),bonificacion_lista_adicional_switch:f(),dia_de_entrega:E().integer(`El tiempo de entrega de pedidos debe ser un un número entero entre ${K} y ${ee}`).min(K,`El tiempo de entrega de pedidos debe ser mayor o igual a ${K} días`).max(ee,`El tiempo de entrega de pedidos no puede superar los ${ee} días`).required("Ingrese el número de días para entrega de pedidos").typeError("Ingrese el número de días para entrega de pedidos"),habilitado_en_dxt:f().required(),puede_crear_pedido:f().required(),puede_editar_pedido:f().required(),ver_pedidos_cumplidos:f().required(),ver_sin_precio:f().required(),mostrar_mensaje_de_advertencia:f().required(),puede_anular_pedido:f().required(),borrar_pedido_al_anular:f().required(),aprobar_pedido_al_crear:f().required()},Sa={...xe,password:v()};D(Sa);function F(r,a,o){return{...xe,password:r.test("password","Formato de contraseña no válido",s=>{if(s!=""&&s!=null){let d=ea(s);return Ge.isEqual(a,d)||o(d),_e(aa,s)}return!0})}}const he={},je={},be=v(),ge=v().required("Ingrese una contraseña");function er(r,a){const o=F(ge,r,a);return D({...o,...je}).required()}function ar(r,a){const o=F(be,r,a);return D({...o,...he,...je}).required()}function rr(r,a){const o=F(ge,r,a);return D(o).required()}function ir(r,a){const o=F(be,r,a);return D({...o,...he}).required()}function M(r){const{id_lista_adicional:a,bonificacion_lista_adicional_switch:o,bonificacion_lista_adicional:s,...d}=r,p=a!=null&&a>0;return{...d,id_lista_adicional:p?a:void 0,bonificacion_lista_adicional:p&&o===!0?s:void 0}}function or(r){const{password:a,...o}=M(r);return a==null?null:{...o,password:a}}function sr(r){const{...a}=M(r);return{...a}}function nr(r){const{password:a,...o}=M(r);return a==null?null:{...o,password:a}}function tr(r){const{...a}=M(r);return{...a}}export{Ja as D,Ka as a,er as b,nr as c,rr as d,or as e,ir as f,sr as g,ar as m,tr as t};
