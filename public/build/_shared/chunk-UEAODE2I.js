import{a as Bt,b as kt,c as Ft,d as Nt,e as Gt,f as Wt,g as Ut,h as $t}from"/build/_shared/chunk-H2HV4GBI.js";import{a as Dt,b as vt,e as Lt,f as yt,i as So,j as X}from"/build/_shared/chunk-EXONEW77.js";import{a as wt,b as Ze,c as Ht,g as Ke,h as Mt}from"/build/_shared/chunk-SP4F5HSS.js";import{a as xo,b as oe}from"/build/_shared/chunk-UUQUN6O2.js";import{a as Se,b as ze}from"/build/_shared/chunk-KJRI7O4Y.js";import{a as J,b as Q}from"/build/_shared/chunk-3E6R7P2Z.js";import{a as xe}from"/build/_shared/chunk-HTTKQLCQ.js";import{a as Ot}from"/build/_shared/chunk-6RHVNQC3.js";import{a as Io,f as At}from"/build/_shared/chunk-SSPXWVUV.js";import{a as qe,b as zt}from"/build/_shared/chunk-JH3DW3YR.js";import{d as te}from"/build/_shared/chunk-KWCD7EI4.js";import{b as Et,r as Ct,s as It,y as xt,z as St}from"/build/_shared/chunk-7FZKV7GZ.js";import{$b as ne,Ac as ee,Bc as Tt,Cc as Ve,Dc as Xe,Ea as he,Eb as mt,Fb as pt,Ha as at,Hb as ft,I as tt,Ib as Ge,Ic as Ie,J as ot,Jb as N,K as it,Mb as K,Ob as ut,P as rt,Pb as We,Qb as c,Rb as S,Sb as E,Tb as ht,Ua as U,Va as $,Xa as V,Xb as Ue,Zb as gt,_ as Fe,aa as pe,ac as _t,bc as Rt,cc as Pt,da as nt,dc as ge,ec as _e,fa as fe,ga as ue,gb as lt,ha as st,ic as Re,jc as Pe,kc as be,lc as Te,ob as ct,tc as $e,vc as Ae,wc as bt,xa as dt,xc as Y,yb as Ne,yc as Ee,zc as Ce}from"/build/_shared/chunk-X7PKD636.js";import{a as Z,b as u}from"/build/_shared/chunk-IS2TAHEU.js";import{c as et,e as d,h as a}from"/build/_shared/chunk-P3O6KQPX.js";var Zt=et((Wo,qt)=>{"use strict";a();function zo(o){return o&&typeof o=="object"&&"default"in o?o.default:o}var Oe=zo(Z()),Oo=Object.assign||function(o){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(o[i]=e[i])}return o},Do=function(o,t){var e={};for(var i in o)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);return e},Xt=function(t){var e=t.color,i=e===void 0?"currentColor":e,s=t.size,p=s===void 0?24:s,_=t.children,R=Do(t,["color","size","children"]),f="mdi-icon "+(R.className||"");return Oe.createElement("svg",Oo({},R,{className:f,width:p,height:p,fill:i,viewBox:"0 0 24 24"}),Oe.createElement("path",{d:"M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z"}))},vo=Oe.memo?Oe.memo(Xt):Xt;qt.exports=vo});var Ro=et((or,_o)=>{"use strict";a();function wo(o){return o&&typeof o=="object"&&"default"in o?o.default:o}var we=wo(Z()),Ho=Object.assign||function(o){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(o[i]=e[i])}return o},Mo=function(o,t){var e={};for(var i in o)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);return e},go=function(t){var e=t.color,i=e===void 0?"currentColor":e,s=t.size,p=s===void 0?24:s,_=t.children,R=Mo(t,["color","size","children"]),f="mdi-icon "+(R.className||"");return we.createElement("svg",Ho({},R,{className:f,width:p,height:p,fill:i,viewBox:"0 0 24 24"}),we.createElement("path",{d:"M11 15H6L13 1V9H18L11 23V15Z"}))},Bo=we.memo?we.memo(go):go;_o.exports=Bo});a();a();var C=d(u(),1),Vt=()=>(0,C.jsx)(E,{width:"full",sx:{mt:8,mb:4},children:(0,C.jsxs)(N,{templateColumns:"1fr",alignItems:"center",gap:4,children:[(0,C.jsx)(c,{children:(0,C.jsx)(J,{})}),(0,C.jsx)(c,{children:(0,C.jsx)(Q,{height:"120px"})}),(0,C.jsx)(c,{children:(0,C.jsx)(Q,{height:"120px"})}),(0,C.jsx)(c,{children:(0,C.jsx)(Q,{height:"120px"})}),(0,C.jsx)(c,{children:(0,C.jsx)(Q,{height:"120px"})}),(0,C.jsx)(c,{children:(0,C.jsx)(Q,{height:"120px"})}),(0,C.jsx)(c,{children:(0,C.jsx)(Q,{height:"120px"})})]})});a();a();var q=d(Z(),1);var ro=d(dt(),1),no=d(So(),1),so=d(Zt(),1);a();var Qt=d(Z(),1);var jt=d(dt(),1),eo=d(Io(),1),to=d(xo(),1);a();var ve=d(Z()),y;typeof window<"u"?y=window:typeof self<"u"?y=self:y=globalThis;var Qe=null,je=null,Kt=20,Ye=y.clearTimeout,Yt=y.setTimeout,Je=y.cancelAnimationFrame||y.mozCancelAnimationFrame||y.webkitCancelAnimationFrame,Jt=y.requestAnimationFrame||y.mozRequestAnimationFrame||y.webkitRequestAnimationFrame;Je==null||Jt==null?(Qe=Ye,je=function(t){return Yt(t,Kt)}):(Qe=function([t,e]){Je(t),Ye(e)},je=function(t){let e=Jt(function(){Ye(i),t()}),i=Yt(function(){Je(e),t()},Kt);return[e,i]});function Lo(o){let t,e,i,s,p,_,R,f=typeof document<"u"&&document.attachEvent;if(!f){_=function(l){let g=l.__resizeTriggers__,L=g.firstElementChild,k=g.lastElementChild,W=L.firstElementChild;k.scrollLeft=k.scrollWidth,k.scrollTop=k.scrollHeight,W.style.width=L.offsetWidth+1+"px",W.style.height=L.offsetHeight+1+"px",L.scrollLeft=L.scrollWidth,L.scrollTop=L.scrollHeight},p=function(l){return l.offsetWidth!==l.__resizeLast__.width||l.offsetHeight!==l.__resizeLast__.height},R=function(l){if(l.target.className&&typeof l.target.className.indexOf=="function"&&l.target.className.indexOf("contract-trigger")<0&&l.target.className.indexOf("expand-trigger")<0)return;let g=this;_(this),this.__resizeRAF__&&Qe(this.__resizeRAF__),this.__resizeRAF__=je(function(){p(g)&&(g.__resizeLast__.width=g.offsetWidth,g.__resizeLast__.height=g.offsetHeight,g.__resizeListeners__.forEach(function(W){W.call(g,l)}))})};let r=!1,P="";i="animationstart";let T="Webkit Moz O ms".split(" "),m="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),z="";{let l=document.createElement("fakeelement");if(l.style.animationName!==void 0&&(r=!0),r===!1){for(let g=0;g<T.length;g++)if(l.style[T[g]+"AnimationName"]!==void 0){z=T[g],P="-"+z.toLowerCase()+"-",i=m[g],r=!0;break}}}e="resizeanim",t="@"+P+"keyframes "+e+" { from { opacity: 0; } to { opacity: 0; } } ",s=P+"animation: 1ms "+e+"; "}let x=function(r){if(!r.getElementById("detectElementResize")){let P=(t||"")+".resize-triggers { "+(s||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',T=r.head||r.getElementsByTagName("head")[0],m=r.createElement("style");m.id="detectElementResize",m.type="text/css",o!=null&&m.setAttribute("nonce",o),m.styleSheet?m.styleSheet.cssText=P:m.appendChild(r.createTextNode(P)),T.appendChild(m)}};return{addResizeListener:function(r,P){if(f)r.attachEvent("onresize",P);else{if(!r.__resizeTriggers__){let T=r.ownerDocument,m=y.getComputedStyle(r);m&&m.position==="static"&&(r.style.position="relative"),x(T),r.__resizeLast__={},r.__resizeListeners__=[],(r.__resizeTriggers__=T.createElement("div")).className="resize-triggers";let z=T.createElement("div");z.className="expand-trigger",z.appendChild(T.createElement("div"));let l=T.createElement("div");l.className="contract-trigger",r.__resizeTriggers__.appendChild(z),r.__resizeTriggers__.appendChild(l),r.appendChild(r.__resizeTriggers__),_(r),r.addEventListener("scroll",R,!0),i&&(r.__resizeTriggers__.__animationListener__=function(L){L.animationName===e&&_(r)},r.__resizeTriggers__.addEventListener(i,r.__resizeTriggers__.__animationListener__))}r.__resizeListeners__.push(P)}},removeResizeListener:function(r,P){if(f)r.detachEvent("onresize",P);else if(r.__resizeListeners__.splice(r.__resizeListeners__.indexOf(P),1),!r.__resizeListeners__.length){r.removeEventListener("scroll",R,!0),r.__resizeTriggers__.__animationListener__&&(r.__resizeTriggers__.removeEventListener(i,r.__resizeTriggers__.__animationListener__),r.__resizeTriggers__.__animationListener__=null);try{r.__resizeTriggers__=!r.removeChild(r.__resizeTriggers__)}catch{}}}}}var De=class extends ve.Component{constructor(...t){super(...t),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;let{disableHeight:e,disableWidth:i,onResize:s}=this.props;if(this._parentNode){let p=window.getComputedStyle(this._parentNode)||{},_=parseFloat(p.paddingLeft||"0"),R=parseFloat(p.paddingRight||"0"),f=parseFloat(p.paddingTop||"0"),x=parseFloat(p.paddingBottom||"0"),O=this._parentNode.getBoundingClientRect(),D=O.height-f-x,r=O.width-_-R,P=this._parentNode.offsetHeight-f-x,T=this._parentNode.offsetWidth-_-R;(!e&&(this.state.height!==P||this.state.scaledHeight!==D)||!i&&(this.state.width!==T||this.state.scaledWidth!==r))&&(this.setState({height:P,width:T,scaledHeight:D,scaledWidth:r}),typeof s=="function"&&s({height:P,scaledHeight:D,scaledWidth:r,width:T}))}},this._setRef=e=>{this._autoSizer=e}}componentDidMount(){let{nonce:t}=this.props,e=this._autoSizer?this._autoSizer.parentNode:null;if(e!=null&&e.ownerDocument&&e.ownerDocument.defaultView&&e instanceof e.ownerDocument.defaultView.HTMLElement){this._parentNode=e;let i=e.ownerDocument.defaultView.ResizeObserver;i!=null?(this._resizeObserver=new i(()=>{this._timeoutId=setTimeout(this._onResize,0)}),this._resizeObserver.observe(e)):(this._detectElementResize=Lo(t),this._detectElementResize.addResizeListener(e,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),this._timeoutId!==null&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){let{children:t,defaultHeight:e,defaultWidth:i,disableHeight:s=!1,disableWidth:p=!1,doNotBailOutOnEmptyChildren:_=!1,nonce:R,onResize:f,style:x={},tagName:O="div",...D}=this.props,{height:r,scaledHeight:P,scaledWidth:T,width:m}=this.state,z={overflow:"visible"},l={},g=!1;return s||(r===0&&(g=!0),z.height=0,l.height=r,l.scaledHeight=P),p||(m===0&&(g=!0),z.width=0,l.width=m,l.scaledWidth=T),_&&(g=!1),(0,ve.createElement)(O,{ref:this._setRef,style:{...z,...x},...D},!g&&t(l))}};var h=d(u(),1),oo=o=>{let{isDraft:t,isOpen:e,onClose:i}=o,s=(0,Qt.useRef)(),{state:p,retry:_}=te({url:At,silent:!0}),R=()=>{let{filteredData:f,handleSearchInputChange:x}=Se(s.current??[],["screen_name"]),O=30,D=({style:r,index:P,data:T})=>{let m=T?.[P];return m!=null?(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(ft,{style:r,children:m.habilitado?(0,h.jsx)(mt,{href:pe(t?ue:fe,{client:m.id}),children:(0,h.jsxs)(E,{children:[(0,h.jsx)(Ge,{as:to.default,color:"green.400"}),m.screen_name]})}):(0,h.jsxs)(E,{color:"gray.400",sx:{cursor:"not-allowed"},children:[(0,h.jsx)(Ge,{as:eo.default,color:"red.400"}),m.screen_name]})},m.id)}):(0,h.jsx)(h.Fragment,{})};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(E,{sx:{pb:4},children:(0,h.jsx)(ze,{handleSearchInputChange:x})}),(0,h.jsx)(De,{children:({height:r,width:P})=>(0,h.jsx)(Ot,{height:r-60,itemCount:f.length??0,itemSize:O,innerElementType:pt,width:P,itemData:f,children:D})})]})};return(0,h.jsxs)(ge,{isCentered:!0,isOpen:e,onClose:i,scrollBehavior:"inside",size:{base:"full",sm:"md",md:"lg"},children:[(0,h.jsx)(Pe,{}),(0,h.jsxs)(_e,{sx:{maxHeight:"auto"},children:[(0,h.jsx)(Re,{children:"Seleccione el cliente"}),(0,h.jsx)(Te,{}),(0,h.jsx)(be,{minHeight:{base:"auto",sm:"420px !important"},children:p.map({loading:f=>(0,h.jsxs)(ut,{spacing:4,children:[(0,h.jsx)($e,{width:"full",height:"36px",borderRadius:"md"}),(0,h.jsx)($e,{width:"full",height:"250px",borderRadius:"md"})]}),error:({error:f})=>(0,h.jsx)(xe,{error:f,retry:_,cancelAndNavigateTo:st}),success:f=>(s.current=jt.default.sortBy(f.data,["screen_name"]),(0,h.jsx)(R,{}))})})]})]})};a();var Le=d(Z(),1);var H=d(u(),1),yo=(0,Le.lazy)(()=>import("/build/_shared/PrintModal.client-S4KW4HT4.js")),io=o=>{let{pedidos:t,renglones:e,isOpen:i,onClose:s}=o;return(0,H.jsxs)(ge,{isCentered:!0,isOpen:i,onClose:s,children:[(0,H.jsx)(Pe,{}),(0,H.jsxs)(_e,{children:[(0,H.jsx)(Re,{children:"Impresi\xF3n de pedidos"}),(0,H.jsx)(Te,{}),(0,H.jsx)(be,{children:(0,H.jsx)(Le.Suspense,{fallback:(0,H.jsx)(Bt,{}),children:(0,H.jsx)(yo,{pedidos:t,renglones:e})})})]})]})};var A=d(u(),1),ao=({isDraft:o,pedidos:t,stateRenglones:e,handleSearchInputChange:i})=>{let s=zt(),[p,_]=(0,q.useState)(!1),[R,f]=(0,q.useState)(!1),{isOpen:x,onOpen:O,onClose:D}=Ne(),{isOpen:r,onOpen:P,onClose:T}=Ne(),[m,z]=(0,q.useState)([]),l=(0,q.useRef)({pedidos:[],renglones:{}});(0,q.useEffect)(()=>{let F=({id:le,checked:Be})=>{z(Be?re=>[...re,le]:re=>re.filter(ce=>ce!==le))};return X.on("setUnsetSelectedPedido",F),()=>{X.removeListener("setUnsetSelectedPedido",F)}},[]);let g=()=>{if(s.authState.isCustomer()){let F=s.authState.getUserId();F!=null&&s.navigate(pe(o?ue:fe,{client:F}));return}_(!0),O()},L=()=>{},k=()=>{D(),_(!1)},W=()=>{l.current.pedidos=t.filter(F=>m.includes(F.id)),Array.isArray(l.current.pedidos)&&l.current.pedidos.length>0&&e.isSuccess()&&(l.current.renglones=ro.default.pick(e.data,m)),f(!0),P()},Me=()=>{T(),f(!1)},ae=m.length<=0?void 0:m.length==1?`1 ${xt}`:`${m.length} ${St}`;return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(E,{bg:he("white","blue.900"),sx:{px:4,position:"sticky",zIndex:1e3,top:0},children:(0,A.jsxs)(Ue,{h:16,alignItems:"center",justifyContent:"space-between",children:[(0,A.jsxs)(We,{spacing:{base:2,sm:3},alignItems:"center",children:[(s.authState.isVendor()||s.authState.isCustomer())&&(0,A.jsx)(A.Fragment,{children:(0,A.jsx)(qe,{icon:no.default,text:o?it:ot,sharedProps:{size:"sm",fontWeight:"400",colorScheme:o?"green":"orange",onClick:()=>{g()}},iconProps:{boxSize:{base:5,md:4}}})}),!o&&(0,A.jsx)(qe,{icon:so.default,text:tt,sharedProps:{size:"sm",fontWeight:"400",colorScheme:"blue",onClick:()=>W(),isDisabled:m.length<=0},iconProps:{boxSize:{base:5,md:4}}}),ae!=null&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(Ve,{display:{base:"none",sm:"inherited"},height:8,borderRadius:40,size:"md",variant:"solid",colorScheme:"blue",children:(0,A.jsx)(Xe,{marginX:1,children:ae})}),(0,A.jsx)(Ve,{display:{base:"inherited",sm:"none"},height:8,borderRadius:40,size:"md",variant:"solid",colorScheme:"blue",children:(0,A.jsx)(Xe,{marginX:1,children:m.length})})]})]}),(0,A.jsx)(Ue,{alignItems:"center",marginLeft:4,children:(0,A.jsx)(We,{spacing:{base:2,md:4},children:(0,A.jsx)(E,{children:(0,A.jsx)(ze,{handleSearchInputChange:i})})})})]})}),p&&(0,A.jsx)(oo,{isDraft:o,isOpen:x,onClose:k}),R&&(0,A.jsx)(io,{isOpen:r,onClose:Me,pedidos:l.current.pedidos,renglones:l.current.renglones})]})};a();a();var G=d(Z(),1);a();a();function ye(o,t){let e;switch(o){case 1:e="blue";break;case 2:e="purple";break;case 3:e="green";break;case 4:e="black";break;case 5:e="red";break;default:e="gray"}return t==null?e:`${e}${t}`}var co=d(u(),1),lo=({estado:o})=>{let t=$t(o),e=ye(o);return(0,co.jsx)(ht,{fontSize:"1em",variant:"solid",colorScheme:e,lineHeight:"1.5em",children:t})};a();a();var se=d(u(),1),mo=()=>(0,se.jsxs)(V,{status:"warning",children:[(0,se.jsx)($,{}),(0,se.jsx)(U,{children:"El pedido no cuenta con productos."})]});a();var de=d(u(),1),po=()=>(0,de.jsxs)(V,{status:"error",children:[(0,de.jsx)($,{}),(0,de.jsx)(U,{children:"Ocurri\xF3 un error al cargar los detalles del pedido."})]});a();var w=d(u(),1),fo=()=>(0,w.jsx)(E,{width:"full",sx:{mt:8,mb:4},children:(0,w.jsxs)(N,{templateColumns:"1fr",alignItems:"center",gap:2,children:[(0,w.jsx)(c,{children:(0,w.jsx)(J,{height:"20px"})}),(0,w.jsx)(c,{children:(0,w.jsx)(J,{height:"20px"})}),(0,w.jsx)(c,{children:(0,w.jsx)(J,{height:"20px"})}),(0,w.jsx)(c,{children:(0,w.jsx)(J,{height:"20px"})})]})});a();var b=d(u(),1),uo=({nro_pedido:o,renglones:t})=>(0,b.jsx)(Ee,{sx:{p:0,m:0},children:(0,b.jsxs)(Ae,{variant:"stripedHoverOverCard",colorScheme:"gray",size:"sm",borderWidth:"1px",children:[(0,b.jsx)(bt,{children:(0,b.jsx)(Y,{children:(0,b.jsx)(Tt,{sx:{py:2},children:(0,b.jsxs)(N,{templateColumns:{base:"1fr 1fr 1fr",md:"4fr 1fr 1fr 1fr"},gap:6,children:[(0,b.jsx)(c,{children:(0,b.jsx)(S,{fontSize:{base:"xs",md:"sm"},children:"Art\xEDculo"})}),(0,b.jsx)(c,{sx:{display:{base:"none",md:"block"}},children:(0,b.jsx)(S,{fontSize:{base:"xs",md:"sm"},textAlign:"center",children:"Precio"})}),(0,b.jsx)(c,{children:(0,b.jsx)(S,{fontSize:{base:"xs",md:"sm"},textAlign:"center",children:"Cantidad"})}),(0,b.jsx)(c,{children:(0,b.jsx)(S,{fontSize:{base:"xs",md:"sm"},textAlign:"center",children:"Subtotal"})})]})})})}),(0,b.jsx)(Ce,{children:t.map(({id_articulo:e,nombre_articulo:i,codigo_articulo:s,descripcion_adicional:p,precio:_,cantidad:R,subtotal:f},x)=>(0,b.jsx)(Y,{children:(0,b.jsx)(ee,{children:(0,b.jsxs)(N,{templateColumns:{base:"1fr 1fr 1fr",md:"4fr 1fr 1fr 1fr"},gap:6,children:[(0,b.jsx)(c,{children:(0,b.jsx)(oe,{children:wt(i,e,p)})}),(0,b.jsx)(c,{sx:{display:{base:"none",md:"block"}},children:(0,b.jsx)(Ke,{precio:_,moneda:"$"})}),(0,b.jsx)(c,{children:(0,b.jsx)(K,{textAlign:"center",children:R})}),(0,b.jsx)(c,{children:(0,b.jsx)(Ke,{precio:f,moneda:"$"})})]})})},`details-${o}-${x}`))})]})});var ie=d(u(),1),ho=({wasOpen:o,pedido:t,stateRenglones:e})=>(0,ie.jsx)(E,{sx:{mt:6},children:o&&e.map({loading:i=>(0,ie.jsx)(fo,{}),error:i=>(0,ie.jsx)(po,{}),success:i=>{let{id:s,numero_pedido:p}=t,_=i.data?.[s];return Array.isArray(_)?(0,ie.jsx)(uo,{nro_pedido:p,renglones:_}):(0,ie.jsx)(mo,{})}})});a();var Po=d(Ro(),1);var v=d(u(),1),bo=({user:o,draft:t,pedido:e})=>{let i=o.role==2,s=o.puede_anular_pedido,p=o.borrar_pedido_al_anular;return(0,v.jsxs)(gt,{isLazy:!0,id:"menu",children:[(0,v.jsx)(Rt,{as:lt,size:"sm","aria-label":Et,icon:(0,v.jsx)(Po.default,{}),colorScheme:"blue",variant:"solid"}),(0,v.jsxs)(_t,{rootProps:{zIndex:2e3},children:[!i&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ne,{onClick:()=>{},children:Ft}),(0,v.jsx)(ne,{onClick:()=>{},children:Gt}),(0,v.jsx)(ne,{onClick:()=>{},children:t?Ut:Wt}),s&&(0,v.jsx)(Pt,{})]}),s&&(0,v.jsx)(ne,{onClick:()=>{},children:p?Nt:kt})]})]})};var n=d(u(),1),To=({index:o,user:t,draft:e,pedido:i,stateRenglones:s,isHidden:p})=>{let[_,R]=(0,G.useState)(!1),[f,x]=(0,G.useState)(!1),O=he("gray.800","white"),[D]=at("colors",["blue.500"]),r=(0,G.useRef)(!1),P=(0,G.useMemo)(()=>(0,n.jsx)(ho,{wasOpen:r.current,pedido:i,stateRenglones:s}),[r.current,s.constructor.name]),T=()=>{let B=!_;B&&(r.current=!0),R(B),X.emit("togglePedidoDetails",{id:i.id})},m=(B,ke)=>{x(!!B),X.emit("setUnsetSelectedPedido",{id:ke,checked:B})};(0,G.useEffect)(()=>{let B=({id:ke})=>{i.id!==ke&&R(!1)};return X.on("togglePedidoDetails",B),()=>{X.removeListener("togglePedidoDetails",B)}},[]);let{id:z,numero_pedido:l,estado:g,fecha_alta:L,fecha_entrega:k,codigo_cliente:W,codigo_vendedor:Me,codigo_transporte:ae,nombre_cliente:F,nombre_vendedor:le,nombre_transporte:Be,total:re,descuento:ce,comentarios:me}=i,Co=!e&&me!=null&&me.length>0;return(0,n.jsx)(Y,{sx:{...p&&!f&&{display:"none"}},children:(0,n.jsxs)(ee,{sx:{py:6,position:"relative",borderTopWidth:{base:"3px",md:"4px"},borderTopStyle:"solid",borderTopColor:`${e?"blue.500 !important":ye(g,".500 !important")}`},children:[(0,n.jsxs)(E,{display:"flex",sx:{position:"absolute",right:5,top:5},flexDirection:"column",children:[(0,n.jsx)(bo,{draft:e,pedido:i,user:t}),!e&&(0,n.jsx)(E,{display:"flex",width:8,height:8,justifyContent:"center",backgroundColor:f?"blue.500":"white",sx:{marginTop:2,borderRadius:6,borderWidth:2,borderColor:O},children:(0,n.jsx)(ct,{size:"lg",colorScheme:"blue",sx:{borderWidth:0,borderColor:"#ff000000"},onChange:B=>{m(B.target.checked,z)}})})]}),(0,n.jsxs)(N,{templateColumns:{base:"repeat(2, 1fr)",md:"repeat(4, 1fr)"},gap:6,sx:{cursor:"pointer"},onClick:()=>{T()},children:[e?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(c,{colSpan:{base:2,md:4},children:[(0,n.jsx)(S,{size:"sm",children:"Comentarios"}),(0,n.jsx)(K,{paddingRight:10,sx:{whiteSpace:"pre-line"},children:me})]})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(c,{children:[(0,n.jsx)(S,{size:"sm",children:"Pedido"}),(0,n.jsx)(K,{children:l})]}),(0,n.jsxs)(c,{children:[(0,n.jsx)(S,{size:"sm",children:"Estado"}),(0,n.jsx)(lo,{estado:g})]}),(0,n.jsxs)(c,{children:[(0,n.jsx)(S,{size:"sm",children:"Emisi\xF3n"}),(0,n.jsx)(K,{children:Fe(L)})]}),(0,n.jsxs)(c,{children:[(0,n.jsx)(S,{size:"sm",children:"Entrega"}),(0,n.jsx)(K,{children:Fe(k)})]})]}),(0,n.jsxs)(c,{children:[(0,n.jsx)(S,{size:"sm",children:"Cliente"}),(0,n.jsx)(oe,{children:Ht(W,F)})]}),(0,n.jsxs)(c,{children:[(0,n.jsx)(S,{size:"sm",children:"Vendedor"}),(0,n.jsx)(oe,{children:Ze(Me,le)})]}),(0,n.jsxs)(c,{children:[(0,n.jsx)(S,{size:"sm",children:"Transporte"}),(0,n.jsx)(oe,{children:Ze(ae,Be)})]}),(0,n.jsxs)(c,{children:[(0,n.jsxs)(S,{size:"md",sx:{textTransform:"uppercase",color:g===2&&"green.400"},children:["Total",ce!=null&&(0,n.jsxs)(n.Fragment,{children:[" ",`-${ce}%`]})]}),(0,n.jsx)(S,{size:"md",sx:{fontWeight:"bolder",color:g===2&&"green.400"},children:(0,n.jsx)(Mt,{precio:re,moneda:"$"})})]}),Co&&(0,n.jsx)(c,{colSpan:{base:2,md:4},children:(0,n.jsxs)(V,{status:"info",children:[(0,n.jsx)($,{}),(0,n.jsx)(U,{children:me})]})})]}),(0,n.jsx)(E,{children:(0,n.jsx)(E,{sx:{display:_?"block":"none"},children:P})},`pedido-details-${o}`)]})})};var M=d(u(),1);function Ao(o){let t=Ie().state.userOrThrow(),{draft:e,unfilteredPedidos:i,filteredPedidos:s,isFiltering:p,stateRenglones:_}=o;return(0,M.jsx)(Ee,{sx:{p:0,m:0},children:(0,M.jsx)(Ae,{variant:"stripedOverCard",colorScheme:"gray",size:"md",sx:{borderCollapse:"separate",borderSpacing:"0 1rem"},children:(0,M.jsxs)(Ce,{children:[i.map((R,f)=>(0,M.jsx)(To,{index:f,draft:e,user:t,pedido:R,stateRenglones:_,isHidden:p&&!s.includes(R)},`pedido-${R.id}`)),!s.length&&(0,M.jsx)(Y,{children:(0,M.jsx)(ee,{children:(0,M.jsxs)(V,{status:"info",children:[(0,M.jsx)($,{}),(0,M.jsx)(U,{children:p?rt:e?It:Ct})]})})})]})})})}var j=d(u(),1),Eo=o=>{let{showDrafts:t,pedidos:e}=o,i=Ie().state.userOrThrow(),s=i.role==2,p=i.role==1,_=i.role==0,{filteredData:R,handleSearchInputChange:f,isFiltering:x}=Se(e,["comentario",...t?[]:["numero_pedido"],..._?[]:["codigo_cliente","nombre_cliente"],...s?["codigo_vendedor","nombre_vendedor"]:[]]),{state:O}=te({url:t?yt:vt,silent:!0,transformResponse:D=>(Object.values(D).forEach(r=>{Array.isArray(r)&&r.sort((P,T)=>P.renglon-T.renglon)}),D)});return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ao,{isDraft:t,pedidos:e,stateRenglones:O,handleSearchInputChange:f}),(0,j.jsx)(Ao,{draft:t,stateRenglones:O,unfilteredPedidos:e,filteredPedidos:R,isFiltering:x})]})};var He=d(u(),1),Ur=o=>{let t=o.showDrafts===!0,{state:e,retry:i}=te({url:t?Lt:Dt,silent:!0});return e.map({loading:s=>(0,He.jsx)(Vt,{}),error:({error:s})=>(0,He.jsx)(xe,{error:s,retry:i,cancelAndNavigateTo:nt}),success:s=>(0,He.jsx)(Eo,{showDrafts:t,pedidos:s.data})})};export{Ur as a};
