import{a as mo,b as po,c as uo,d as fo,e as ho}from"/build/_shared/chunk-5PSQ5JF7.js";import{a as or,b as Nt,c as oe}from"/build/_shared/chunk-W7TKRMHI.js";import{a as Bt,b as kt,e as Gt,f as Ut,m as Wt,n as Vt,o as X}from"/build/_shared/chunk-6TZYW5IW.js";import{A as ro,B as io,C as no,D as so,E as ao,F as lo,G as co,a as $t,b as Ke,c as Xt,g as Ye,h as qt,q as Zt,r as Kt,s as Yt,t as Jt,u as Qt,v as jt,w as eo,y as to,z as oo}from"/build/_shared/chunk-5UHTFQTM.js";import{a as Ie,b as Ce}from"/build/_shared/chunk-BV3PCMJP.js";import{j as zt,k as tr}from"/build/_shared/chunk-RALSDSOB.js";import{a as Ft}from"/build/_shared/chunk-U6GMCTV4.js";import{a as K,b as Y}from"/build/_shared/chunk-CWO7YRBZ.js";import{b as Oe}from"/build/_shared/chunk-DPMSINRD.js";import{d as Ae}from"/build/_shared/chunk-TWIFHJP5.js";import{a as Ze,b as be}from"/build/_shared/chunk-VIEJRPHH.js";import{b as Lt,o as yt,p as Mt,v as wt,w as Ht}from"/build/_shared/chunk-5LJ5WJLW.js";import{$ as ot,$c as vt,Aa as at,Ac as bt,Ba as dt,Bc as It,Ca as lt,Cc as Ct,Da as ct,Dc as fe,Ea as mt,Ec as he,Fa as pt,Ga as ut,Gb as _t,Ic as ge,Jc as _e,Kc as Re,Lc as Pe,Ob as Rt,Tc as $e,Vc as De,Wa as ft,Wc as St,Xc as Z,Yb as ne,Yc as Ee,Zc as Te,_ as tt,_a as ht,_c as te,ad as Xe,bb as ue,bd as qe,ca as rt,cc as Pt,dc as Dt,fc as Et,gc as Ue,gd as xt,ha as it,hc as k,kc as j,mc as Tt,nc as We,oc as f,pc as z,qc as v,ra as nt,rc as At,sa as Ge,sb as W,tb as V,ua as pe,vb as $,vc as Ve,wb as gt,xa as st,xc as Ot,zc as ee}from"/build/_shared/chunk-DP2TJOZR.js";import{F as R,a as B}from"/build/_shared/chunk-3PZF3L6F.js";import{c as ke,e as a,h as d}from"/build/_shared/chunk-P3O6KQPX.js";var Po=ke((Er,Ro)=>{"use strict";d();function rr(o){return o&&typeof o=="object"&&"default"in o?o.default:o}var Se=rr(B()),ir=Object.assign||function(o){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r])}return o},nr=function(o,t){var e={};for(var r in o)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);return e},_o=function(t){var e=t.color,r=e===void 0?"currentColor":e,n=t.size,l=n===void 0?24:n,_=t.children,h=nr(t,["color","size","children"]),p="mdi-icon "+(h.className||"");return Se.createElement("svg",ir({},h,{className:p,width:l,height:l,fill:r,viewBox:"0 0 24 24"}),Se.createElement("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}))},sr=Se.memo?Se.memo(_o):_o;Ro.exports=sr});var To=ke((Ar,Eo)=>{"use strict";d();function ar(o){return o&&typeof o=="object"&&"default"in o?o.default:o}var ve=ar(B()),dr=Object.assign||function(o){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r])}return o},lr=function(o,t){var e={};for(var r in o)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);return e},Do=function(t){var e=t.color,r=e===void 0?"currentColor":e,n=t.size,l=n===void 0?24:n,_=t.children,h=lr(t,["color","size","children"]),p="mdi-icon "+(h.className||"");return ve.createElement("svg",dr({},h,{className:p,width:l,height:l,fill:r,viewBox:"0 0 24 24"}),ve.createElement("path",{d:"M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z"}))},cr=ve.memo?ve.memo(Do):Do;Eo.exports=cr});var Go=ke((_i,ko)=>{"use strict";d();function ur(o){return o&&typeof o=="object"&&"default"in o?o.default:o}var Me=ur(B()),fr=Object.assign||function(o){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r])}return o},hr=function(o,t){var e={};for(var r in o)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);return e},Bo=function(t){var e=t.color,r=e===void 0?"currentColor":e,n=t.size,l=n===void 0?24:n,_=t.children,h=hr(t,["color","size","children"]),p="mdi-icon "+(h.className||"");return Me.createElement("svg",fr({},h,{className:p,width:l,height:l,fill:r,viewBox:"0 0 24 24"}),Me.createElement("path",{d:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"}))},gr=Me.memo?Me.memo(Bo):Bo;ko.exports=gr});d();d();var I=a(R(),1),go=()=>(0,I.jsx)(v,{width:"full",sx:{mt:8,mb:4},children:(0,I.jsxs)(k,{templateColumns:"1fr",alignItems:"center",gap:4,children:[(0,I.jsx)(f,{children:(0,I.jsx)(K,{})}),(0,I.jsx)(f,{children:(0,I.jsx)(Y,{height:"120px"})}),(0,I.jsx)(f,{children:(0,I.jsx)(Y,{height:"120px"})}),(0,I.jsx)(f,{children:(0,I.jsx)(Y,{height:"120px"})}),(0,I.jsx)(f,{children:(0,I.jsx)(Y,{height:"120px"})}),(0,I.jsx)(f,{children:(0,I.jsx)(Y,{height:"120px"})}),(0,I.jsx)(f,{children:(0,I.jsx)(Y,{height:"120px"})})]})});d();d();var q=a(B(),1);var Lo=a(ft(),1),yo=a(Po(),1),Mo=a(To(),1);d();var Io=a(B(),1);var Co=a(ft(),1),So=a(tr(),1),vo=a(or(),1);d();var ze=a(B()),y;typeof window<"u"?y=window:typeof self<"u"?y=self:y=globalThis;var je=null,et=null,Ao=20,Je=y.clearTimeout,Oo=y.setTimeout,Qe=y.cancelAnimationFrame||y.mozCancelAnimationFrame||y.webkitCancelAnimationFrame,bo=y.requestAnimationFrame||y.mozRequestAnimationFrame||y.webkitRequestAnimationFrame;Qe==null||bo==null?(je=Je,et=function(t){return Oo(t,Ao)}):(je=function([t,e]){Qe(t),Je(e)},et=function(t){let e=bo(function(){Je(r),t()}),r=Oo(function(){Qe(e),t()},Ao);return[e,r]});function mr(o){let t,e,r,n,l,_,h,p=typeof document<"u"&&document.attachEvent;if(!p){_=function(u){let m=u.__resizeTriggers__,O=m.firstElementChild,H=m.lastElementChild,U=O.firstElementChild;H.scrollLeft=H.scrollWidth,H.scrollTop=H.scrollHeight,U.style.width=O.offsetWidth+1+"px",U.style.height=O.offsetHeight+1+"px",O.scrollLeft=O.scrollWidth,O.scrollTop=O.scrollHeight},l=function(u){return u.offsetWidth!==u.__resizeLast__.width||u.offsetHeight!==u.__resizeLast__.height},h=function(u){if(u.target.className&&typeof u.target.className.indexOf=="function"&&u.target.className.indexOf("contract-trigger")<0&&u.target.className.indexOf("expand-trigger")<0)return;let m=this;_(this),this.__resizeRAF__&&je(this.__resizeRAF__),this.__resizeRAF__=et(function(){l(m)&&(m.__resizeLast__.width=m.offsetWidth,m.__resizeLast__.height=m.offsetHeight,m.__resizeListeners__.forEach(function(U){U.call(m,u)}))})};let i=!1,g="";r="animationstart";let D="Webkit Moz O ms".split(" "),c="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),S="";{let u=document.createElement("fakeelement");if(u.style.animationName!==void 0&&(i=!0),i===!1){for(let m=0;m<D.length;m++)if(u.style[D[m]+"AnimationName"]!==void 0){S=D[m],g="-"+S.toLowerCase()+"-",r=c[m],i=!0;break}}}e="resizeanim",t="@"+g+"keyframes "+e+" { from { opacity: 0; } to { opacity: 0; } } ",n=g+"animation: 1ms "+e+"; "}let b=function(i){if(!i.getElementById("detectElementResize")){let g=(t||"")+".resize-triggers { "+(n||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',D=i.head||i.getElementsByTagName("head")[0],c=i.createElement("style");c.id="detectElementResize",c.type="text/css",o!=null&&c.setAttribute("nonce",o),c.styleSheet?c.styleSheet.cssText=g:c.appendChild(i.createTextNode(g)),D.appendChild(c)}};return{addResizeListener:function(i,g){if(p)i.attachEvent("onresize",g);else{if(!i.__resizeTriggers__){let D=i.ownerDocument,c=y.getComputedStyle(i);c&&c.position==="static"&&(i.style.position="relative"),b(D),i.__resizeLast__={},i.__resizeListeners__=[],(i.__resizeTriggers__=D.createElement("div")).className="resize-triggers";let S=D.createElement("div");S.className="expand-trigger",S.appendChild(D.createElement("div"));let u=D.createElement("div");u.className="contract-trigger",i.__resizeTriggers__.appendChild(S),i.__resizeTriggers__.appendChild(u),i.appendChild(i.__resizeTriggers__),_(i),i.addEventListener("scroll",h,!0),r&&(i.__resizeTriggers__.__animationListener__=function(O){O.animationName===e&&_(i)},i.__resizeTriggers__.addEventListener(r,i.__resizeTriggers__.__animationListener__))}i.__resizeListeners__.push(g)}},removeResizeListener:function(i,g){if(p)i.detachEvent("onresize",g);else if(i.__resizeListeners__.splice(i.__resizeListeners__.indexOf(g),1),!i.__resizeListeners__.length){i.removeEventListener("scroll",h,!0),i.__resizeTriggers__.__animationListener__&&(i.__resizeTriggers__.removeEventListener(r,i.__resizeTriggers__.__animationListener__),i.__resizeTriggers__.__animationListener__=null);try{i.__resizeTriggers__=!i.removeChild(i.__resizeTriggers__)}catch{}}}}}var xe=class extends ze.Component{constructor(...t){super(...t),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;let{disableHeight:e,disableWidth:r,onResize:n}=this.props;if(this._parentNode){let l=window.getComputedStyle(this._parentNode)||{},_=parseFloat(l.paddingLeft||"0"),h=parseFloat(l.paddingRight||"0"),p=parseFloat(l.paddingTop||"0"),b=parseFloat(l.paddingBottom||"0"),x=this._parentNode.getBoundingClientRect(),C=x.height-p-b,i=x.width-_-h,g=this._parentNode.offsetHeight-p-b,D=this._parentNode.offsetWidth-_-h;(!e&&(this.state.height!==g||this.state.scaledHeight!==C)||!r&&(this.state.width!==D||this.state.scaledWidth!==i))&&(this.setState({height:g,width:D,scaledHeight:C,scaledWidth:i}),typeof n=="function"&&n({height:g,scaledHeight:C,scaledWidth:i,width:D}))}},this._setRef=e=>{this._autoSizer=e}}componentDidMount(){let{nonce:t}=this.props,e=this._autoSizer?this._autoSizer.parentNode:null;if(e!=null&&e.ownerDocument&&e.ownerDocument.defaultView&&e instanceof e.ownerDocument.defaultView.HTMLElement){this._parentNode=e;let r=e.ownerDocument.defaultView.ResizeObserver;r!=null?(this._resizeObserver=new r(()=>{this._timeoutId=setTimeout(this._onResize,0)}),this._resizeObserver.observe(e)):(this._detectElementResize=mr(t),this._detectElementResize.addResizeListener(e,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),this._timeoutId!==null&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){let{children:t,defaultHeight:e,defaultWidth:r,disableHeight:n=!1,disableWidth:l=!1,doNotBailOutOnEmptyChildren:_=!1,nonce:h,onResize:p,style:b={},tagName:x="div",...C}=this.props,{height:i,scaledHeight:g,scaledWidth:D,width:c}=this.state,S={overflow:"visible"},u={},m=!1;return n||(i===0&&(m=!0),S.height=0,u.height=i,u.scaledHeight=g),l||(c===0&&(m=!0),S.width=0,u.width=c,u.scaledWidth=D),_&&(m=!1),(0,ze.createElement)(x,{ref:this._setRef,style:{...S,...b},...C},!m&&t(u))}};var P=a(R(),1),xo=o=>{let{isDraft:t,isOpen:e,onClose:r}=o,n=(0,Io.useRef)(),{state:l,retry:_}=zt(),h=()=>{let{filteredData:p,handleSearchInputChange:b}=Ie(n.current??[],["screen_name"]),x=30,C=({style:i,index:g,data:D})=>{let c=D?.[g];return c!=null?(0,P.jsx)(P.Fragment,{children:(0,P.jsx)(Et,{style:i,children:c.habilitado?(0,P.jsx)(Pt,{href:pe(t?ct:at,{client:c.id}),children:(0,P.jsxs)(v,{children:[(0,P.jsx)(Ue,{as:vo.default,color:"green.400"}),c.screen_name]})}):(0,P.jsxs)(v,{color:"gray.400",sx:{cursor:"not-allowed"},children:[(0,P.jsx)(Ue,{as:So.default,color:"red.400"}),c.screen_name]})},c.id)}):(0,P.jsx)(P.Fragment,{})};return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(v,{sx:{pb:4},children:(0,P.jsx)(Ce,{handleSearchInputChange:b})}),(0,P.jsx)(xe,{children:({height:i,width:g})=>(0,P.jsx)(Ft,{height:i-60,itemCount:p.length??0,itemSize:x,innerElementType:Dt,width:g,itemData:p,children:C})})]})};return(0,P.jsxs)(fe,{isCentered:!0,isOpen:e,onClose:r,scrollBehavior:"inside",size:{base:"full",sm:"md",md:"lg"},children:[(0,P.jsx)(_e,{}),(0,P.jsxs)(he,{sx:{maxHeight:"auto"},children:[(0,P.jsx)(ge,{children:"Seleccione el cliente"}),(0,P.jsx)(Pe,{}),(0,P.jsx)(Re,{minHeight:{base:"auto",sm:"420px !important"},children:l.map({loading:p=>(0,P.jsxs)(Tt,{spacing:4,children:[(0,P.jsx)($e,{width:"full",height:"36px",borderRadius:"md"}),(0,P.jsx)($e,{width:"full",height:"250px",borderRadius:"md"})]}),error:({error:p})=>(0,P.jsx)(Oe,{error:p,retry:_,cancelAndNavigateTo:ut}),success:p=>(n.current=Co.default.sortBy(p.data,["screen_name"]),(0,P.jsx)(h,{}))})})]})]})};d();var Le=a(B(),1);var F=a(R(),1),pr=(0,Le.lazy)(()=>import("/build/_shared/PrintModal.client-NLVSBJTZ.js")),zo=o=>{let{pedidos:t,renglones:e,isOpen:r,onClose:n}=o;return(0,F.jsxs)(fe,{isCentered:!0,isOpen:r,onClose:n,children:[(0,F.jsx)(_e,{}),(0,F.jsxs)(he,{children:[(0,F.jsx)(ge,{children:"Impresi\xF3n de pedidos"}),(0,F.jsx)(Pe,{}),(0,F.jsx)(Re,{children:(0,F.jsx)(Le.Suspense,{fallback:(0,F.jsx)(mo,{}),children:(0,F.jsx)(pr,{pedidos:t,renglones:e})})})]})]})};var T=a(R(),1),wo=({isDraft:o,pedidos:t,stateRenglones:e,handleSearchInputChange:r})=>{let n=be(),[l,_]=(0,q.useState)(!1),[h,p]=(0,q.useState)(!1),{isOpen:b,onOpen:x,onClose:C}=ne(),{isOpen:i,onOpen:g,onClose:D}=ne(),[c,S]=(0,q.useState)([]),u=(0,q.useRef)({pedidos:[],renglones:{}});(0,q.useEffect)(()=>{let Q=({id:le,checked:Fe})=>{S(Fe?ie=>[...ie,le]:ie=>ie.filter(ce=>ce!==le))};return X.on("setUnsetSelectedPedido",Q),()=>{X.removeListener("setUnsetSelectedPedido",Q)}},[]);let m=()=>{if(n.authState.isCustomer()){n.navigate(o?mt:dt);return}_(!0),x()},O=()=>{},H=()=>{C(),_(!1)},U=()=>{u.current.pedidos=t.filter(Q=>c.includes(Q.id)),Array.isArray(u.current.pedidos)&&u.current.pedidos.length>0&&e.isSuccess()&&(u.current.renglones=Lo.default.pick(e.data,c)),p(!0),g()},He=()=>{D(),p(!1)},de=c.length<=0?void 0:c.length==1?`1 ${wt}`:`${c.length} ${Ht}`;return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(v,{bg:ue("white","blue.900"),sx:{px:4,position:"sticky",zIndex:1e3,top:0},children:(0,T.jsxs)(Ve,{h:16,alignItems:"center",justifyContent:"space-between",children:[(0,T.jsxs)(We,{spacing:{base:2,sm:3},alignItems:"center",children:[(n.authState.isVendor()||n.authState.isCustomer())&&(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(Ze,{icon:yo.default,text:o?rt:ot,sharedProps:{size:"sm",fontWeight:"400",colorScheme:o?"green":"orange",onClick:()=>{m()}},iconProps:{boxSize:{base:5,md:4}}})}),!o&&(0,T.jsx)(Ze,{icon:Mo.default,text:tt,sharedProps:{size:"sm",fontWeight:"400",colorScheme:"blue",onClick:()=>U(),isDisabled:c.length<=0},iconProps:{boxSize:{base:5,md:4}}}),de!=null&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Xe,{display:{base:"none",sm:"inherited"},height:8,borderRadius:40,size:"md",variant:"solid",colorScheme:"blue",children:(0,T.jsx)(qe,{marginX:1,children:de})}),(0,T.jsx)(Xe,{display:{base:"inherited",sm:"none"},height:8,borderRadius:40,size:"md",variant:"solid",colorScheme:"blue",children:(0,T.jsx)(qe,{marginX:1,children:c.length})})]})]}),(0,T.jsx)(Ve,{alignItems:"center",marginLeft:4,children:(0,T.jsx)(We,{spacing:{base:2,md:4},children:(0,T.jsx)(v,{children:(0,T.jsx)(Ce,{handleSearchInputChange:r})})})})]})}),l&&(0,T.jsx)(xo,{isDraft:o,isOpen:b,onClose:H}),h&&(0,T.jsx)(zo,{isOpen:i,onClose:He,pedidos:u.current.pedidos,renglones:u.current.renglones})]})};d();d();var G=a(B(),1);d();function Ho(o,t){return t.isSuccess()?uo(o,t.data[o.id]):o.estado}d();d();function ye(o,t){let e;switch(o){case 1:e="blue";break;case 2:e="purple";break;case 3:e="green";break;case 4:e="black";break;case 5:e="red";break;default:e="gray"}return t==null?e:`${e}${t}`}var No=a(R(),1),Fo=({estado:o})=>{let t=po(o),e=ye(o);return(0,No.jsx)(At,{fontSize:"1em",variant:"solid",colorScheme:e,lineHeight:"1.5em",children:t})};d();var Uo=a(Go(),1);var L=a(R(),1),Wo=({app:o,draft:t,pedido:e,onDelete:r})=>{let n=o.authState.userInfo,l=n.role==2,_=fo(n,e.estado),h=n.puede_anular_pedido&&ho(n,e.estado),p=t||n.borrar_pedido_al_anular;return(0,L.jsxs)(Ot,{isLazy:!0,id:"menu",children:[(0,L.jsx)(It,{as:_t,size:"sm","aria-label":Lt,icon:(0,L.jsx)(Uo.default,{}),variant:"outline",colorScheme:"white"}),(0,L.jsx)(ht,{children:(0,L.jsxs)(bt,{rootProps:{zIndex:2e3},children:[!l&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(ee,{onClick:()=>{o.navigate(pe(t?pt:lt,{id:e.id}))},isDisabled:!_,children:Zt}),(0,L.jsx)(ee,{onClick:()=>{},children:Jt}),(0,L.jsx)(ee,{onClick:()=>{},children:t?Qt:jt}),t&&(0,L.jsx)(ee,{onClick:()=>{},children:eo}),(0,L.jsx)(Ct,{})]}),(0,L.jsx)(ee,{onClick:()=>r(e.id),isDisabled:!h,children:p?Kt:Yt})]})})]})};d();d();var se=a(R(),1),Vo=()=>(0,se.jsxs)($,{status:"warning",children:[(0,se.jsx)(V,{}),(0,se.jsx)(W,{children:"El pedido no cuenta con productos."})]});d();var ae=a(R(),1),$o=()=>(0,ae.jsxs)($,{status:"error",children:[(0,ae.jsx)(V,{}),(0,ae.jsx)(W,{children:"Ocurri\xF3 un error al cargar los detalles del pedido."})]});d();var M=a(R(),1),Xo=()=>(0,M.jsx)(v,{width:"full",sx:{mt:8,mb:4},children:(0,M.jsxs)(k,{templateColumns:"1fr",alignItems:"center",gap:2,children:[(0,M.jsx)(f,{children:(0,M.jsx)(K,{height:"20px"})}),(0,M.jsx)(f,{children:(0,M.jsx)(K,{height:"20px"})}),(0,M.jsx)(f,{children:(0,M.jsx)(K,{height:"20px"})}),(0,M.jsx)(f,{children:(0,M.jsx)(K,{height:"20px"})})]})});d();var E=a(R(),1),qo=({nro_pedido:o,renglones:t})=>(0,E.jsx)(Ee,{sx:{p:0,m:0},children:(0,E.jsxs)(De,{variant:"stripedHoverOverCard",colorScheme:"gray",size:"sm",borderWidth:"1px",children:[(0,E.jsx)(St,{children:(0,E.jsx)(Z,{children:(0,E.jsx)(vt,{sx:{py:2},children:(0,E.jsxs)(k,{templateColumns:{base:"1fr 1fr 1fr",md:"4fr 1fr 1fr 1fr"},gap:6,children:[(0,E.jsx)(f,{children:(0,E.jsx)(z,{fontSize:{base:"xs",md:"sm"},children:"Art\xEDculo"})}),(0,E.jsx)(f,{sx:{display:{base:"none",md:"block"}},children:(0,E.jsx)(z,{fontSize:{base:"xs",md:"sm"},textAlign:"center",children:"Precio"})}),(0,E.jsx)(f,{children:(0,E.jsx)(z,{fontSize:{base:"xs",md:"sm"},textAlign:"center",children:"Cantidad"})}),(0,E.jsx)(f,{children:(0,E.jsx)(z,{fontSize:{base:"xs",md:"sm"},textAlign:"center",children:"Subtotal"})})]})})})}),(0,E.jsx)(Te,{children:t.map(({id_articulo:e,nombre_articulo:r,codigo_articulo:n,descripcion_adicional:l,precio:_,cantidad:h,subtotal:p},b)=>(0,E.jsx)(Z,{children:(0,E.jsx)(te,{children:(0,E.jsxs)(k,{templateColumns:{base:"1fr 1fr 1fr",md:"4fr 1fr 1fr 1fr"},gap:6,children:[(0,E.jsx)(f,{children:(0,E.jsx)(oe,{children:$t(r,e,l)})}),(0,E.jsx)(f,{sx:{display:{base:"none",md:"block"}},children:(0,E.jsx)(Ye,{precio:_,moneda:"$"})}),(0,E.jsx)(f,{children:(0,E.jsx)(j,{textAlign:"center",children:h})}),(0,E.jsx)(f,{children:(0,E.jsx)(Ye,{precio:p,moneda:"$"})})]})})},`details-${o}-${b}`))})]})});var re=a(R(),1),Zo=({wasOpen:o,pedido:t,stateRenglones:e})=>(0,re.jsx)(v,{sx:{mt:6},children:o&&e.map({loading:r=>(0,re.jsx)(Xo,{}),error:r=>(0,re.jsx)($o,{}),success:r=>{let{id:n,numero_pedido:l}=t,_=r.data?.[n];return Array.isArray(_)?(0,re.jsx)(qo,{nro_pedido:l,renglones:_}):(0,re.jsx)(Vo,{})}})});var s=a(R(),1),Ko=({index:o,app:t,draft:e,pedido:r,stateRenglones:n,onDelete:l,isHidden:_})=>{let[h,p]=(0,G.useState)(!1),[b,x]=(0,G.useState)(!1),C=ue("gray.800","white"),i=(0,G.useRef)(!1),g=Ho(r,n),D=(0,G.useMemo)(()=>(0,s.jsx)(Zo,{wasOpen:i.current,pedido:r,stateRenglones:n}),[i.current,n.constructor.name]),c=()=>{let N=!h;N&&(i.current=!0),p(N),X.emit("togglePedidoDetails",{id:r.id})},S=(N,Be)=>{x(!!N),X.emit("setUnsetSelectedPedido",{id:Be,checked:N})};(0,G.useEffect)(()=>{let N=({id:Be})=>{r.id!==Be&&p(!1)};return X.on("togglePedidoDetails",N),()=>{X.removeListener("togglePedidoDetails",N)}},[]);let{id:u,numero_pedido:m,fecha_alta:O,fecha_entrega:H,codigo_cliente:U,codigo_vendedor:He,codigo_transporte:de,nombre_cliente:Q,nombre_vendedor:le,nombre_transporte:Fe,total:ie,descuento:ce,comentarios:Ne,descripcion:jo}=r,me=g,er=Ne!=null&&Ne.length>0;return(0,s.jsx)(Z,{sx:{..._&&!b&&{display:"none"}},children:(0,s.jsxs)(te,{sx:{py:6,position:"relative",borderTopWidth:{base:"3px",md:"4px"},borderTopStyle:"solid",borderTopColor:`${e?"blue.500 !important":ye(me,".500 !important")}`},children:[(0,s.jsxs)(v,{display:"flex",sx:{position:"absolute",right:5,top:5},flexDirection:"column",children:[(0,s.jsx)(Wo,{app:t,draft:e,pedido:r,onDelete:l}),!e&&(0,s.jsx)(Rt,{size:"xl",colorScheme:"blue",sx:{mt:2,borderWidth:0,borderColor:C},onChange:N=>{S(N.target.checked,u)}})]}),(0,s.jsxs)(k,{templateColumns:{base:"repeat(2, 1fr)",md:"repeat(4, 1fr)"},gap:6,sx:{cursor:"pointer"},onClick:()=>{c()},children:[e?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(f,{colSpan:{base:2,md:4},children:(0,s.jsx)(z,{size:"md",textTransform:"uppercase",children:jo})})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(f,{children:[(0,s.jsx)(z,{size:"sm",children:"Pedido"}),(0,s.jsx)(j,{children:m})]}),(0,s.jsxs)(f,{children:[(0,s.jsx)(z,{size:"sm",children:"Estado"}),(0,s.jsx)(Fo,{estado:me})]}),(0,s.jsxs)(f,{children:[(0,s.jsx)(z,{size:"sm",children:"Emisi\xF3n"}),(0,s.jsx)(j,{children:Ge(O)})]}),(0,s.jsxs)(f,{children:[(0,s.jsx)(z,{size:"sm",children:"Entrega"}),(0,s.jsx)(j,{children:Ge(H)})]})]}),(0,s.jsxs)(f,{children:[(0,s.jsx)(z,{size:"sm",children:"Cliente"}),(0,s.jsx)(oe,{children:Xt(U,Q)})]}),(0,s.jsxs)(f,{children:[(0,s.jsx)(z,{size:"sm",children:"Vendedor"}),(0,s.jsx)(oe,{children:Ke(He,le)})]}),(0,s.jsxs)(f,{children:[(0,s.jsx)(z,{size:"sm",children:"Transporte"}),(0,s.jsx)(oe,{children:Ke(de,Fe)})]}),(0,s.jsxs)(f,{children:[(0,s.jsxs)(z,{size:"md",sx:{textTransform:"uppercase",color:me===2&&"green.400"},children:["Total",ce!=null&&(0,s.jsxs)(s.Fragment,{children:[" ",`-${ce}%`]})]}),(0,s.jsx)(z,{size:"md",sx:{fontWeight:"bolder",color:me===2&&"green.400"},children:(0,s.jsx)(qt,{precio:ie,moneda:"$"})})]}),er&&(0,s.jsx)(f,{colSpan:{base:2,md:4},children:(0,s.jsxs)($,{status:"info",children:[(0,s.jsx)(V,{}),(0,s.jsx)(W,{children:Ne})]})})]}),(0,s.jsx)(v,{children:(0,s.jsx)(v,{sx:{display:h?"block":"none"},children:D})},`pedido-details-${o}`)]})})};var Yo=a(B(),1);var w=a(R(),1);function Jo(o){let t=be(),r=t.authState.userInfo.borrar_pedido_al_anular.valueOf(),{draft:n,unfilteredPedidos:l,filteredPedidos:_,isFiltering:h,stateRenglones:p,reloadData:b}=o,x=gt(),C=ne(),{isOpen:i,onOpen:g,onClose:D}=C,c=(0,Yo.useRef)(null),S=m=>{c.current=m,g()},u=async()=>{let m=c.current;if(m!=null){let O=n?await Vt(m,t):await Wt(m,t);console.log(O),O.map({success:H=>{x({title:n?co:r?so:ro,status:"success"})},error:H=>{x({title:nt,status:"error"})}}),O.isSuccess()&&await b(),D()}};return(0,w.jsxs)(Ee,{sx:{p:0,m:0},children:[(0,w.jsx)(De,{variant:"stripedOverCard",colorScheme:"gray",size:"md",sx:{borderCollapse:"separate",borderSpacing:"0 1rem"},children:(0,w.jsxs)(Te,{children:[l.map((m,O)=>(0,w.jsx)(Ko,{index:O,draft:n,app:t,pedido:m,stateRenglones:p,onDelete:S,isHidden:h&&!_.includes(m)},`pedido-${m.id}`)),!_.length&&(0,w.jsx)(Z,{children:(0,w.jsx)(te,{children:(0,w.jsxs)($,{status:"info",children:[(0,w.jsx)(V,{}),(0,w.jsx)(W,{children:h?it:n?Mt:yt})]})})})]})}),(0,w.jsx)(Nt,{isOpen:i,onClose:D,handleDeletion:u,message:{title:n?ao:r?io:to,body:n?lo:r?no:oo}})]})}var J=a(R(),1),Qo=o=>{let{showDrafts:t,pedidos:e,reloadData:r}=o,n=xt().state.userOrThrow(),l=n.role==2,_=n.role==1,h=n.role==0,{filteredData:p,handleSearchInputChange:b,isFiltering:x}=Ie(e,["comentario",...t?[]:["numero_pedido"],...h?[]:["codigo_cliente","nombre_cliente"],...l?["codigo_vendedor","nombre_vendedor"]:[]]),{state:C}=Ae({...t?Ut:kt,silent:!0,transformResponse:i=>(Object.values(i).forEach(g=>{Array.isArray(g)&&g.sort((D,c)=>D.renglon-c.renglon)}),i)});return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(wo,{isDraft:t,pedidos:e,stateRenglones:C,handleSearchInputChange:b}),(0,J.jsx)(Jo,{draft:t,stateRenglones:C,unfilteredPedidos:e,filteredPedidos:p,isFiltering:x,reloadData:r})]})};var we=a(R(),1),wn=o=>{let t=o.showDrafts===!0,{state:e,retry:r,reload:n}=Ae({...t?Gt:Bt,silent:!0});return e.map({loading:l=>(0,we.jsx)(go,{}),error:({error:l})=>(0,we.jsx)(Oe,{error:l,retry:r,cancelAndNavigateTo:st}),success:l=>(0,we.jsx)(Qo,{showDrafts:t,pedidos:l.data,reloadData:n})})};export{wn as a};
