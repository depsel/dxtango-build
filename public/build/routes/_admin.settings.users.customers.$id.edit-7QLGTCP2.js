import{a as re}from"/build/_shared/chunk-RGVPPMYJ.js";import{a as pe,b as S,c as Se,d as ge,e as Ie}from"/build/_shared/chunk-GKNEJFXF.js";import{a as z}from"/build/_shared/chunk-F2PUKCFV.js";import{a as _e}from"/build/_shared/chunk-EZL2WUID.js";import{a as U}from"/build/_shared/chunk-IF35UXSI.js";import"/build/_shared/chunk-QR3HCVRD.js";import{a as h}from"/build/_shared/chunk-AYUUBJTB.js";import{a as ue}from"/build/_shared/chunk-YS7PZJ5S.js";import{a as ce}from"/build/_shared/chunk-YPEM6OVU.js";import{e as le,f as me,h as M,j as fe}from"/build/_shared/chunk-SD3IP6KZ.js";import"/build/_shared/chunk-COC53NOQ.js";import"/build/_shared/chunk-NHHPDOFU.js";import{a as ae}from"/build/_shared/chunk-O7NNQHXC.js";import{g as oe,h as te}from"/build/_shared/chunk-FITHNK55.js";import{a as t}from"/build/_shared/chunk-NDYVTXFO.js";import{a as se}from"/build/_shared/chunk-P32U26JX.js";import{a as ee}from"/build/_shared/chunk-UE4IQPKJ.js";import{a as $}from"/build/_shared/chunk-BXRQWNMF.js";import{b as Z}from"/build/_shared/chunk-N2W4SHIU.js";import{a as ie,b as ne,c as de}from"/build/_shared/chunk-QHPH3CD4.js";import{a as V}from"/build/_shared/chunk-ZX3ORQWN.js";import"/build/_shared/chunk-L46VJDLW.js";import{a as O,b as B,c as T}from"/build/_shared/chunk-EFBMV3GD.js";import{$a as R,A as W,P as E,T as F,Ya as w,bb as s,cb as o,da as Ve,db as y,eb as x,fb as L,ib as u,ta as Y}from"/build/_shared/chunk-DDQFO3X3.js";import"/build/_shared/chunk-MUTVBZ6W.js";import{c as J,d as Q}from"/build/_shared/chunk-OHSBC2MA.js";import"/build/_shared/chunk-E43VAFT6.js";import{a as K,b as g}from"/build/_shared/chunk-J7TISYNY.js";import{e as p,h as m}from"/build/_shared/chunk-AXWLPIOK.js";m();m();m();m();var e=p(g(),1),Pe=()=>(0,e.jsx)(x,{width:"full",sx:{mt:8,mb:4},children:(0,e.jsxs)(w,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"center",gap:4,children:[(0,e.jsx)(o,{colSpan:{md:2},children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{colSpan:{md:2},children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{colSpan:{md:2},children:(0,e.jsx)(u,{})}),(0,e.jsx)(o,{colSpan:{md:2},children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{colSpan:{md:2},children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{colSpan:{md:2},children:(0,e.jsx)(u,{})}),(0,e.jsx)(o,{colSpan:{md:2},children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{colSpan:{md:2},children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{colSpan:{md:2},children:(0,e.jsx)(u,{})}),(0,e.jsx)(o,{colSpan:{md:2},children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{colSpan:{md:2},children:(0,e.jsxs)(R,{spacing:4,direction:{base:"column"},children:[(0,e.jsx)(s,{spacing:4,children:(0,e.jsx)(t,{})}),(0,e.jsx)(s,{spacing:4,children:(0,e.jsx)(t,{})}),(0,e.jsx)(s,{spacing:4,children:(0,e.jsx)(t,{})}),(0,e.jsx)(s,{spacing:4,children:(0,e.jsx)(t,{})}),(0,e.jsx)(s,{spacing:4,children:(0,e.jsx)(t,{})}),(0,e.jsx)(s,{spacing:4,children:(0,e.jsx)(t,{})}),(0,e.jsx)(s,{spacing:4,children:(0,e.jsx)(t,{})}),(0,e.jsx)(s,{spacing:4,children:(0,e.jsx)(t,{})})]})}),(0,e.jsx)(o,{colSpan:{md:2},children:(0,e.jsx)(u,{})}),(0,e.jsx)(o,{children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{}),(0,e.jsx)(o,{children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{children:(0,e.jsx)(t,{})}),(0,e.jsx)(o,{children:(0,e.jsx)(t,{})})]})});m();var X=p(K(),1);m();var be=p(K(),1),Ce=p(Ve(),1);var he=()=>{let[f,c]=(0,be.useState)(null),l=fe({password:M().test("password","Formato de contrase\xF1a no v\xE1lido",n=>{if(n!=null&&n!=""){let _=ge(n);return Ce.default.isEqual(f,_)||c(_),_e(Ie,n)}return c(null),!0}),password_repeat:M().when("password",{is:n=>n!=null&&n!="",then:n=>n.required("Repita la contrase\xF1a")}).test("passwords-match","Las contrase\xF1as no coinciden",function(n){return this.parent.password!=null&&this.parent.password!=""?this.parent.password===n:!0})}).required();return{yupValidationSchema:Se.concat(l),passwordStatus:f}};var r=p(g(),1),Ge=f=>{let{stateData:c,typeSettings:l}=f,a={...c},n=ne(),_=Y(),{yupValidationSchema:Te,passwordStatus:D}=he(),{state:b,result:j}=Z({url:$,fieldsMap:{label:"name",value:"id"}}),{state:C,result:q}=l.api.getRelation(),{handleSubmit:ve,control:d,resetField:A,setError:De,watch:ke,formState:{errors:He,isSubmitting:Ee,isSubmitSuccessful:Fe}}=le({defaultValues:{username:a.username,email:a.email??"",habilitado_en_dxt:a.habilitado_en_dxt,puede_crear_pedido:a.puede_crear_pedido,puede_editar_pedido:a.puede_anular_pedido,ver_pedidos_cumplidos:a.ver_pedidos_cumplidos,ver_sin_precio:a.ver_sin_precio,mostrar_mensaje_de_advertencia:a.mostrar_mensaje_de_advertencia,puede_anular_pedido:a.puede_anular_pedido,borrar_pedido_al_anular:a.borrar_pedido_al_anular,aprobar_pedido_al_crear:a.aprobar_pedido_al_crear,dia_de_entrega:a.dia_de_entrega},resolver:me(Te)}),k=ke("puede_anular_pedido");(0,X.useEffect)(()=>{k===!1&&A("borrar_pedido_al_anular",{defaultValue:!1})},[k]),(0,X.useEffect)(()=>{if(C instanceof T){let P=q.find(H=>H.value===a.tango_id)?.value??void 0;A("tango_id",{defaultValue:P})}if(b instanceof T){let P=j.find(H=>H.value===a.perfil_facturacion_id)?.value??void 0;A("perfil_facturacion_id",{defaultValue:P})}},[C,b]);let i=Fe||Ee;return(0,r.jsx)("form",{noValidate:!0,onSubmit:ve(async P=>{let{password_repeat:H,...G}=P;G.email===""&&delete G.email,G.password===""&&delete G.password;let Re=G,xe=await l.api.patch(a.id,Re,n);await de({toast:_,result:xe,messages:{success:{title:"Usuario actualizado"},error:{title:"Ha ocurrido un error"},loading:{title:"Actualizando usuario"}}}).then(()=>{n.navigate(F)}).catch(Le=>{De("root",{message:Le})})}),children:(0,r.jsxs)(x,{children:[(0,r.jsx)(ce,{errors:He}),(0,r.jsx)(V,{children:(0,r.jsxs)(w,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"center",gap:4,children:[(0,r.jsx)(o,{colSpan:{md:2},children:(0,r.jsx)(y,{size:"sm",textTransform:"uppercase",children:"Informaci\xF3n del Cliente"})}),(0,r.jsxs)(o,{colSpan:{md:2},children:[(0,r.jsx)(U,{fieldProps:{name:"tango_id",placeholder:l.tangoRelatedFields?.placeholder,options:q,noOptionsMessage(P){return l.tangoRelatedFields?.empty},isSearchable:!0,selectedOptionStyle:"check",isLoading:C instanceof O},formControlProps:{isDisabled:i||!(C instanceof T)},formControlInnerProps:{label:l.tangoRelatedFields?.label},control:d}),C instanceof B&&(0,r.jsx)(z,{error:C.errorOrNull().error})]}),(0,r.jsx)(o,{children:(0,r.jsx)(h,{fieldProps:{name:"username",id:"username",type:"text"},formControlProps:{isDisabled:i},formControlInnerProps:{label:"Nombre de Usuario"},control:d})}),(0,r.jsx)(o,{children:(0,r.jsx)(h,{fieldProps:{name:"email",id:"email",type:"text",inputMode:"email"},formControlProps:{isDisabled:i},formControlInnerProps:{label:"Correo electr\xF3nico"},control:d})}),(0,r.jsx)(o,{children:(0,r.jsx)(h,{fieldProps:{name:"password",id:"password",type:"password"},formControlProps:{isDisabled:i},formControlInnerProps:{label:"Nueva contrase\xF1a"},control:d})}),(0,r.jsx)(o,{children:(0,r.jsx)(h,{fieldProps:{name:"password_repeat",id:"password_repeat",type:"password"},formControlProps:{isDisabled:i},formControlInnerProps:{label:"Confirmaci\xF3n de Contrase\xF1a"},control:d})}),D!=null&&(0,r.jsxs)(o,{colSpan:{md:2},children:[D.tooShort&&(0,r.jsx)(L,{colorScheme:"red",children:"Contrase\xF1a muy corta"}),D.tooLong&&(0,r.jsx)(L,{colorScheme:"red",children:"Contrase\xF1a muy larga"}),D.invalidCharsPresent&&(0,r.jsx)(L,{colorScheme:"red",children:"Evite caracteres no v\xE1lidos"})]}),(0,r.jsx)(o,{colSpan:{md:2},children:(0,r.jsx)(u,{})}),(0,r.jsxs)(o,{colSpan:{md:2},children:[(0,r.jsx)(U,{fieldProps:{name:"perfil_facturacion_id",placeholder:"Seleccione un perfil",options:j,noOptionsMessage(P){return"No hay perfiles disponibles"},isLoading:b instanceof O,selectedOptionStyle:"check"},formControlProps:{isDisabled:i||!(b instanceof T)},control:d,formControlInnerProps:{label:"Perfil de facturaci\xF3n"}}),b instanceof B&&(0,r.jsx)(z,{error:b.errorOrNull().error})]}),(0,r.jsx)(o,{colSpan:{md:2},children:(0,r.jsx)(u,{})}),(0,r.jsx)(o,{colSpan:{md:2},children:(0,r.jsx)(y,{size:"sm",textTransform:"uppercase",children:"Estado"})}),(0,r.jsx)(o,{colSpan:{md:2},children:(0,r.jsx)(pe,{fieldProps:{name:"habilitado_en_dxt",options:[{value:!0,label:"Establecido en Tango"},{value:!1,label:"Deshabilitado"}]},formControlProps:{isDisabled:i},radioProps:{size:{base:"sm",sm:"md"}},control:d})}),(0,r.jsx)(o,{colSpan:{md:2},children:(0,r.jsx)(u,{})}),(0,r.jsx)(o,{colSpan:{md:2},children:(0,r.jsx)(y,{size:"sm",textTransform:"uppercase",children:"Comunicaci\xF3n"})}),(0,r.jsx)(o,{children:(0,r.jsx)(S,{fieldProps:{name:"mostrar_mensaje_de_advertencia",id:"mostrar_mensaje_de_advertencia"},formControlProps:{width:"auto",isDisabled:i},formControlInnerProps:{label:"Mostrar mensaje de advertencia"},control:d})})]})}),(0,r.jsx)(V,{children:(0,r.jsxs)(w,{templateColumns:{base:"1fr",md:"repeat(2,1fr)"},alignItems:"center",gap:4,children:[(0,r.jsx)(o,{colSpan:{md:2},children:(0,r.jsx)(y,{size:"sm",textTransform:"uppercase",children:"Pedidos"})}),(0,r.jsx)(o,{colSpan:{md:2},children:(0,r.jsxs)(R,{spacing:4,direction:{base:"column"},children:[(0,r.jsx)(s,{spacing:4,children:(0,r.jsx)(S,{fieldProps:{name:"puede_crear_pedido",id:"puede_crear_pedido"},formControlProps:{width:"auto",isDisabled:i},formControlInnerProps:{label:"Puede crear pedidos"},control:d})}),(0,r.jsx)(s,{spacing:4,children:(0,r.jsx)(S,{fieldProps:{name:"puede_editar_pedido",id:"puede_editar_pedido"},formControlProps:{width:"auto",isDisabled:i},formControlInnerProps:{label:"Puede editar pedidos"},control:d})}),(0,r.jsx)(s,{spacing:4,children:(0,r.jsx)(S,{fieldProps:{name:"puede_anular_pedido",id:"puede_anular_pedido"},formControlProps:{width:"auto",isDisabled:i},formControlInnerProps:{label:"Puede anular pedidos"},control:d})}),(0,r.jsx)(s,{spacing:4,children:(0,r.jsx)(S,{fieldProps:{name:"borrar_pedido_al_anular",id:"borrar_pedido_al_anular"},formControlProps:{width:"auto",isDisabled:i},formControlInnerProps:{label:"Borrar pedido al anular"},control:d,watch:{isDisabled:k===!1,...k===!1&&{isChecked:!1}}})}),(0,r.jsx)(s,{spacing:4,children:(0,r.jsx)(S,{fieldProps:{name:"aprobar_pedido_al_crear",id:"aprobar_pedido_al_crear"},formControlProps:{width:"auto",isDisabled:i},formControlInnerProps:{label:"Los pedidos se aprueban al crearlos"},control:d})}),(0,r.jsx)(s,{spacing:4,children:(0,r.jsx)(S,{fieldProps:{name:"ver_pedidos_cumplidos",id:"ver_pedidos_cumplidos"},formControlProps:{width:"auto",isDisabled:i},formControlInnerProps:{label:"Puede ver los pedidos cumplidos"},control:d})}),(0,r.jsx)(s,{spacing:4,children:(0,r.jsx)(S,{fieldProps:{name:"ver_sin_precio",id:"ver_sin_precio"},formControlProps:{width:"auto",isDisabled:i},formControlInnerProps:{label:"Puede ver art\xEDculos sin precios"},control:d})})]})}),(0,r.jsx)(o,{colSpan:{md:2},children:(0,r.jsx)(u,{})}),(0,r.jsx)(o,{children:(0,r.jsx)(h,{fieldProps:{name:"dia_de_entrega",id:"dia_de_entrega",type:"number",inputMode:"tel"},formControlProps:{isDisabled:i},formControlInnerProps:{label:"Tiempo de entrega de pedidos",helperText:"Expresado en d\xEDas"},control:d})}),(0,r.jsx)(o,{})]})}),(0,r.jsx)(V,{children:(0,r.jsx)(ue,{buttonActionText:"Actualizar",isLoading:i})})]})})};var N=p(g(),1),we=f=>{let{typeSettings:c,id:l}=f,{state:a,retry:n}=c.api.getOne(l);return a.map({loading:_=>(0,N.jsx)(Pe,{}),error:({error:_})=>(0,N.jsx)(se,{error:_,retry:n,cancelAndNavigateTo:E}),success:_=>(0,N.jsx)(Ge,{stateData:_.data,typeSettings:c})})};var I=p(g(),1);function ye(){let f=J(),{id:c}=Q(),l=ee.customers;try{if(re(c))return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(ie,{title:l.titles.edit,actionButton:{label:W,buttonProps:{colorScheme:"gray",onClick:()=>{f(F)}}}}),(0,I.jsx)(we,{typeSettings:l,id:c})]})}catch{return(0,I.jsx)(ae,{error:te,buttonProps:{label:oe,colorScheme:"green",onClick:()=>{f(E)}}})}}export{ye as default};
